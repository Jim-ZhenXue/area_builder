// Copyright 2019-2024, University of Colorado Boulder
/**
 * DiscreteSoundGenerator produces sounds based on the value of a number property.  It monitors the property value and
 * maps it to one of a finite number of bins, and produces a discrete sound when the bin to which the value is mapped
 * changes.
 *
 * @author John Blanco (PhET Interactive Simulations)
 */ import Range from '../../../dot/js/Range.js';
import optionize from '../../../phet-core/js/optionize.js';
import brightMarimba_mp3 from '../../sounds/brightMarimba_mp3.js';
import BinMapper from '../BinMapper.js';
import tambo from '../tambo.js';
import SoundClip from './SoundClip.js';
let DiscreteSoundGenerator = class DiscreteSoundGenerator extends SoundClip {
    /**
   */ dispose() {
        this.disposeDiscreteSoundGenerator();
        super.dispose();
    }
    /**
   * @param valueProperty - the value that is monitored to trigger sounds
   * @param valueRange - the range of values expected and over which sounds will be played
   * @param [providedOptions] - options for this sound generation and its parent class
   */ constructor(valueProperty, valueRange, providedOptions){
        const options = optionize()({
            sound: brightMarimba_mp3,
            initialOutputLevel: 1,
            numBins: 7,
            playbackRateRange: new Range(1, 1),
            alwaysPlayOnChangesProperty: null,
            playSoundAtMin: true,
            playSoundAtMax: true,
            outOfRangeValuesOK: false
        }, providedOptions);
        // invoke superconstructor
        super(options.sound, options);
        // create the object that will place the continuous values into bins
        const binMapper = new BinMapper(valueRange, options.numBins, {
            tolerateOutOfRangeValues: options.outOfRangeValuesOK
        });
        // function for playing sound when the appropriate conditions are met
        const playSoundOnChanges = (newValue, oldValue)=>{
            const newBin = binMapper.mapToBin(newValue);
            const oldBin = binMapper.mapToBin(oldValue);
            if (options.alwaysPlayOnChangesProperty && options.alwaysPlayOnChangesProperty.value || newValue === valueRange.min && options.playSoundAtMin || newValue === valueRange.max && options.playSoundAtMax || newBin !== oldBin) {
                const normalizedValue = (newValue - valueRange.min) / valueRange.getLength();
                const playbackRate = normalizedValue * (options.playbackRateRange.max - options.playbackRateRange.min) + options.playbackRateRange.min;
                this.setPlaybackRate(playbackRate);
                this.play();
            }
        };
        // monitor the value, playing sounds when appropriate
        valueProperty.lazyLink(playSoundOnChanges);
        // dispose function
        this.disposeDiscreteSoundGenerator = ()=>{
            valueProperty.unlink(playSoundOnChanges);
        };
    }
};
tambo.register('DiscreteSoundGenerator', DiscreteSoundGenerator);
export default DiscreteSoundGenerator;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3RhbWJvL2pzL3NvdW5kLWdlbmVyYXRvcnMvRGlzY3JldGVTb3VuZEdlbmVyYXRvci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOS0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcblxuLyoqXG4gKiBEaXNjcmV0ZVNvdW5kR2VuZXJhdG9yIHByb2R1Y2VzIHNvdW5kcyBiYXNlZCBvbiB0aGUgdmFsdWUgb2YgYSBudW1iZXIgcHJvcGVydHkuICBJdCBtb25pdG9ycyB0aGUgcHJvcGVydHkgdmFsdWUgYW5kXG4gKiBtYXBzIGl0IHRvIG9uZSBvZiBhIGZpbml0ZSBudW1iZXIgb2YgYmlucywgYW5kIHByb2R1Y2VzIGEgZGlzY3JldGUgc291bmQgd2hlbiB0aGUgYmluIHRvIHdoaWNoIHRoZSB2YWx1ZSBpcyBtYXBwZWRcbiAqIGNoYW5nZXMuXG4gKlxuICogQGF1dGhvciBKb2huIEJsYW5jbyAoUGhFVCBJbnRlcmFjdGl2ZSBTaW11bGF0aW9ucylcbiAqL1xuXG5pbXBvcnQgQm9vbGVhblByb3BlcnR5IGZyb20gJy4uLy4uLy4uL2F4b24vanMvQm9vbGVhblByb3BlcnR5LmpzJztcbmltcG9ydCBOdW1iZXJQcm9wZXJ0eSBmcm9tICcuLi8uLi8uLi9heG9uL2pzL051bWJlclByb3BlcnR5LmpzJztcbmltcG9ydCBSYW5nZSBmcm9tICcuLi8uLi8uLi9kb3QvanMvUmFuZ2UuanMnO1xuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcbmltcG9ydCBicmlnaHRNYXJpbWJhX21wMyBmcm9tICcuLi8uLi9zb3VuZHMvYnJpZ2h0TWFyaW1iYV9tcDMuanMnO1xuaW1wb3J0IEJpbk1hcHBlciBmcm9tICcuLi9CaW5NYXBwZXIuanMnO1xuaW1wb3J0IHRhbWJvIGZyb20gJy4uL3RhbWJvLmpzJztcbmltcG9ydCBXcmFwcGVkQXVkaW9CdWZmZXIgZnJvbSAnLi4vV3JhcHBlZEF1ZGlvQnVmZmVyLmpzJztcbmltcG9ydCBTb3VuZENsaXAsIHsgU291bmRDbGlwT3B0aW9ucyB9IGZyb20gJy4vU291bmRDbGlwLmpzJztcblxudHlwZSBTZWxmT3B0aW9ucyA9IHtcblxuICAvLyB0aGUgc291bmQgdGhhdCB3aWxsIGJlIHBsYXllZCBhdCB0aGUgZGlzY3JldGUgdmFsdWVzXG4gIHNvdW5kPzogV3JhcHBlZEF1ZGlvQnVmZmVyO1xuXG4gIC8vIG51bWJlciBvZiBkaXNjcmV0ZSBiaW5zLCBjcm9zc2luZyBiZXR3ZWVuIHRoZW0gd2lsbCBwcm9kdWNlIGEgc291bmRcbiAgbnVtQmlucz86IDc7XG5cbiAgLy8gdGhlIHJhbmdlIG92ZXIgd2hpY2ggdGhlIHBsYXliYWNrIHJhdGUgaXMgdmFyaWVkLCAxIGlzIG5vcm1hbCBzcGVlZCwgMiBpcyBkb3VibGUgc3BlZWQsIGV0IGNldGVyYVxuICBwbGF5YmFja1JhdGVSYW5nZT86IFJhbmdlO1xuXG4gIC8vIHdoZW4gdHJ1ZSB3aWxsIGNhdXNlIHNvdW5kIHRvIGJlIHBsYXllZCBvbiBhbnkgY2hhbmdlIG9mIHRoZSB2YWx1ZSBwcm9wZXJ0eVxuICBhbHdheXNQbGF5T25DaGFuZ2VzUHJvcGVydHk/OiBudWxsIHwgQm9vbGVhblByb3BlcnR5O1xuXG4gIC8vIElmIHRydWUsIHRoZSBzb3VuZCB3aWxsIGJlIHBsYXllZCB3aGVuIHRoZSB2YWx1ZSByZWFjaGVzIHRoZSBtaW4uXG4gIHBsYXlTb3VuZEF0TWluPzogYm9vbGVhbjtcblxuICAvLyBJZiB0cnVlLCB0aGUgc291bmQgd2lsbCBiZSBwbGF5ZWQgd2hlbiB0aGUgdmFsdWUgcmVhY2hlcyB0aGUgbWF4LlxuICBwbGF5U291bmRBdE1heD86IGJvb2xlYW47XG5cbiAgLy8gYSBmbGFnIHRoYXQgaW5kaWNhdGVzIHdoZXRoZXIgb3V0IG9mIHJhbmdlIHZhbHVlcyBzaG91bGQgYmUgaWdub3JlZFxuICBvdXRPZlJhbmdlVmFsdWVzT0s/OiBib29sZWFuO1xufTtcbmV4cG9ydCB0eXBlIERpc2NyZXRlU291bmRHZW5lcmF0b3JPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBTb3VuZENsaXBPcHRpb25zO1xuXG5jbGFzcyBEaXNjcmV0ZVNvdW5kR2VuZXJhdG9yIGV4dGVuZHMgU291bmRDbGlwIHtcbiAgcHJpdmF0ZSByZWFkb25seSBkaXNwb3NlRGlzY3JldGVTb3VuZEdlbmVyYXRvcjogKCkgPT4gdm9pZDtcblxuICAvKipcbiAgICogQHBhcmFtIHZhbHVlUHJvcGVydHkgLSB0aGUgdmFsdWUgdGhhdCBpcyBtb25pdG9yZWQgdG8gdHJpZ2dlciBzb3VuZHNcbiAgICogQHBhcmFtIHZhbHVlUmFuZ2UgLSB0aGUgcmFuZ2Ugb2YgdmFsdWVzIGV4cGVjdGVkIGFuZCBvdmVyIHdoaWNoIHNvdW5kcyB3aWxsIGJlIHBsYXllZFxuICAgKiBAcGFyYW0gW3Byb3ZpZGVkT3B0aW9uc10gLSBvcHRpb25zIGZvciB0aGlzIHNvdW5kIGdlbmVyYXRpb24gYW5kIGl0cyBwYXJlbnQgY2xhc3NcbiAgICovXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggdmFsdWVQcm9wZXJ0eTogTnVtYmVyUHJvcGVydHksIHZhbHVlUmFuZ2U6IFJhbmdlLCBwcm92aWRlZE9wdGlvbnM/OiBEaXNjcmV0ZVNvdW5kR2VuZXJhdG9yT3B0aW9ucyApIHtcblxuICAgIGNvbnN0IG9wdGlvbnMgPSBvcHRpb25pemU8RGlzY3JldGVTb3VuZEdlbmVyYXRvck9wdGlvbnMsIFNlbGZPcHRpb25zLCBTb3VuZENsaXBPcHRpb25zPigpKCB7XG4gICAgICBzb3VuZDogYnJpZ2h0TWFyaW1iYV9tcDMsXG4gICAgICBpbml0aWFsT3V0cHV0TGV2ZWw6IDEsXG4gICAgICBudW1CaW5zOiA3LFxuICAgICAgcGxheWJhY2tSYXRlUmFuZ2U6IG5ldyBSYW5nZSggMSwgMSApLCAvLyBkZWZhdWx0IGlzIG5vIGNoYW5nZSB0byB0aGUgc291bmRcbiAgICAgIGFsd2F5c1BsYXlPbkNoYW5nZXNQcm9wZXJ0eTogbnVsbCxcbiAgICAgIHBsYXlTb3VuZEF0TWluOiB0cnVlLFxuICAgICAgcGxheVNvdW5kQXRNYXg6IHRydWUsXG4gICAgICBvdXRPZlJhbmdlVmFsdWVzT0s6IGZhbHNlXG4gICAgfSwgcHJvdmlkZWRPcHRpb25zICk7XG5cbiAgICAvLyBpbnZva2Ugc3VwZXJjb25zdHJ1Y3RvclxuICAgIHN1cGVyKCBvcHRpb25zLnNvdW5kLCBvcHRpb25zICk7XG5cbiAgICAvLyBjcmVhdGUgdGhlIG9iamVjdCB0aGF0IHdpbGwgcGxhY2UgdGhlIGNvbnRpbnVvdXMgdmFsdWVzIGludG8gYmluc1xuICAgIGNvbnN0IGJpbk1hcHBlciA9IG5ldyBCaW5NYXBwZXIoIHZhbHVlUmFuZ2UsIG9wdGlvbnMubnVtQmlucywge1xuICAgICAgdG9sZXJhdGVPdXRPZlJhbmdlVmFsdWVzOiBvcHRpb25zLm91dE9mUmFuZ2VWYWx1ZXNPS1xuICAgIH0gKTtcblxuICAgIC8vIGZ1bmN0aW9uIGZvciBwbGF5aW5nIHNvdW5kIHdoZW4gdGhlIGFwcHJvcHJpYXRlIGNvbmRpdGlvbnMgYXJlIG1ldFxuICAgIGNvbnN0IHBsYXlTb3VuZE9uQ2hhbmdlcyA9ICggbmV3VmFsdWU6IG51bWJlciwgb2xkVmFsdWU6IG51bWJlciApID0+IHtcblxuICAgICAgY29uc3QgbmV3QmluID0gYmluTWFwcGVyLm1hcFRvQmluKCBuZXdWYWx1ZSApO1xuICAgICAgY29uc3Qgb2xkQmluID0gYmluTWFwcGVyLm1hcFRvQmluKCBvbGRWYWx1ZSApO1xuXG4gICAgICBpZiAoIG9wdGlvbnMuYWx3YXlzUGxheU9uQ2hhbmdlc1Byb3BlcnR5ICYmIG9wdGlvbnMuYWx3YXlzUGxheU9uQ2hhbmdlc1Byb3BlcnR5LnZhbHVlIHx8XG4gICAgICAgICAgICggbmV3VmFsdWUgPT09IHZhbHVlUmFuZ2UubWluICYmIG9wdGlvbnMucGxheVNvdW5kQXRNaW4gKSB8fFxuICAgICAgICAgICAoIG5ld1ZhbHVlID09PSB2YWx1ZVJhbmdlLm1heCAmJiBvcHRpb25zLnBsYXlTb3VuZEF0TWF4ICkgfHxcbiAgICAgICAgICAgbmV3QmluICE9PSBvbGRCaW4gKSB7XG5cbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFZhbHVlID0gKCBuZXdWYWx1ZSAtIHZhbHVlUmFuZ2UubWluICkgLyB2YWx1ZVJhbmdlLmdldExlbmd0aCgpO1xuICAgICAgICBjb25zdCBwbGF5YmFja1JhdGUgPSBub3JtYWxpemVkVmFsdWUgKiAoIG9wdGlvbnMucGxheWJhY2tSYXRlUmFuZ2UubWF4IC0gb3B0aW9ucy5wbGF5YmFja1JhdGVSYW5nZS5taW4gKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMucGxheWJhY2tSYXRlUmFuZ2UubWluO1xuICAgICAgICB0aGlzLnNldFBsYXliYWNrUmF0ZSggcGxheWJhY2tSYXRlICk7XG4gICAgICAgIHRoaXMucGxheSgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBtb25pdG9yIHRoZSB2YWx1ZSwgcGxheWluZyBzb3VuZHMgd2hlbiBhcHByb3ByaWF0ZVxuICAgIHZhbHVlUHJvcGVydHkubGF6eUxpbmsoIHBsYXlTb3VuZE9uQ2hhbmdlcyApO1xuXG4gICAgLy8gZGlzcG9zZSBmdW5jdGlvblxuICAgIHRoaXMuZGlzcG9zZURpc2NyZXRlU291bmRHZW5lcmF0b3IgPSAoKSA9PiB7IHZhbHVlUHJvcGVydHkudW5saW5rKCBwbGF5U291bmRPbkNoYW5nZXMgKTsgfTtcbiAgfVxuXG4gIC8qKlxuICAgKi9cbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5kaXNwb3NlRGlzY3JldGVTb3VuZEdlbmVyYXRvcigpO1xuICAgIHN1cGVyLmRpc3Bvc2UoKTtcbiAgfVxuXG59XG5cbnRhbWJvLnJlZ2lzdGVyKCAnRGlzY3JldGVTb3VuZEdlbmVyYXRvcicsIERpc2NyZXRlU291bmRHZW5lcmF0b3IgKTtcblxuZXhwb3J0IGRlZmF1bHQgRGlzY3JldGVTb3VuZEdlbmVyYXRvcjsiXSwibmFtZXMiOlsiUmFuZ2UiLCJvcHRpb25pemUiLCJicmlnaHRNYXJpbWJhX21wMyIsIkJpbk1hcHBlciIsInRhbWJvIiwiU291bmRDbGlwIiwiRGlzY3JldGVTb3VuZEdlbmVyYXRvciIsImRpc3Bvc2UiLCJkaXNwb3NlRGlzY3JldGVTb3VuZEdlbmVyYXRvciIsInZhbHVlUHJvcGVydHkiLCJ2YWx1ZVJhbmdlIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInNvdW5kIiwiaW5pdGlhbE91dHB1dExldmVsIiwibnVtQmlucyIsInBsYXliYWNrUmF0ZVJhbmdlIiwiYWx3YXlzUGxheU9uQ2hhbmdlc1Byb3BlcnR5IiwicGxheVNvdW5kQXRNaW4iLCJwbGF5U291bmRBdE1heCIsIm91dE9mUmFuZ2VWYWx1ZXNPSyIsImJpbk1hcHBlciIsInRvbGVyYXRlT3V0T2ZSYW5nZVZhbHVlcyIsInBsYXlTb3VuZE9uQ2hhbmdlcyIsIm5ld1ZhbHVlIiwib2xkVmFsdWUiLCJuZXdCaW4iLCJtYXBUb0JpbiIsIm9sZEJpbiIsInZhbHVlIiwibWluIiwibWF4Iiwibm9ybWFsaXplZFZhbHVlIiwiZ2V0TGVuZ3RoIiwicGxheWJhY2tSYXRlIiwic2V0UGxheWJhY2tSYXRlIiwicGxheSIsImxhenlMaW5rIiwidW5saW5rIiwicmVnaXN0ZXIiXSwibWFwcGluZ3MiOiJBQUFBLHNEQUFzRDtBQUV0RDs7Ozs7O0NBTUMsR0FJRCxPQUFPQSxXQUFXLDJCQUEyQjtBQUM3QyxPQUFPQyxlQUFlLHFDQUFxQztBQUMzRCxPQUFPQyx1QkFBdUIsb0NBQW9DO0FBQ2xFLE9BQU9DLGVBQWUsa0JBQWtCO0FBQ3hDLE9BQU9DLFdBQVcsY0FBYztBQUVoQyxPQUFPQyxlQUFxQyxpQkFBaUI7QUEyQjdELElBQUEsQUFBTUMseUJBQU4sTUFBTUEsK0JBQStCRDtJQXVEbkM7R0FDQyxHQUNELEFBQWdCRSxVQUFnQjtRQUM5QixJQUFJLENBQUNDLDZCQUE2QjtRQUNsQyxLQUFLLENBQUNEO0lBQ1I7SUF6REE7Ozs7R0FJQyxHQUNELFlBQW9CRSxhQUE2QixFQUFFQyxVQUFpQixFQUFFQyxlQUErQyxDQUFHO1FBRXRILE1BQU1DLFVBQVVYLFlBQTJFO1lBQ3pGWSxPQUFPWDtZQUNQWSxvQkFBb0I7WUFDcEJDLFNBQVM7WUFDVEMsbUJBQW1CLElBQUloQixNQUFPLEdBQUc7WUFDakNpQiw2QkFBNkI7WUFDN0JDLGdCQUFnQjtZQUNoQkMsZ0JBQWdCO1lBQ2hCQyxvQkFBb0I7UUFDdEIsR0FBR1Q7UUFFSCwwQkFBMEI7UUFDMUIsS0FBSyxDQUFFQyxRQUFRQyxLQUFLLEVBQUVEO1FBRXRCLG9FQUFvRTtRQUNwRSxNQUFNUyxZQUFZLElBQUlsQixVQUFXTyxZQUFZRSxRQUFRRyxPQUFPLEVBQUU7WUFDNURPLDBCQUEwQlYsUUFBUVEsa0JBQWtCO1FBQ3REO1FBRUEscUVBQXFFO1FBQ3JFLE1BQU1HLHFCQUFxQixDQUFFQyxVQUFrQkM7WUFFN0MsTUFBTUMsU0FBU0wsVUFBVU0sUUFBUSxDQUFFSDtZQUNuQyxNQUFNSSxTQUFTUCxVQUFVTSxRQUFRLENBQUVGO1lBRW5DLElBQUtiLFFBQVFLLDJCQUEyQixJQUFJTCxRQUFRSywyQkFBMkIsQ0FBQ1ksS0FBSyxJQUM5RUwsYUFBYWQsV0FBV29CLEdBQUcsSUFBSWxCLFFBQVFNLGNBQWMsSUFDckRNLGFBQWFkLFdBQVdxQixHQUFHLElBQUluQixRQUFRTyxjQUFjLElBQ3ZETyxXQUFXRSxRQUFTO2dCQUV2QixNQUFNSSxrQkFBa0IsQUFBRVIsQ0FBQUEsV0FBV2QsV0FBV29CLEdBQUcsQUFBRCxJQUFNcEIsV0FBV3VCLFNBQVM7Z0JBQzVFLE1BQU1DLGVBQWVGLGtCQUFvQnBCLENBQUFBLFFBQVFJLGlCQUFpQixDQUFDZSxHQUFHLEdBQUduQixRQUFRSSxpQkFBaUIsQ0FBQ2MsR0FBRyxBQUFELElBQ2hGbEIsUUFBUUksaUJBQWlCLENBQUNjLEdBQUc7Z0JBQ2xELElBQUksQ0FBQ0ssZUFBZSxDQUFFRDtnQkFDdEIsSUFBSSxDQUFDRSxJQUFJO1lBQ1g7UUFDRjtRQUVBLHFEQUFxRDtRQUNyRDNCLGNBQWM0QixRQUFRLENBQUVkO1FBRXhCLG1CQUFtQjtRQUNuQixJQUFJLENBQUNmLDZCQUE2QixHQUFHO1lBQVFDLGNBQWM2QixNQUFNLENBQUVmO1FBQXNCO0lBQzNGO0FBU0Y7QUFFQW5CLE1BQU1tQyxRQUFRLENBQUUsMEJBQTBCakM7QUFFMUMsZUFBZUEsdUJBQXVCIn0=