// Copyright 2023-2024, University of Colorado Boulder
/**
 * Controls a specific animated value for an Animation.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */ import { isTReadOnlyProperty } from '../../axon/js/TReadOnlyProperty.js';
import optionize from '../../phet-core/js/optionize.js';
import Easing from './Easing.js';
import twixt from './twixt.js';
let AnimationTarget = class AnimationTarget {
    static DEFAULT_BLEND(a, b, ratio) {
        assert && assert(isFinite(ratio) && ratio >= 0 && ratio <= 1, `Invalid ratio: ${ratio}`);
        if (ratio === 0) {
            return a;
        }
        if (ratio === 1) {
            return b;
        }
        if (typeof a === 'number' && typeof b === 'number') {
            // @ts-expect-error - It can't detect we're in the T === number case.
            return a + (b - a) * ratio;
        }
        if (typeof a === 'object' && typeof b === 'object' && typeof a.blend === 'function') {
            return a.blend(b, ratio);
        }
        throw new Error(`Blending not supported for: ${JSON.stringify(a)}, ${JSON.stringify(b)}, pass in a blend option`);
    }
    static DEFAULT_DISTANCE(a, b) {
        if (typeof a === 'number' && typeof b === 'number') {
            return Math.abs(a - b);
        }
        if (typeof a === 'object' && typeof b === 'object' && typeof a.distance === 'function') {
            return a.distance(b);
        }
        throw new Error(`Distance (required for speed) by default not supported for: ${JSON.stringify(a)}, ${JSON.stringify(b)}, pass in a distance option`);
    }
    static DEFAULT_ADD(a, b) {
        if (typeof a === 'number' && typeof b === 'number') {
            // @ts-expect-error - It can't detect we're in the T === number case.
            return a + b;
        }
        if (typeof a === 'object' && typeof b === 'object' && typeof a.plus === 'function') {
            return a.plus(b);
        }
        throw new Error(`Addition (required for delta) by default not supported for: ${JSON.stringify(a)}, ${JSON.stringify(b)}, pass in an add option`);
    }
    /**
   * Helper function for creating a setter closure for object[ attribute ].
   */ static OBJECT_SET(object, attribute) {
        return function(value) {
            object[attribute] = value;
        };
    }
    /**
   * Helper function for creating a getter closure for object[ attribute ].
   */ static OBJECT_GET(object, attribute) {
        return function() {
            return object[attribute];
        };
    }
    /**
   * Helper function for creating a setter closure for Properties
   */ static PROPERTY_SET(property) {
        return function(value) {
            property.value = value;
        };
    }
    /**
   * Helper function for creating a getter closure for Properties
   */ static PROPERTY_GET(property) {
        return function() {
            return property.value;
        };
    }
    /**
   * Computes the starting and ending values of this target.
   *
   * Generally called when the animation is just about to begin, so it can look up the current value if necessary.
   */ computeStartEnd() {
        assert && assert(this.to !== null || this.delta !== null);
        assert && assert(this.from !== null || this.getValue !== null);
        this.startingValue = this.from !== null ? this.from : this.getValue();
        this.endingValue = this.to !== null ? this.to : this.add(this.startingValue, this.delta);
    }
    /**
   * Updates the value of this target.
   *
   * @param ratio - How far along (from 0 to 1) in the animation.
   */ update(ratio) {
        // These should be non-null by this point
        assert && assert(this.setValue !== null);
        assert && assert(this.startingValue !== null);
        assert && assert(this.endingValue !== null);
        this.setValue(this.blend(this.startingValue, this.endingValue, this.easing.value(ratio)));
    }
    /**
   * Whether this target can define the duration of an animation.
   */ hasPreferredDuration() {
        return this.speed !== null;
    }
    /**
   * Returns the preferred duration of this target (or null if not defined).
   */ getPreferredDuration() {
        assert && assert(this.startingValue !== null);
        assert && assert(this.delta !== null);
        return this.speed === null ? null : this.speed * this.distance(this.startingValue, this.delta);
    }
    /**
   * NOTE: Generally don't use this directly. Instead, use Animation, providing config for one or more targets.
   *
   * Every animation target needs two things:
   *
   * 1. A way of getting/setting the animated value (`setValue`/`getValue`, `property`, or `object`/`attribute`).
   * 2. A way of determining the value to animate toward (`to` or `delta`).
   */ constructor(providedConfig){
        // Computed start/end values for the animation (once the animation finishes the delay and begins)
        this.startingValue = null;
        this.endingValue = null;
        const config = optionize()({
            setValue: null,
            getValue: null,
            property: null,
            object: null,
            attribute: null,
            to: null,
            delta: null,
            speed: null,
            from: null,
            easing: Easing.CUBIC_IN_OUT,
            // @ts-expect-error - Not sure how to tell it that the default doesn't work for some types, since we can't use the trickier object
            blend: AnimationTarget.DEFAULT_BLEND,
            // @ts-expect-error - Not sure how to tell it that the default doesn't work for some types, since we can't use the trickier object
            distance: AnimationTarget.DEFAULT_DISTANCE,
            // @ts-expect-error - Not sure how to tell it that the default doesn't work for some types, since we can't use the trickier object
            add: AnimationTarget.DEFAULT_ADD
        }, providedConfig);
        assert && assert(+(config.property !== null) + +(config.object !== null) + +(config.setValue !== null) === 1, 'Should have one (and only one) way of defining how to set the animated value. Use one of property/object/setValue');
        assert && assert(config.setValue === null || typeof config.setValue === 'function', 'If setValue is provided, it should be a function.');
        assert && assert(config.setValue === null || config.from !== null || typeof config.getValue === 'function', 'If setValue is provided and no "from" value is specified, then getValue needs to be a function.');
        assert && assert(config.to !== null || config.delta !== null, 'Need something to animate to, use to/delta');
        assert && assert(config.property === null || isTReadOnlyProperty(config.property) && config.property.isSettable(), 'If property is provided, it should be a settable Property or TinyProperty');
        assert && assert(config.object === null || typeof config.object === 'object' && typeof config.attribute === 'string', 'If object is provided, then object should be an object, and attribute should be a string.');
        assert && assert(config.easing instanceof Easing, 'The easing should be of type Easing');
        assert && assert(typeof config.blend === 'function', 'The blend option should be a function');
        assert && assert(typeof config.distance === 'function', 'The distance option should be a function');
        assert && assert(typeof config.add === 'function', 'The add option should be a function');
        // If `object` is provided, create the associated getter/setter
        if (config.object) {
            assert && assert(config.attribute !== null);
            // @ts-expect-error - We know that config.object is an object, but TS doesn't
            config.setValue = AnimationTarget.OBJECT_SET(config.object, config.attribute);
            // @ts-expect-error - We know that config.object is an object, but TS doesn't
            config.getValue = AnimationTarget.OBJECT_GET(config.object, config.attribute);
        }
        // If `property` is provided, create the associated getter/setter
        if (config.property) {
            config.setValue = AnimationTarget.PROPERTY_SET(config.property);
            config.getValue = AnimationTarget.PROPERTY_GET(config.property);
        }
        assert && assert(config.setValue !== null);
        this.getValue = config.getValue;
        this.setValue = config.setValue;
        this.easing = config.easing;
        this.from = config.from;
        this.to = config.to;
        this.delta = config.delta;
        this.speed = config.speed; // Saved config to help determine the length of the animation
        this.blend = config.blend;
        this.distance = config.distance;
        this.add = config.add;
    }
};
twixt.register('AnimationTarget', AnimationTarget);
export default AnimationTarget;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3R3aXh0L2pzL0FuaW1hdGlvblRhcmdldC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAyMy0yMDI0LCBVbml2ZXJzaXR5IG9mIENvbG9yYWRvIEJvdWxkZXJcblxuLyoqXG4gKiBDb250cm9scyBhIHNwZWNpZmljIGFuaW1hdGVkIHZhbHVlIGZvciBhbiBBbmltYXRpb24uXG4gKlxuICogQGF1dGhvciBKb25hdGhhbiBPbHNvbiA8am9uYXRoYW4ub2xzb25AY29sb3JhZG8uZWR1PlxuICovXG5cbmltcG9ydCBUUHJvcGVydHkgZnJvbSAnLi4vLi4vYXhvbi9qcy9UUHJvcGVydHkuanMnO1xuaW1wb3J0IHsgaXNUUmVhZE9ubHlQcm9wZXJ0eSB9IGZyb20gJy4uLy4uL2F4b24vanMvVFJlYWRPbmx5UHJvcGVydHkuanMnO1xuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xuaW1wb3J0IFZlY3RvcjMgZnJvbSAnLi4vLi4vZG90L2pzL1ZlY3RvcjMuanMnO1xuaW1wb3J0IFZlY3RvcjQgZnJvbSAnLi4vLi4vZG90L2pzL1ZlY3RvcjQuanMnO1xuaW1wb3J0IG9wdGlvbml6ZSBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcbmltcG9ydCBLZXlzTWF0Y2hpbmcgZnJvbSAnLi4vLi4vcGhldC1jb3JlL2pzL3R5cGVzL0tleXNNYXRjaGluZy5qcyc7XG5pbXBvcnQgeyBDb2xvciB9IGZyb20gJy4uLy4uL3NjZW5lcnkvanMvaW1wb3J0cy5qcyc7XG5pbXBvcnQgRWFzaW5nIGZyb20gJy4vRWFzaW5nLmpzJztcbmltcG9ydCB0d2l4dCBmcm9tICcuL3R3aXh0LmpzJztcblxudHlwZSBCbGVuZEZ1bmN0aW9uPFQ+ID0gKCBhOiBULCBiOiBULCBmcmFjdGlvbjogbnVtYmVyICkgPT4gVDtcbnR5cGUgRGlzdGFuY2VGdW5jdGlvbjxUPiA9ICggYTogVCwgYjogVCApID0+IG51bWJlcjtcbnR5cGUgQWRkRnVuY3Rpb248VD4gPSAoIGE6IFQsIGI6IFQgKSA9PiBUO1xuXG50eXBlIEludGVybmFsQW5pbWF0aW9uVGFyZ2V0T3B0aW9uczxULCBPYmogPSB1bmtub3duPiA9IHtcbiAgLypcbiAgICogTk9URTogT25lIG9mIGBzZXRWYWx1ZWAvYHByb3BlcnR5YC9gb2JqZWN0YCBpcyBSRVFVSVJFRC5cbiAgICpcbiAgICogVGhlIGFuaW1hdGlvbiBuZWVkcyB0byBiZSBhYmxlIHRvIHNldCAoYW5kIHNvbWV0aW1lcyBnZXQpIHRoZSB2YWx1ZSBiZWluZyBhbmltYXRlZC4gSW4gdGhlIG1vc3QgZ2VuZXJhbCBjYXNlLFxuICAgKiBhIGdldHRlci9zZXR0ZXIgcGFpciAoZ2V0VmFsdWUgYW5kIHNldFZhbHVlKSBjYW4gYmUgcHJvdmlkZWQuXG4gICAqXG4gICAqIEZvciBjb252ZW5pZW5jZSwgQW5pbWF0aW9uVGFyZ2V0IGFsc28gc3VwcG9ydHMgcGFzc2luZyBpbiBhbiBheG9uIFByb3BlcnR5IChwcm9wZXJ0eTopLCBvciBzZXR0aW5nIHVwIGZvciBhblxuICAgKiBhc3NpZ25tZW50IHRvIGFuIG9iamVjdCB3aXRoIG9iamVjdC9hdHRyaWJ1dGUgKGFjY2Vzc2VzIGFzIGBvYmplY3RbIGF0dHJpYnV0ZSBdYCkuXG4gICAqXG4gICAqIEUuZy46XG4gICAqXG4gICAqIG5ldyBBbmltYXRpb24oIHtcbiAgICogICBzZXRWYWx1ZTogZnVuY3Rpb24oIHZhbHVlICkgeyB3aW5kb3cudmFsdWUgPSB2YWx1ZSAqIDEwOyB9LFxuICAgKiAgIGdldFZhbHVlOiBmdW5jdGlvbigpIHsgcmV0dXJuIHdpbmRvdy52YWx1ZSAvIDEwOyB9LFxuICAgKiAgIC8vIG90aGVyIGNvbmZpZ1xuICAgKiB9IClcbiAgICpcbiAgICogdmFyIHNvbWVWZWN0b3JQcm9wZXJ0eSA9IG5ldyBwaGV0LmF4b24uUHJvcGVydHkoIG5ldyBwaGV0LmRvdC5WZWN0b3IyKCAxMCwgNSApICk7XG4gICAqIG5ldyBBbmltYXRpb24oIHtcbiAgICogICBwcm9wZXJ0eTogc29tZVZlY3RvclByb3BlcnR5LFxuICAgKiAgIC8vIG90aGVyIGNvbmZpZ1xuICAgKiB9IClcbiAgICpcbiAgICogdmFyIG9iaiA9IHsgeDogNSB9O1xuICAgKiBuZXcgQW5pbWF0aW9uKCB7XG4gICAqICAgb2JqZWN0OiBvYmosXG4gICAqICAgYXR0cmlidXRlOiAneCcsXG4gICAqICAgLy8gb3RoZXIgY29uZmlnXG4gICAqIH0gKVxuICAgKlxuICAgKiBOT1RFOiBudWxsIHZhbHVlcyBhcmUgbm90IHN1cHBvcnRlZCwgYXMgaXQgaXMgdXNlZCBhcyB0aGUgXCJubyB2YWx1ZVwiIHZhbHVlLCBhbmQgYW5pbWF0aW5nIHRvd2FyZHMgXCJudWxsXCJcbiAgICogdXN1YWxseSB3b3VsZG4ndCBtYWtlIHNlbnNlIChldmVuIGlmIHlvdSBkZWZpbmUgdGhlIHByb3BlciBpbnRlcnBvbGF0aW9uIGZ1bmN0aW9uKS5cbiAgICovXG5cbiAgLy8gSWYgcHJvdmlkZWQsIGl0IHNob3VsZCBiZSBhIGZ1bmN0aW9uIHRoYXQgYWN0cyBhcyBcInNldHRpbmdcIiB0aGUgdmFsdWUgb2YgdGhlIGFuaW1hdGlvbi5cbiAgLy8gTk9URTogZG8gbm90IHByb3ZpZGUgdGhpcyBhbmQgcHJvcGVydHkvb2JqZWN0LlxuICBzZXRWYWx1ZT86ICggKCB2YWx1ZTogVCApID0+IHZvaWQgKSB8IG51bGw7XG5cbiAgLy8gSWYgcHJvdmlkZWQsIGl0IHNob3VsZCBiZSBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgY3VycmVudCB2YWx1ZSB0aGF0IHdpbGwgYmUgYW5pbWF0ZWQuXG4gIC8vIE5PVEU6IFRoaXMgY2FuIGJlIG9taXR0ZWQsIGV2ZW4gaWYgc2V0VmFsdWUgaXMgcHJvdmlkZWQsIGlmIHRoZSBgZnJvbWAgb3B0aW9uIGlzIHNldCAoYXMgdGhlIGN1cnJlbnQgdmFsdWUgd291bGRcbiAgLy8ganVzdCBiZSBpZ25vcmVkKS5cbiAgZ2V0VmFsdWU/OiAoICgpID0+IFQgKSB8IG51bGw7XG5cbiAgLy8gSWYgcHJvdmlkZWQsIGl0IHNob3VsZCBiZSBhbiBheG9uIFByb3BlcnR5IHdpdGggdGhlIGN1cnJlbnQgdmFsdWUuIEl0IHdpbGwgYmUgbW9kaWZpZWQgYnkgdGhlIGFuaW1hdGlvbi5cbiAgLy8gTk9URTogZG8gbm90IHByb3ZpZGUgdGhpcyBhbmQgc2V0VmFsdWUvb2JqZWN0XG4gIHByb3BlcnR5PzogVFByb3BlcnR5PFQ+IHwgbnVsbDtcblxuICAvLyBJZiBwcm92aWRlZCwgaXQgc2hvdWxkIHBvaW50IHRvIGFuIG9iamVjdCB3aGVyZSBgb2JqZWN0WyBhdHRyaWJ1dGUgXWAgaXMgdGhlIHZhbHVlIHRvIGJlIG1vZGlmaWVkXG4gIC8vIGJ5IHRoZSBhbmltYXRpb24uIE5PVEU6IGRvIG5vdCBwcm92aWRlIHRoaXMgYW5kIHNldFZhbHVlL3Byb3BlcnR5XG4gIG9iamVjdD86IE9iaiB8IG51bGw7XG5cbiAgLy8gSWYgYG9iamVjdGAgaXMgcHJvdmlkZWQsIGl0IHNob3VsZCBiZSBhIHN0cmluZyBzdWNoIHRoYXQgYG9iamVjdFsgYXR0cmlidXRlIF1gIGlzIHRoZSB2YWx1ZSB0byBiZSBtb2RpZmllZC5cbiAgYXR0cmlidXRlPzogS2V5c01hdGNoaW5nPE9iaiwgVD4gfCBudWxsO1xuXG4gIC8qXG4gICAqIE5PVEU6IG9uZSBvZiBgdG9gL2BkZWx0YWAgaXMgUkVRVUlSRUQuXG4gICAqXG4gICAqIFRoZSBlbmQgdmFsdWUgb2YgdGhlIGFuaW1hdGlvbiBuZWVkcyB0byBiZSBzcGVjaWZpZWQsIGJ1dCB0aGVyZSBhcmUgbXVsdGlwbGUgd2F5cyB0byBkbyBzby4gSWYgeW91IGtub3cgdGhlXG4gICAqIGV4YWN0IGVuZCB2YWx1ZSwgaXQgY2FuIGJlIHByb3ZpZGVkIHdpdGggYHRvOiB2YWx1ZWAuIFRoZW4gZXZlcnkgdGltZSB0aGUgYW5pbWF0aW9uIGlzIHJ1biwgaXQgd2lsbCBnbyB0byB0aGF0XG4gICAqIHZhbHVlLlxuICAgKlxuICAgKiBJdCBpcyBhbHNvIHBvc3NpYmxlIHRvIHByb3ZpZGUgYGRlbHRhOiB2YWx1ZWAgd2hpY2ggd2lsbCBhcHBseSBhIHJlbGF0aXZlIGFuaW1hdGlvbiBieSB0aGF0IGFtb3VudCAoZS5nLiBmb3JcbiAgICogbnVtYmVycywgYGRlbHRhOiA1YCB3b3VsZCBpbmRpY2F0ZSB0aGF0IHRoZSBhbmltYXRpb24gd2lsbCBpbmNyZWFzZSB0aGUgdmFsdWUgYnkgNSBldmVyeSB0aW1lIGl0IGlzIHJ1bikuXG4gICAqL1xuXG4gIC8vIElmIHByb3ZpZGVkLCB0aGUgYW5pbWF0aW9uIHdpbGwgdHJlYXQgdGhpcyBhcyB0aGUgZW5kIHZhbHVlICh3aGF0IGl0IGFuaW1hdGVzIHRvd2FyZCkuXG4gIHRvPzogVCB8IG51bGw7XG5cbiAgLy8gSWYgcHJvdmlkZWQsIHRoZSBhbmltYXRpb24gd2lsbCB0cmVhdCB0aGUgZW5kaW5nIHZhbHVlIG9mIHRoZSBhbmltYXRpb24gYXMgdGhlIHN0YXJ0aW5nIHZhbHVlIHBsdXMgdGhpcyBkZWx0YVxuICAvLyB2YWx1ZS4gVG8gZGV0ZXJtaW5lIHRoZSBleGFjdCB2YWx1ZSwgdGhlIGBhZGRgIG9wdGlvbiB3aWxsIGJlIHVzZWQgKHdoaWNoIGJ5IGRlZmF1bHQgaGFuZGxlc1xuICAvLyBudW1iZXIvVmVjdG9yMi9WZWN0b3IzL1ZlY3RvcjQgYXMgZXhwZWN0ZWQpLiBUaGUgYW5pbWF0aW9uIGNhbiBiZSBydW4gbXVsdGlwbGUgdGltZXMsIGFuZCBlYWNoIHRpbWUgaXQgd2lsbCB1c2VcbiAgLy8gdGhlIFwic3RhcnRpbmdcIiB2YWx1ZSBmcm9tIGxhc3QgdGltZSAodW5sZXNzIHRoZSBgZnJvbWAgb3B0aW9uIGlzIHVzZWQpLlxuICBkZWx0YT86IFQgfCBudWxsO1xuXG4gIC8vIElmIHByb3ZpZGVkLCB0aGUgYW5pbWF0aW9uJ3MgbGVuZ3RoIHdpbGwgYmUgdGhpcyB2YWx1ZSAoc2Vjb25kcy91bml0KSB0aW1lcyB0aGUgXCJkaXN0YW5jZVwiIGJldHdlZW4gdGhlIHN0YXJ0IGFuZFxuICAvLyBlbmQgdmFsdWUgb2YgdGhlIGFuaW1hdGlvbi4gVGhlIGBkaXN0YW5jZWAgb3B0aW9uIGNhbiBiZSB1c2VkIHRvIHNwZWNpZnkgYSB3YXkgdG8gY29tcHV0ZSB0aGUgZGlzdGFuY2UsIGFuZCB3b3Jrc1xuICAvLyBieSBkZWZhdWx0IGFzIGV4cGVjdGVkIGZvciBudW1iZXIvVmVjdG9yMi9WZWN0b3IzL1ZlY3RvcjQuXG4gIHNwZWVkPzogbnVtYmVyIHwgbnVsbDtcblxuICAvLyBJZiBwcm92aWRlZCwgdGhlIGFuaW1hdGlvbiB3aWxsIHN0YXJ0IGZyb20gdGhpcyB2YWx1ZSAoaW5zdGVhZCBvZiBnZXR0aW5nIHRoZSBjdXJyZW50IHZhbHVlIHRvIHN0YXJ0IGZyb20pLlxuICBmcm9tPzogVCB8IG51bGw7XG5cbiAgLy8gQ29udHJvbHMgdGhlIHJlbGF0aXZlIG1vdGlvbiBmcm9tIHRoZSBzdGFydGluZyB2YWx1ZSB0byB0aGUgZW5kaW5nIHZhbHVlLiBTZWUgRWFzaW5nLmpzIGZvciBpbmZvLlxuICBlYXNpbmc/OiBFYXNpbmc7XG5cbiAgLy8gU2hvdWxkIGJlIG9mIHRoZSBmb3JtIGBmdW5jdGlvbiggc3RhcnQ6IHsqfSwgZW5kOiB7Kn0sIHJhdGlvOiB7bnVtYmVyfSApOiB7Kn1gIHdoZXJlIHRoZSByYXRpbyB3aWxsIGJlIGJldHdlZW4gMFxuICAvLyBhbmQgMSAoaW5jbHVzaXZlKS4gSWYgdGhlIHJhdGlvIGlzIDAsIGl0IHNob3VsZCByZXR1cm4gdGhlIHN0YXJ0aW5nIHZhbHVlLCBpZiB0aGUgcmF0aW8gaXMgMSwgaXQgc2hvdWxkIHJldHVybiB0aGVcbiAgLy8gZW5kaW5nIHZhbHVlLCBhbmQgb3RoZXJ3aXNlIGl0IHNob3VsZCByZXR1cm4gdGhlIGJlc3QgaW50ZXJwb2xhdGlvbiBwb3NzaWJsZSBiZXR3ZWVuIHRoZSB0d28gdmFsdWVzLiBUaGUgZGVmYXVsdFxuICAvLyBzaG91bGQgd29yayBmb3IgbnVtYmVyL1ZlY3RvcjIvVmVjdG9yMy9WZWN0b3I0L0NvbG9yLCBidXQgZm9yIG90aGVyIHR5cGVzIGVpdGhlciBgc3RhcnQuYmxlbmQoIGVuZCwgcmF0aW8gKWAgc2hvdWxkXG4gIC8vIGJlIGRlZmluZWQgYW5kIHdvcmssIG9yIHRoaXMgZnVuY3Rpb24gc2hvdWxkIGJlIG92ZXJyaWRkZW4uXG4gIGJsZW5kPzogQmxlbmRGdW5jdGlvbjxUPjtcblxuICAvLyBTaG91bGQgYmUgb2YgdGhlIGZvcm0gYGZ1bmN0aW9uKCBzdGFydDogeyp9LCBlbmQ6IHsqfSApOiB7bnVtYmVyfWAsIGFuZCBpdCBzaG91bGQgcmV0dXJuIGEgbWVhc3VyZVxuICAvLyBvZiBkaXN0YW5jZSAoYSBtZXRyaWMpIGJldHdlZW4gdGhlIHR3byB2YWx1ZXMuIFRoaXMgaXMgb25seSB1c2VkIGZvciBpZiB0aGUgYHNwZWVkYCBvcHRpb24gaXMgcHJvdmlkZWQgKHNvIGl0XG4gIC8vIGNhbiBkZXRlcm1pbmUgdGhlIGxlbmd0aCBvZiB0aGUgYW5pbWF0aW9uKS4gVGhlIGRlZmF1bHQgc2hvdWxkIHdvcmsgZm9yIG51bWJlci9WZWN0b3IyL1ZlY3RvcjMvVmVjdG9yNC5cbiAgZGlzdGFuY2U/OiBEaXN0YW5jZUZ1bmN0aW9uPFQ+O1xuXG4gIC8vIFNob3VsZCBiZSBvZiB0aGUgZm9ybSBgZnVuY3Rpb24oIHN0YXJ0OiB7Kn0sIGRlbHRhOiB7Kn0gKTogeyp9YCB3aGVyZSBpdCBhZGRzIHRvZ2V0aGVyIGEgdmFsdWVcbiAgLy8gYW5kIGEgXCJkZWx0YVwiICh1c3VhbGx5IGp1c3QgYSB2YWx1ZSBvZiB0aGUgc2FtZSB0eXBlKSBhbmQgcmV0dXJucyB0aGUgcmVzdWx0LiBUaGlzIGlzIHVzZWQgZm9yIHRoZSBgZGVsdGFgXG4gIC8vIG9wdGlvbi4gVGhlIGRlZmF1bHQgc2hvdWxkIHdvcmsgZm9yIG51bWJlci9WZWN0b3IyL1ZlY3RvcjMvVmVjdG9yNC5cbiAgYWRkPzogQWRkRnVuY3Rpb248VD47XG59O1xuXG4vLyBUeXBlcyBvZiB0aGluZ3Mgd2hlcmUgdGhlIGRlZmF1bHQgYmxlbmQvZGlzdGFuY2UvYWRkIG9wdGlvbnMgd2lsbCB3b3JrXG50eXBlIERlZmF1bHRCbGVuZGFibGVUeXBlPFQ+ID0gbnVtYmVyIHwgeyBibGVuZDogKCBiOiBULCByYXRpbzogbnVtYmVyICkgPT4gVCB9O1xudHlwZSBEZWZhdWx0RGlzdGFuY2VhYmxlVHlwZTxUPiA9IG51bWJlciB8IHsgZGlzdGFuY2U6ICggYjogVCApID0+IG51bWJlciB9O1xudHlwZSBEZWZhdWx0QWRkYWJsZVR5cGU8VD4gPSBudW1iZXIgfCB7IHBsdXM6ICggYjogVCApID0+IFQgfTtcblxuZXhwb3J0IHR5cGUgQW5pbWF0aW9uVGFyZ2V0T3B0aW9uczxUID0gdW5rbm93biwgT2JqID0gdW5rbm93bj4gPSBJbnRlcm5hbEFuaW1hdGlvblRhcmdldE9wdGlvbnM8VCwgT2JqPjtcblxuY2xhc3MgQW5pbWF0aW9uVGFyZ2V0PFQsIE9iaiA9IHVua25vd24+IHtcblxuICBwcml2YXRlIHJlYWRvbmx5IHNldFZhbHVlOiAoICggdmFsdWU6IFQgKSA9PiB2b2lkICk7XG4gIHByaXZhdGUgcmVhZG9ubHkgZ2V0VmFsdWU6ICggKCkgPT4gVCApIHwgbnVsbDtcbiAgcHJpdmF0ZSByZWFkb25seSBlYXNpbmc6IEVhc2luZztcbiAgcHJpdmF0ZSByZWFkb25seSB0bzogVCB8IG51bGw7XG4gIHByaXZhdGUgcmVhZG9ubHkgZnJvbTogVCB8IG51bGw7XG4gIHByaXZhdGUgcmVhZG9ubHkgZGVsdGE6IFQgfCBudWxsO1xuICBwcml2YXRlIHJlYWRvbmx5IHNwZWVkOiBudW1iZXIgfCBudWxsO1xuICBwcml2YXRlIHJlYWRvbmx5IGJsZW5kOiBCbGVuZEZ1bmN0aW9uPFQ+O1xuICBwcml2YXRlIHJlYWRvbmx5IGRpc3RhbmNlOiBEaXN0YW5jZUZ1bmN0aW9uPFQ+O1xuICBwcml2YXRlIHJlYWRvbmx5IGFkZDogQWRkRnVuY3Rpb248VD47XG5cbiAgLy8gQ29tcHV0ZWQgc3RhcnQvZW5kIHZhbHVlcyBmb3IgdGhlIGFuaW1hdGlvbiAob25jZSB0aGUgYW5pbWF0aW9uIGZpbmlzaGVzIHRoZSBkZWxheSBhbmQgYmVnaW5zKVxuICBwcml2YXRlIHN0YXJ0aW5nVmFsdWU6IFQgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBlbmRpbmdWYWx1ZTogVCB8IG51bGwgPSBudWxsO1xuXG4gIC8qKlxuICAgKiBOT1RFOiBHZW5lcmFsbHkgZG9uJ3QgdXNlIHRoaXMgZGlyZWN0bHkuIEluc3RlYWQsIHVzZSBBbmltYXRpb24sIHByb3ZpZGluZyBjb25maWcgZm9yIG9uZSBvciBtb3JlIHRhcmdldHMuXG4gICAqXG4gICAqIEV2ZXJ5IGFuaW1hdGlvbiB0YXJnZXQgbmVlZHMgdHdvIHRoaW5nczpcbiAgICpcbiAgICogMS4gQSB3YXkgb2YgZ2V0dGluZy9zZXR0aW5nIHRoZSBhbmltYXRlZCB2YWx1ZSAoYHNldFZhbHVlYC9gZ2V0VmFsdWVgLCBgcHJvcGVydHlgLCBvciBgb2JqZWN0YC9gYXR0cmlidXRlYCkuXG4gICAqIDIuIEEgd2F5IG9mIGRldGVybWluaW5nIHRoZSB2YWx1ZSB0byBhbmltYXRlIHRvd2FyZCAoYHRvYCBvciBgZGVsdGFgKS5cbiAgICovXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcHJvdmlkZWRDb25maWc6IEFuaW1hdGlvblRhcmdldE9wdGlvbnM8VCwgT2JqPiApIHtcblxuICAgIGNvbnN0IGNvbmZpZyA9IG9wdGlvbml6ZTxJbnRlcm5hbEFuaW1hdGlvblRhcmdldE9wdGlvbnM8VCwgT2JqPiwgSW50ZXJuYWxBbmltYXRpb25UYXJnZXRPcHRpb25zPFQsIE9iaj4+KCkoIHtcbiAgICAgIHNldFZhbHVlOiBudWxsLFxuICAgICAgZ2V0VmFsdWU6IG51bGwsXG4gICAgICBwcm9wZXJ0eTogbnVsbCxcbiAgICAgIG9iamVjdDogbnVsbCxcbiAgICAgIGF0dHJpYnV0ZTogbnVsbCxcbiAgICAgIHRvOiBudWxsLFxuICAgICAgZGVsdGE6IG51bGwsXG4gICAgICBzcGVlZDogbnVsbCxcbiAgICAgIGZyb206IG51bGwsXG4gICAgICBlYXNpbmc6IEVhc2luZy5DVUJJQ19JTl9PVVQsXG5cbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLSBOb3Qgc3VyZSBob3cgdG8gdGVsbCBpdCB0aGF0IHRoZSBkZWZhdWx0IGRvZXNuJ3Qgd29yayBmb3Igc29tZSB0eXBlcywgc2luY2Ugd2UgY2FuJ3QgdXNlIHRoZSB0cmlja2llciBvYmplY3RcbiAgICAgIGJsZW5kOiBBbmltYXRpb25UYXJnZXQuREVGQVVMVF9CTEVORCxcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLSBOb3Qgc3VyZSBob3cgdG8gdGVsbCBpdCB0aGF0IHRoZSBkZWZhdWx0IGRvZXNuJ3Qgd29yayBmb3Igc29tZSB0eXBlcywgc2luY2Ugd2UgY2FuJ3QgdXNlIHRoZSB0cmlja2llciBvYmplY3RcbiAgICAgIGRpc3RhbmNlOiBBbmltYXRpb25UYXJnZXQuREVGQVVMVF9ESVNUQU5DRSxcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLSBOb3Qgc3VyZSBob3cgdG8gdGVsbCBpdCB0aGF0IHRoZSBkZWZhdWx0IGRvZXNuJ3Qgd29yayBmb3Igc29tZSB0eXBlcywgc2luY2Ugd2UgY2FuJ3QgdXNlIHRoZSB0cmlja2llciBvYmplY3RcbiAgICAgIGFkZDogQW5pbWF0aW9uVGFyZ2V0LkRFRkFVTFRfQUREXG4gICAgfSwgcHJvdmlkZWRDb25maWcgKTtcblxuICAgIGFzc2VydCAmJiBhc3NlcnQoICsoIGNvbmZpZy5wcm9wZXJ0eSAhPT0gbnVsbCApICsgKyggY29uZmlnLm9iamVjdCAhPT0gbnVsbCApICsgKyggY29uZmlnLnNldFZhbHVlICE9PSBudWxsICkgPT09IDEsXG4gICAgICAnU2hvdWxkIGhhdmUgb25lIChhbmQgb25seSBvbmUpIHdheSBvZiBkZWZpbmluZyBob3cgdG8gc2V0IHRoZSBhbmltYXRlZCB2YWx1ZS4gVXNlIG9uZSBvZiBwcm9wZXJ0eS9vYmplY3Qvc2V0VmFsdWUnICk7XG5cbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBjb25maWcuc2V0VmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIGNvbmZpZy5zZXRWYWx1ZSA9PT0gJ2Z1bmN0aW9uJyxcbiAgICAgICdJZiBzZXRWYWx1ZSBpcyBwcm92aWRlZCwgaXQgc2hvdWxkIGJlIGEgZnVuY3Rpb24uJyApO1xuXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggY29uZmlnLnNldFZhbHVlID09PSBudWxsIHx8IGNvbmZpZy5mcm9tICE9PSBudWxsIHx8IHR5cGVvZiBjb25maWcuZ2V0VmFsdWUgPT09ICdmdW5jdGlvbicsXG4gICAgICAnSWYgc2V0VmFsdWUgaXMgcHJvdmlkZWQgYW5kIG5vIFwiZnJvbVwiIHZhbHVlIGlzIHNwZWNpZmllZCwgdGhlbiBnZXRWYWx1ZSBuZWVkcyB0byBiZSBhIGZ1bmN0aW9uLicgKTtcblxuICAgIGFzc2VydCAmJiBhc3NlcnQoIGNvbmZpZy50byAhPT0gbnVsbCB8fCBjb25maWcuZGVsdGEgIT09IG51bGwsXG4gICAgICAnTmVlZCBzb21ldGhpbmcgdG8gYW5pbWF0ZSB0bywgdXNlIHRvL2RlbHRhJyApO1xuXG4gICAgYXNzZXJ0ICYmIGFzc2VydChcbiAgICAgIGNvbmZpZy5wcm9wZXJ0eSA9PT0gbnVsbCB8fFxuICAgICAgKCAoIGlzVFJlYWRPbmx5UHJvcGVydHkoIGNvbmZpZy5wcm9wZXJ0eSApICkgJiYgY29uZmlnLnByb3BlcnR5LmlzU2V0dGFibGUoKSApLFxuICAgICAgJ0lmIHByb3BlcnR5IGlzIHByb3ZpZGVkLCBpdCBzaG91bGQgYmUgYSBzZXR0YWJsZSBQcm9wZXJ0eSBvciBUaW55UHJvcGVydHknICk7XG5cbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCBjb25maWcub2JqZWN0ID09PSBudWxsIHx8ICggdHlwZW9mIGNvbmZpZy5vYmplY3QgPT09ICdvYmplY3QnICYmIHR5cGVvZiBjb25maWcuYXR0cmlidXRlID09PSAnc3RyaW5nJyApLFxuICAgICAgJ0lmIG9iamVjdCBpcyBwcm92aWRlZCwgdGhlbiBvYmplY3Qgc2hvdWxkIGJlIGFuIG9iamVjdCwgYW5kIGF0dHJpYnV0ZSBzaG91bGQgYmUgYSBzdHJpbmcuJyApO1xuXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggY29uZmlnLmVhc2luZyBpbnN0YW5jZW9mIEVhc2luZywgJ1RoZSBlYXNpbmcgc2hvdWxkIGJlIG9mIHR5cGUgRWFzaW5nJyApO1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBjb25maWcuYmxlbmQgPT09ICdmdW5jdGlvbicsICdUaGUgYmxlbmQgb3B0aW9uIHNob3VsZCBiZSBhIGZ1bmN0aW9uJyApO1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBjb25maWcuZGlzdGFuY2UgPT09ICdmdW5jdGlvbicsICdUaGUgZGlzdGFuY2Ugb3B0aW9uIHNob3VsZCBiZSBhIGZ1bmN0aW9uJyApO1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIHR5cGVvZiBjb25maWcuYWRkID09PSAnZnVuY3Rpb24nLCAnVGhlIGFkZCBvcHRpb24gc2hvdWxkIGJlIGEgZnVuY3Rpb24nICk7XG5cbiAgICAvLyBJZiBgb2JqZWN0YCBpcyBwcm92aWRlZCwgY3JlYXRlIHRoZSBhc3NvY2lhdGVkIGdldHRlci9zZXR0ZXJcbiAgICBpZiAoIGNvbmZpZy5vYmplY3QgKSB7XG4gICAgICBhc3NlcnQgJiYgYXNzZXJ0KCBjb25maWcuYXR0cmlidXRlICE9PSBudWxsICk7XG5cbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLSBXZSBrbm93IHRoYXQgY29uZmlnLm9iamVjdCBpcyBhbiBvYmplY3QsIGJ1dCBUUyBkb2Vzbid0XG4gICAgICBjb25maWcuc2V0VmFsdWUgPSBBbmltYXRpb25UYXJnZXQuT0JKRUNUX1NFVCggY29uZmlnLm9iamVjdCwgY29uZmlnLmF0dHJpYnV0ZSApO1xuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAtIFdlIGtub3cgdGhhdCBjb25maWcub2JqZWN0IGlzIGFuIG9iamVjdCwgYnV0IFRTIGRvZXNuJ3RcbiAgICAgIGNvbmZpZy5nZXRWYWx1ZSA9IEFuaW1hdGlvblRhcmdldC5PQkpFQ1RfR0VUKCBjb25maWcub2JqZWN0LCBjb25maWcuYXR0cmlidXRlICk7XG4gICAgfVxuXG4gICAgLy8gSWYgYHByb3BlcnR5YCBpcyBwcm92aWRlZCwgY3JlYXRlIHRoZSBhc3NvY2lhdGVkIGdldHRlci9zZXR0ZXJcbiAgICBpZiAoIGNvbmZpZy5wcm9wZXJ0eSApIHtcbiAgICAgIGNvbmZpZy5zZXRWYWx1ZSA9IEFuaW1hdGlvblRhcmdldC5QUk9QRVJUWV9TRVQoIGNvbmZpZy5wcm9wZXJ0eSApO1xuICAgICAgY29uZmlnLmdldFZhbHVlID0gQW5pbWF0aW9uVGFyZ2V0LlBST1BFUlRZX0dFVCggY29uZmlnLnByb3BlcnR5ICk7XG4gICAgfVxuXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggY29uZmlnLnNldFZhbHVlICE9PSBudWxsICk7XG5cbiAgICB0aGlzLmdldFZhbHVlID0gY29uZmlnLmdldFZhbHVlO1xuICAgIHRoaXMuc2V0VmFsdWUgPSBjb25maWcuc2V0VmFsdWUhO1xuICAgIHRoaXMuZWFzaW5nID0gY29uZmlnLmVhc2luZztcbiAgICB0aGlzLmZyb20gPSBjb25maWcuZnJvbTtcbiAgICB0aGlzLnRvID0gY29uZmlnLnRvO1xuICAgIHRoaXMuZGVsdGEgPSBjb25maWcuZGVsdGE7XG4gICAgdGhpcy5zcGVlZCA9IGNvbmZpZy5zcGVlZDsgLy8gU2F2ZWQgY29uZmlnIHRvIGhlbHAgZGV0ZXJtaW5lIHRoZSBsZW5ndGggb2YgdGhlIGFuaW1hdGlvblxuICAgIHRoaXMuYmxlbmQgPSBjb25maWcuYmxlbmQ7XG4gICAgdGhpcy5kaXN0YW5jZSA9IGNvbmZpZy5kaXN0YW5jZTtcbiAgICB0aGlzLmFkZCA9IGNvbmZpZy5hZGQ7XG4gIH1cblxuICAvKipcbiAgICogRGVmYXVsdCBibGVuZGluZyBmdW5jdGlvbiBmb3IgdGhlIGBibGVuZGAgZnVuY3Rpb24uXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIERFRkFVTFRfQkxFTkQoIGE6IG51bWJlciwgYjogbnVtYmVyLCByYXRpbzogbnVtYmVyICk6IG51bWJlcjtcbiAgcHVibGljIHN0YXRpYyBERUZBVUxUX0JMRU5EKCBhOiBDb2xvciwgYjogQ29sb3IsIHJhdGlvOiBudW1iZXIgKTogQ29sb3I7XG4gIHB1YmxpYyBzdGF0aWMgREVGQVVMVF9CTEVORCggYTogVmVjdG9yMiwgYjogVmVjdG9yMiwgcmF0aW86IG51bWJlciApOiBWZWN0b3IyO1xuICBwdWJsaWMgc3RhdGljIERFRkFVTFRfQkxFTkQoIGE6IFZlY3RvcjMsIGI6IFZlY3RvcjMsIHJhdGlvOiBudW1iZXIgKTogVmVjdG9yMztcbiAgcHVibGljIHN0YXRpYyBERUZBVUxUX0JMRU5EKCBhOiBWZWN0b3I0LCBiOiBWZWN0b3I0LCByYXRpbzogbnVtYmVyICk6IFZlY3RvcjQ7XG4gIHB1YmxpYyBzdGF0aWMgREVGQVVMVF9CTEVORDxUIGV4dGVuZHMgRGVmYXVsdEJsZW5kYWJsZVR5cGU8VD4+KCBhOiBULCBiOiBULCByYXRpbzogbnVtYmVyICk6IFQge1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIGlzRmluaXRlKCByYXRpbyApICYmIHJhdGlvID49IDAgJiYgcmF0aW8gPD0gMSwgYEludmFsaWQgcmF0aW86ICR7cmF0aW99YCApO1xuXG4gICAgaWYgKCByYXRpbyA9PT0gMCApIHsgcmV0dXJuIGE7IH1cbiAgICBpZiAoIHJhdGlvID09PSAxICkgeyByZXR1cm4gYjsgfVxuXG4gICAgaWYgKCB0eXBlb2YgYSA9PT0gJ251bWJlcicgJiYgdHlwZW9mIGIgPT09ICdudW1iZXInICkge1xuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAtIEl0IGNhbid0IGRldGVjdCB3ZSdyZSBpbiB0aGUgVCA9PT0gbnVtYmVyIGNhc2UuXG4gICAgICByZXR1cm4gYSArICggYiAtIGEgKSAqIHJhdGlvO1xuICAgIH1cbiAgICBpZiAoIHR5cGVvZiBhID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgYiA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGEuYmxlbmQgPT09ICdmdW5jdGlvbicgKSB7XG4gICAgICByZXR1cm4gYS5ibGVuZCggYiwgcmF0aW8gKTtcbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgRXJyb3IoIGBCbGVuZGluZyBub3Qgc3VwcG9ydGVkIGZvcjogJHtKU09OLnN0cmluZ2lmeSggYSApfSwgJHtKU09OLnN0cmluZ2lmeSggYiApfSwgcGFzcyBpbiBhIGJsZW5kIG9wdGlvbmAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWZhdWx0IGRpc3RhbmNlIGZ1bmN0aW9uIGZvciB0aGUgYGRpc3RhbmNlYCBvcHRpb24gKHVzZWQgZm9yIHRoZSBgc3BlZWRgIG9wdGlvbilcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgREVGQVVMVF9ESVNUQU5DRSggYTogbnVtYmVyLCBiOiBudW1iZXIgKTogbnVtYmVyO1xuICBwdWJsaWMgc3RhdGljIERFRkFVTFRfRElTVEFOQ0UoIGE6IFZlY3RvcjIsIGI6IFZlY3RvcjIgKTogbnVtYmVyO1xuICBwdWJsaWMgc3RhdGljIERFRkFVTFRfRElTVEFOQ0UoIGE6IFZlY3RvcjMsIGI6IFZlY3RvcjMgKTogbnVtYmVyO1xuICBwdWJsaWMgc3RhdGljIERFRkFVTFRfRElTVEFOQ0UoIGE6IFZlY3RvcjQsIGI6IFZlY3RvcjQgKTogbnVtYmVyO1xuICBwdWJsaWMgc3RhdGljIERFRkFVTFRfRElTVEFOQ0U8VCBleHRlbmRzIERlZmF1bHREaXN0YW5jZWFibGVUeXBlPFQ+PiggYTogVCwgYjogVCApOiBudW1iZXIge1xuICAgIGlmICggdHlwZW9mIGEgPT09ICdudW1iZXInICYmIHR5cGVvZiBiID09PSAnbnVtYmVyJyApIHtcbiAgICAgIHJldHVybiBNYXRoLmFicyggYSAtIGIgKTtcbiAgICB9XG4gICAgaWYgKCB0eXBlb2YgYSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGIgPT09ICdvYmplY3QnICYmIHR5cGVvZiBhLmRpc3RhbmNlID09PSAnZnVuY3Rpb24nICkge1xuICAgICAgcmV0dXJuIGEuZGlzdGFuY2UoIGIgKTtcbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgRXJyb3IoIGBEaXN0YW5jZSAocmVxdWlyZWQgZm9yIHNwZWVkKSBieSBkZWZhdWx0IG5vdCBzdXBwb3J0ZWQgZm9yOiAke0pTT04uc3RyaW5naWZ5KCBhICl9LCAke0pTT04uc3RyaW5naWZ5KCBiICl9LCBwYXNzIGluIGEgZGlzdGFuY2Ugb3B0aW9uYCApO1xuICB9XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgYWRkaXRpb24gZnVuY3Rpb24gZm9yIHRoZSBgYWRkYCBvcHRpb24gKHVzZWQgZm9yIHRoZSBgZGVsdGFgIG9wdGlvbilcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgREVGQVVMVF9BREQoIGE6IG51bWJlciwgYjogbnVtYmVyICk6IG51bWJlcjtcbiAgcHVibGljIHN0YXRpYyBERUZBVUxUX0FERCggYTogVmVjdG9yMiwgYjogVmVjdG9yMiApOiBWZWN0b3IyO1xuICBwdWJsaWMgc3RhdGljIERFRkFVTFRfQUREKCBhOiBWZWN0b3IzLCBiOiBWZWN0b3IzICk6IFZlY3RvcjM7XG4gIHB1YmxpYyBzdGF0aWMgREVGQVVMVF9BREQoIGE6IFZlY3RvcjQsIGI6IFZlY3RvcjQgKTogVmVjdG9yNDtcbiAgcHVibGljIHN0YXRpYyBERUZBVUxUX0FERDxUIGV4dGVuZHMgRGVmYXVsdEFkZGFibGVUeXBlPFQ+PiggYTogVCwgYjogVCApOiBUIHtcbiAgICBpZiAoIHR5cGVvZiBhID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgYiA9PT0gJ251bWJlcicgKSB7XG4gICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIC0gSXQgY2FuJ3QgZGV0ZWN0IHdlJ3JlIGluIHRoZSBUID09PSBudW1iZXIgY2FzZS5cbiAgICAgIHJldHVybiBhICsgYjtcbiAgICB9XG4gICAgaWYgKCB0eXBlb2YgYSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGIgPT09ICdvYmplY3QnICYmIHR5cGVvZiBhLnBsdXMgPT09ICdmdW5jdGlvbicgKSB7XG4gICAgICByZXR1cm4gYS5wbHVzKCBiICk7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKCBgQWRkaXRpb24gKHJlcXVpcmVkIGZvciBkZWx0YSkgYnkgZGVmYXVsdCBub3Qgc3VwcG9ydGVkIGZvcjogJHtKU09OLnN0cmluZ2lmeSggYSApfSwgJHtKU09OLnN0cmluZ2lmeSggYiApfSwgcGFzcyBpbiBhbiBhZGQgb3B0aW9uYCApO1xuICB9XG5cbiAgLyoqXG4gICAqIEhlbHBlciBmdW5jdGlvbiBmb3IgY3JlYXRpbmcgYSBzZXR0ZXIgY2xvc3VyZSBmb3Igb2JqZWN0WyBhdHRyaWJ1dGUgXS5cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIE9CSkVDVF9TRVQ8T2JqLCBBdHRyIGV4dGVuZHMga2V5b2YgT2JqPiggb2JqZWN0OiBPYmosIGF0dHJpYnV0ZTogQXR0ciApOiAoIHZhbHVlOiBPYmpbIEF0dHIgXSApID0+IHZvaWQge1xuICAgIHJldHVybiBmdW5jdGlvbiggdmFsdWUgKSB7XG4gICAgICBvYmplY3RbIGF0dHJpYnV0ZSBdID0gdmFsdWU7XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIZWxwZXIgZnVuY3Rpb24gZm9yIGNyZWF0aW5nIGEgZ2V0dGVyIGNsb3N1cmUgZm9yIG9iamVjdFsgYXR0cmlidXRlIF0uXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBPQkpFQ1RfR0VUPE9iaiwgQXR0ciBleHRlbmRzIGtleW9mIE9iaj4oIG9iamVjdDogT2JqLCBhdHRyaWJ1dGU6IEF0dHIgKTogKCkgPT4gT2JqWyBBdHRyIF0ge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBvYmplY3RbIGF0dHJpYnV0ZSBdO1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogSGVscGVyIGZ1bmN0aW9uIGZvciBjcmVhdGluZyBhIHNldHRlciBjbG9zdXJlIGZvciBQcm9wZXJ0aWVzXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBQUk9QRVJUWV9TRVQ8VD4oIHByb3BlcnR5OiBUUHJvcGVydHk8VD4gKTogKCB2YWx1ZTogVCApID0+IHZvaWQge1xuICAgIHJldHVybiBmdW5jdGlvbiggdmFsdWUgKSB7XG4gICAgICBwcm9wZXJ0eS52YWx1ZSA9IHZhbHVlO1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogSGVscGVyIGZ1bmN0aW9uIGZvciBjcmVhdGluZyBhIGdldHRlciBjbG9zdXJlIGZvciBQcm9wZXJ0aWVzXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBQUk9QRVJUWV9HRVQ8VD4oIHByb3BlcnR5OiBUUHJvcGVydHk8VD4gKTogKCkgPT4gVCB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHByb3BlcnR5LnZhbHVlO1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ29tcHV0ZXMgdGhlIHN0YXJ0aW5nIGFuZCBlbmRpbmcgdmFsdWVzIG9mIHRoaXMgdGFyZ2V0LlxuICAgKlxuICAgKiBHZW5lcmFsbHkgY2FsbGVkIHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBqdXN0IGFib3V0IHRvIGJlZ2luLCBzbyBpdCBjYW4gbG9vayB1cCB0aGUgY3VycmVudCB2YWx1ZSBpZiBuZWNlc3NhcnkuXG4gICAqL1xuICBwdWJsaWMgY29tcHV0ZVN0YXJ0RW5kKCk6IHZvaWQge1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMudG8gIT09IG51bGwgfHwgdGhpcy5kZWx0YSAhPT0gbnVsbCApO1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMuZnJvbSAhPT0gbnVsbCB8fCB0aGlzLmdldFZhbHVlICE9PSBudWxsICk7XG5cbiAgICB0aGlzLnN0YXJ0aW5nVmFsdWUgPSAoIHRoaXMuZnJvbSAhPT0gbnVsbCApID8gdGhpcy5mcm9tIDogdGhpcy5nZXRWYWx1ZSEoKTtcbiAgICB0aGlzLmVuZGluZ1ZhbHVlID0gKCB0aGlzLnRvICE9PSBudWxsICkgPyB0aGlzLnRvIDogdGhpcy5hZGQoIHRoaXMuc3RhcnRpbmdWYWx1ZSwgdGhpcy5kZWx0YSEgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSB2YWx1ZSBvZiB0aGlzIHRhcmdldC5cbiAgICpcbiAgICogQHBhcmFtIHJhdGlvIC0gSG93IGZhciBhbG9uZyAoZnJvbSAwIHRvIDEpIGluIHRoZSBhbmltYXRpb24uXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlKCByYXRpbzogbnVtYmVyICk6IHZvaWQge1xuICAgIC8vIFRoZXNlIHNob3VsZCBiZSBub24tbnVsbCBieSB0aGlzIHBvaW50XG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy5zZXRWYWx1ZSAhPT0gbnVsbCApO1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMuc3RhcnRpbmdWYWx1ZSAhPT0gbnVsbCApO1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMuZW5kaW5nVmFsdWUgIT09IG51bGwgKTtcblxuICAgIHRoaXMuc2V0VmFsdWUoIHRoaXMuYmxlbmQoIHRoaXMuc3RhcnRpbmdWYWx1ZSEsIHRoaXMuZW5kaW5nVmFsdWUhLCB0aGlzLmVhc2luZy52YWx1ZSggcmF0aW8gKSApICk7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGlzIHRhcmdldCBjYW4gZGVmaW5lIHRoZSBkdXJhdGlvbiBvZiBhbiBhbmltYXRpb24uXG4gICAqL1xuICBwdWJsaWMgaGFzUHJlZmVycmVkRHVyYXRpb24oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc3BlZWQgIT09IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgcHJlZmVycmVkIGR1cmF0aW9uIG9mIHRoaXMgdGFyZ2V0IChvciBudWxsIGlmIG5vdCBkZWZpbmVkKS5cbiAgICovXG4gIHB1YmxpYyBnZXRQcmVmZXJyZWREdXJhdGlvbigpOiBudW1iZXIgfCBudWxsIHtcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLnN0YXJ0aW5nVmFsdWUgIT09IG51bGwgKTtcbiAgICBhc3NlcnQgJiYgYXNzZXJ0KCB0aGlzLmRlbHRhICE9PSBudWxsICk7XG5cbiAgICByZXR1cm4gdGhpcy5zcGVlZCA9PT0gbnVsbCA/IG51bGwgOiB0aGlzLnNwZWVkICogdGhpcy5kaXN0YW5jZSggdGhpcy5zdGFydGluZ1ZhbHVlISwgdGhpcy5kZWx0YSEgKTtcbiAgfVxufVxuXG50d2l4dC5yZWdpc3RlciggJ0FuaW1hdGlvblRhcmdldCcsIEFuaW1hdGlvblRhcmdldCApO1xuZXhwb3J0IGRlZmF1bHQgQW5pbWF0aW9uVGFyZ2V0OyJdLCJuYW1lcyI6WyJpc1RSZWFkT25seVByb3BlcnR5Iiwib3B0aW9uaXplIiwiRWFzaW5nIiwidHdpeHQiLCJBbmltYXRpb25UYXJnZXQiLCJERUZBVUxUX0JMRU5EIiwiYSIsImIiLCJyYXRpbyIsImFzc2VydCIsImlzRmluaXRlIiwiYmxlbmQiLCJFcnJvciIsIkpTT04iLCJzdHJpbmdpZnkiLCJERUZBVUxUX0RJU1RBTkNFIiwiTWF0aCIsImFicyIsImRpc3RhbmNlIiwiREVGQVVMVF9BREQiLCJwbHVzIiwiT0JKRUNUX1NFVCIsIm9iamVjdCIsImF0dHJpYnV0ZSIsInZhbHVlIiwiT0JKRUNUX0dFVCIsIlBST1BFUlRZX1NFVCIsInByb3BlcnR5IiwiUFJPUEVSVFlfR0VUIiwiY29tcHV0ZVN0YXJ0RW5kIiwidG8iLCJkZWx0YSIsImZyb20iLCJnZXRWYWx1ZSIsInN0YXJ0aW5nVmFsdWUiLCJlbmRpbmdWYWx1ZSIsImFkZCIsInVwZGF0ZSIsInNldFZhbHVlIiwiZWFzaW5nIiwiaGFzUHJlZmVycmVkRHVyYXRpb24iLCJzcGVlZCIsImdldFByZWZlcnJlZER1cmF0aW9uIiwicHJvdmlkZWRDb25maWciLCJjb25maWciLCJDVUJJQ19JTl9PVVQiLCJpc1NldHRhYmxlIiwicmVnaXN0ZXIiXSwibWFwcGluZ3MiOiJBQUFBLHNEQUFzRDtBQUV0RDs7OztDQUlDLEdBR0QsU0FBU0EsbUJBQW1CLFFBQVEscUNBQXFDO0FBSXpFLE9BQU9DLGVBQWUsa0NBQWtDO0FBR3hELE9BQU9DLFlBQVksY0FBYztBQUNqQyxPQUFPQyxXQUFXLGFBQWE7QUFxSC9CLElBQUEsQUFBTUMsa0JBQU4sTUFBTUE7SUE4R0osT0FBY0MsY0FBa0RDLENBQUksRUFBRUMsQ0FBSSxFQUFFQyxLQUFhLEVBQU07UUFDN0ZDLFVBQVVBLE9BQVFDLFNB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