// Copyright 2021-2024, University of Colorado Boulder
/**
 * Responsible for setting the provided focusProperty to null when the Focused node either
 * becomes invisible on the Display or is removed from the scene graph. It uses a
 * TrailVisibilityTracker to determine if any Node in the Trail has become invisible.
 *
 * Meant to be scenery-internal and used by FocusManager.
 *
 * @author Jesse Greenberg
 */ import { scenery, TrailVisibilityTracker } from '../imports.js';
let FocusDisplayedController = class FocusDisplayedController {
    /**
   * When Focus changes, remove any listeners that were attached from last Focus and
   * add new listeners if focus has a new value.
   */ handleFocusChange(focus) {
        this.removeDisplayedListeners();
        if (focus) {
            this.addDisplayedListeners(focus);
        }
    }
    /**
   * When the Trail becomes invisible, Focus should be set to null.
   */ handleTrailVisibilityChange() {
        if (this.visibilityTracker && !this.visibilityTracker.trailVisibleProperty.value) {
            this.focusProperty.value = null;
        }
    }
    /**
   * If there are no more Instances for the Node with focus it has been removed from
   * the scene graph and so Focus should be set to null.
   */ handleInstancesChange(instance) {
        if (instance.node && instance.node.instances.length === 0) {
            this.focusProperty.value = null;
        }
    }
    /**
   * While this focus-clear is mostly covered by listening for instance changes, there is an intermediate state between
   * when a Node is disposed, and when the Instance tree is updated to reflect that disposal (during updateDisplay()).
   * This function handles that atypical case (pretty much impossible to get to in PhET sims except during fuzzing).
   */ handleNodeDisposed() {
        this.focusProperty.value = null;
    }
    /**
   * Add listeners that watch when the Displayed state of the Node with Focus has changed,
   * including visibility of the trail and attachment to a scene graph.
   */ addDisplayedListeners(focus) {
        assert && assert(this.visibilityTracker === null, 'creating a new TrailVisibilityTracker but the last one was not disposed');
        assert && assert(this.node === null, 'Still a reference to the previously focused Node, possible memory leak');
        this.visibilityTracker = new TrailVisibilityTracker(focus.trail);
        this.visibilityTracker.addListener(this.boundVisibilityListener);
        this.node = focus.trail.lastNode();
        // This is potentially dangerous to listen to generally, but in this case it is safe because the state we change
        // will only affect a separate display's state, not this one.
        this.node.changedInstanceEmitter.addListener(this.boundInstancesChangedListener);
        this.node.disposeEmitter.addListener(this.boundNodeDisposedListener);
    }
    /**
   * Remove any listeners that were added to observables that fire when the Node's displayed
   * state may have changed.
   */ removeDisplayedListeners() {
        if (this.visibilityTracker) {
            this.visibilityTracker.removeListener(this.boundVisibilityListener);
            this.visibilityTracker.dispose();
            this.visibilityTracker = null;
        }
        if (this.node) {
            this.node.changedInstanceEmitter.removeListener(this.boundInstancesChangedListener);
            this.node.disposeEmitter.removeListener(this.boundNodeDisposedListener);
            this.node = null;
        }
    }
    dispose() {
        // this disposes the TrailVisibilityTracker and removes any listeners on the Node
        this.removeDisplayedListeners();
        this.focusProperty.unlink(this.boundFocusListener);
        this.node = null;
        this.visibilityTracker = null;
    }
    constructor(focusProperty){
        // last Node of the Trail that is focused, referenced so we can add and remove listeners from it
        this.node = null;
        // Observes the Trail to the Node and notifies when it has become invisible
        this.visibilityTracker = null;
        this.focusProperty = focusProperty;
        this.boundVisibilityListener = this.handleTrailVisibilityChange.bind(this);
        this.boundInstancesChangedListener = this.handleInstancesChange.bind(this);
        this.boundNodeDisposedListener = this.handleNodeDisposed.bind(this);
        this.boundFocusListener = this.handleFocusChange.bind(this);
        this.focusProperty.link(this.boundFocusListener);
    }
};
scenery.register('FocusDisplayedController', FocusDisplayedController);
export default FocusDisplayedController;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvYWNjZXNzaWJpbGl0eS9Gb2N1c0Rpc3BsYXllZENvbnRyb2xsZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjEtMjAyNCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXG5cbi8qKlxuICogUmVzcG9uc2libGUgZm9yIHNldHRpbmcgdGhlIHByb3ZpZGVkIGZvY3VzUHJvcGVydHkgdG8gbnVsbCB3aGVuIHRoZSBGb2N1c2VkIG5vZGUgZWl0aGVyXG4gKiBiZWNvbWVzIGludmlzaWJsZSBvbiB0aGUgRGlzcGxheSBvciBpcyByZW1vdmVkIGZyb20gdGhlIHNjZW5lIGdyYXBoLiBJdCB1c2VzIGFcbiAqIFRyYWlsVmlzaWJpbGl0eVRyYWNrZXIgdG8gZGV0ZXJtaW5lIGlmIGFueSBOb2RlIGluIHRoZSBUcmFpbCBoYXMgYmVjb21lIGludmlzaWJsZS5cbiAqXG4gKiBNZWFudCB0byBiZSBzY2VuZXJ5LWludGVybmFsIGFuZCB1c2VkIGJ5IEZvY3VzTWFuYWdlci5cbiAqXG4gKiBAYXV0aG9yIEplc3NlIEdyZWVuYmVyZ1xuICovXG5cbmltcG9ydCBUUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vYXhvbi9qcy9UUHJvcGVydHkuanMnO1xuaW1wb3J0IHsgRm9jdXMsIEluc3RhbmNlLCBOb2RlLCBzY2VuZXJ5LCBUcmFpbFZpc2liaWxpdHlUcmFja2VyIH0gZnJvbSAnLi4vaW1wb3J0cy5qcyc7XG5cbmNsYXNzIEZvY3VzRGlzcGxheWVkQ29udHJvbGxlciB7XG5cbiAgLy8gbGFzdCBOb2RlIG9mIHRoZSBUcmFpbCB0aGF0IGlzIGZvY3VzZWQsIHJlZmVyZW5jZWQgc28gd2UgY2FuIGFkZCBhbmQgcmVtb3ZlIGxpc3RlbmVycyBmcm9tIGl0XG4gIHByaXZhdGUgbm9kZTogTm9kZSB8IG51bGwgPSBudWxsO1xuXG4gIC8vIE9ic2VydmVzIHRoZSBUcmFpbCB0byB0aGUgTm9kZSBhbmQgbm90aWZpZXMgd2hlbiBpdCBoYXMgYmVjb21lIGludmlzaWJsZVxuICBwcml2YXRlIHZpc2liaWxpdHlUcmFja2VyOiBUcmFpbFZpc2liaWxpdHlUcmFja2VyIHwgbnVsbCA9IG51bGw7XG5cbiAgLy8gV2hlbiB0aGVyZSBpcyB2YWx1ZSwgd2Ugd2lsbCB3YXRjaCBhbmQgdXBkYXRlIHdoZW4gdGhlcmUgYXJlIGNoYW5nZXMgdG8gdGhlIGRpc3BsYXllZCBzdGF0ZSBvZiB0aGUgRm9jdXMgdHJhaWwuXG4gIHByaXZhdGUgZm9jdXNQcm9wZXJ0eTogVFByb3BlcnR5PEZvY3VzIHwgbnVsbD47XG5cbiAgLy8gQm91bmQgZnVuY3Rpb25zIHRoYXQgYXJlIGNhbGxlZCB3aGVuIHRoZSBkaXNwbGF5ZWQgc3RhdGUgb2YgdGhlIE5vZGUgY2hhbmdlcy5cbiAgcHJpdmF0ZSByZWFkb25seSBib3VuZFZpc2liaWxpdHlMaXN0ZW5lcjogKCkgPT4gdm9pZDtcbiAgcHJpdmF0ZSByZWFkb25seSBib3VuZEluc3RhbmNlc0NoYW5nZWRMaXN0ZW5lcjogKCBpbnN0YW5jZTogSW5zdGFuY2UgKSA9PiB2b2lkO1xuICBwcml2YXRlIHJlYWRvbmx5IGJvdW5kTm9kZURpc3Bvc2VkTGlzdGVuZXI6ICgpID0+IHZvaWQ7XG5cbiAgLy8gSGFuZGxlcyBjaGFuZ2VzIHRvIGZvY3VzLCBhZGRpbmcgb3IgcmVtb3ZpbmcgbGlzdGVuZXJzXG4gIHByaXZhdGUgcmVhZG9ubHkgYm91bmRGb2N1c0xpc3RlbmVyOiAoIGZvY3VzOiBGb2N1cyB8IG51bGwgKSA9PiB2b2lkO1xuXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggZm9jdXNQcm9wZXJ0eTogVFByb3BlcnR5PEZvY3VzIHwgbnVsbD4gKSB7XG4gICAgdGhpcy5mb2N1c1Byb3BlcnR5ID0gZm9jdXNQcm9wZXJ0eTtcblxuICAgIHRoaXMuYm91bmRWaXNpYmlsaXR5TGlzdGVuZXIgPSB0aGlzLmhhbmRsZVRyYWlsVmlzaWJpbGl0eUNoYW5nZS5iaW5kKCB0aGlzICk7XG4gICAgdGhpcy5ib3VuZEluc3RhbmNlc0NoYW5nZWRMaXN0ZW5lciA9IHRoaXMuaGFuZGxlSW5zdGFuY2VzQ2hhbmdlLmJpbmQoIHRoaXMgKTtcbiAgICB0aGlzLmJvdW5kTm9kZURpc3Bvc2VkTGlzdGVuZXIgPSB0aGlzLmhhbmRsZU5vZGVEaXNwb3NlZC5iaW5kKCB0aGlzICk7XG5cbiAgICB0aGlzLmJvdW5kRm9jdXNMaXN0ZW5lciA9IHRoaXMuaGFuZGxlRm9jdXNDaGFuZ2UuYmluZCggdGhpcyApO1xuICAgIHRoaXMuZm9jdXNQcm9wZXJ0eS5saW5rKCB0aGlzLmJvdW5kRm9jdXNMaXN0ZW5lciApO1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZW4gRm9jdXMgY2hhbmdlcywgcmVtb3ZlIGFueSBsaXN0ZW5lcnMgdGhhdCB3ZXJlIGF0dGFjaGVkIGZyb20gbGFzdCBGb2N1cyBhbmRcbiAgICogYWRkIG5ldyBsaXN0ZW5lcnMgaWYgZm9jdXMgaGFzIGEgbmV3IHZhbHVlLlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVGb2N1c0NoYW5nZSggZm9jdXM6IEZvY3VzIHwgbnVsbCApOiB2b2lkIHtcbiAgICB0aGlzLnJlbW92ZURpc3BsYXllZExpc3RlbmVycygpO1xuXG4gICAgaWYgKCBmb2N1cyApIHtcbiAgICAgIHRoaXMuYWRkRGlzcGxheWVkTGlzdGVuZXJzKCBmb2N1cyApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBXaGVuIHRoZSBUcmFpbCBiZWNvbWVzIGludmlzaWJsZSwgRm9jdXMgc2hvdWxkIGJlIHNldCB0byBudWxsLlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVUcmFpbFZpc2liaWxpdHlDaGFuZ2UoKTogdm9pZCB7XG4gICAgaWYgKCB0aGlzLnZpc2liaWxpdHlUcmFja2VyICYmICF0aGlzLnZpc2liaWxpdHlUcmFja2VyLnRyYWlsVmlzaWJsZVByb3BlcnR5LnZhbHVlICkge1xuICAgICAgdGhpcy5mb2N1c1Byb3BlcnR5LnZhbHVlID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSWYgdGhlcmUgYXJlIG5vIG1vcmUgSW5zdGFuY2VzIGZvciB0aGUgTm9kZSB3aXRoIGZvY3VzIGl0IGhhcyBiZWVuIHJlbW92ZWQgZnJvbVxuICAgKiB0aGUgc2NlbmUgZ3JhcGggYW5kIHNvIEZvY3VzIHNob3VsZCBiZSBzZXQgdG8gbnVsbC5cbiAgICovXG4gIHByaXZhdGUgaGFuZGxlSW5zdGFuY2VzQ2hhbmdlKCBpbnN0YW5jZTogSW5zdGFuY2UgKTogdm9pZCB7XG4gICAgaWYgKCBpbnN0YW5jZS5ub2RlICYmIGluc3RhbmNlLm5vZGUuaW5zdGFuY2VzLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgIHRoaXMuZm9jdXNQcm9wZXJ0eS52YWx1ZSA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFdoaWxlIHRoaXMgZm9jdXMtY2xlYXIgaXMgbW9zdGx5IGNvdmVyZWQgYnkgbGlzdGVuaW5nIGZvciBpbnN0YW5jZSBjaGFuZ2VzLCB0aGVyZSBpcyBhbiBpbnRlcm1lZGlhdGUgc3RhdGUgYmV0d2VlblxuICAgKiB3aGVuIGEgTm9kZSBpcyBkaXNwb3NlZCwgYW5kIHdoZW4gdGhlIEluc3RhbmNlIHRyZWUgaXMgdXBkYXRlZCB0byByZWZsZWN0IHRoYXQgZGlzcG9zYWwgKGR1cmluZyB1cGRhdGVEaXNwbGF5KCkpLlxuICAgKiBUaGlzIGZ1bmN0aW9uIGhhbmRsZXMgdGhhdCBhdHlwaWNhbCBjYXNlIChwcmV0dHkgbXVjaCBpbXBvc3NpYmxlIHRvIGdldCB0byBpbiBQaEVUIHNpbXMgZXhjZXB0IGR1cmluZyBmdXp6aW5nKS5cbiAgICovXG4gIHByaXZhdGUgaGFuZGxlTm9kZURpc3Bvc2VkKCk6IHZvaWQge1xuICAgIHRoaXMuZm9jdXNQcm9wZXJ0eS52YWx1ZSA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGxpc3RlbmVycyB0aGF0IHdhdGNoIHdoZW4gdGhlIERpc3BsYXllZCBzdGF0ZSBvZiB0aGUgTm9kZSB3aXRoIEZvY3VzIGhhcyBjaGFuZ2VkLFxuICAgKiBpbmNsdWRpbmcgdmlzaWJpbGl0eSBvZiB0aGUgdHJhaWwgYW5kIGF0dGFjaG1lbnQgdG8gYSBzY2VuZSBncmFwaC5cbiAgICovXG4gIHByaXZhdGUgYWRkRGlzcGxheWVkTGlzdGVuZXJzKCBmb2N1czogRm9jdXMgKTogdm9pZCB7XG4gICAgYXNzZXJ0ICYmIGFzc2VydCggdGhpcy52aXNpYmlsaXR5VHJhY2tlciA9PT0gbnVsbCwgJ2NyZWF0aW5nIGEgbmV3IFRyYWlsVmlzaWJpbGl0eVRyYWNrZXIgYnV0IHRoZSBsYXN0IG9uZSB3YXMgbm90IGRpc3Bvc2VkJyApO1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIHRoaXMubm9kZSA9PT0gbnVsbCwgJ1N0aWxsIGEgcmVmZXJlbmNlIHRvIHRoZSBwcmV2aW91c2x5IGZvY3VzZWQgTm9kZSwgcG9zc2libGUgbWVtb3J5IGxlYWsnICk7XG5cbiAgICB0aGlzLnZpc2liaWxpdHlUcmFja2VyID0gbmV3IFRyYWlsVmlzaWJpbGl0eVRyYWNrZXIoIGZvY3VzLnRyYWlsICk7XG4gICAgdGhpcy52aXNpYmlsaXR5VHJhY2tlci5hZGRMaXN0ZW5lciggdGhpcy5ib3VuZFZpc2liaWxpdHlMaXN0ZW5lciApO1xuXG4gICAgdGhpcy5ub2RlID0gZm9jdXMudHJhaWwubGFzdE5vZGUoKTtcblxuICAgIC8vIFRoaXMgaXMgcG90ZW50aWFsbHkgZGFuZ2Vyb3VzIHRvIGxpc3RlbiB0byBnZW5lcmFsbHksIGJ1dCBpbiB0aGlzIGNhc2UgaXQgaXMgc2FmZSBiZWNhdXNlIHRoZSBzdGF0ZSB3ZSBjaGFuZ2VcbiAgICAvLyB3aWxsIG9ubHkgYWZmZWN0IGEgc2VwYXJhdGUgZGlzcGxheSdzIHN0YXRlLCBub3QgdGhpcyBvbmUuXG4gICAgdGhpcy5ub2RlLmNoYW5nZWRJbnN0YW5jZUVtaXR0ZXIuYWRkTGlzdGVuZXIoIHRoaXMuYm91bmRJbnN0YW5jZXNDaGFuZ2VkTGlzdGVuZXIgKTtcbiAgICB0aGlzLm5vZGUuZGlzcG9zZUVtaXR0ZXIuYWRkTGlzdGVuZXIoIHRoaXMuYm91bmROb2RlRGlzcG9zZWRMaXN0ZW5lciApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhbnkgbGlzdGVuZXJzIHRoYXQgd2VyZSBhZGRlZCB0byBvYnNlcnZhYmxlcyB0aGF0IGZpcmUgd2hlbiB0aGUgTm9kZSdzIGRpc3BsYXllZFxuICAgKiBzdGF0ZSBtYXkgaGF2ZSBjaGFuZ2VkLlxuICAgKi9cbiAgcHJpdmF0ZSByZW1vdmVEaXNwbGF5ZWRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgaWYgKCB0aGlzLnZpc2liaWxpdHlUcmFja2VyICkge1xuICAgICAgdGhpcy52aXNpYmlsaXR5VHJhY2tlci5yZW1vdmVMaXN0ZW5lciggdGhpcy5ib3VuZFZpc2liaWxpdHlMaXN0ZW5lciApO1xuICAgICAgdGhpcy52aXNpYmlsaXR5VHJhY2tlci5kaXNwb3NlKCk7XG4gICAgICB0aGlzLnZpc2liaWxpdHlUcmFja2VyID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKCB0aGlzLm5vZGUgKSB7XG4gICAgICB0aGlzLm5vZGUuY2hhbmdlZEluc3RhbmNlRW1pdHRlci5yZW1vdmVMaXN0ZW5lciggdGhpcy5ib3VuZEluc3RhbmNlc0NoYW5nZWRMaXN0ZW5lciApO1xuICAgICAgdGhpcy5ub2RlLmRpc3Bvc2VFbWl0dGVyLnJlbW92ZUxpc3RlbmVyKCB0aGlzLmJvdW5kTm9kZURpc3Bvc2VkTGlzdGVuZXIgKTtcbiAgICAgIHRoaXMubm9kZSA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGRpc3Bvc2UoKTogdm9pZCB7XG5cbiAgICAvLyB0aGlzIGRpc3Bvc2VzIHRoZSBUcmFpbFZpc2liaWxpdHlUcmFja2VyIGFuZCByZW1vdmVzIGFueSBsaXN0ZW5lcnMgb24gdGhlIE5vZGVcbiAgICB0aGlzLnJlbW92ZURpc3BsYXllZExpc3RlbmVycygpO1xuICAgIHRoaXMuZm9jdXNQcm9wZXJ0eS51bmxpbmsoIHRoaXMuYm91bmRGb2N1c0xpc3RlbmVyICk7XG5cbiAgICB0aGlzLm5vZGUgPSBudWxsO1xuICAgIHRoaXMudmlzaWJpbGl0eVRyYWNrZXIgPSBudWxsO1xuICB9XG59XG5cbnNjZW5lcnkucmVnaXN0ZXIoICdGb2N1c0Rpc3BsYXllZENvbnRyb2xsZXInLCBGb2N1c0Rpc3BsYXllZENvbnRyb2xsZXIgKTtcbmV4cG9ydCBkZWZhdWx0IEZvY3VzRGlzcGxheWVkQ29udHJvbGxlcjsiXSwibmFtZXMiOlsic2NlbmVyeSIsIlRyYWlsVmlzaWJpbGl0eVRyYWNrZXIiLCJGb2N1c0Rpc3BsYXllZENvbnRyb2xsZXIiLCJoYW5kbGVGb2N1c0NoYW5nZSIsImZvY3VzIiwicmVtb3ZlRGlzcGxheWVkTGlzdGVuZXJzIiwiYWRkRGlzcGxheWVkTGlzdGVuZXJzIiwiaGFuZGxlVHJhaWxWaXNpYmlsaXR5Q2hhbmdlIiwidmlzaWJpbGl0eVRyYWNrZXIiLCJ0cmFpbFZpc2libGVQcm9wZXJ0eSIsInZhbHVlIiwiZm9jdXNQcm9wZXJ0eSIsImhhbmRsZUluc3RhbmNlc0NoYW5nZSIsImluc3RhbmNlIiwibm9kZSIsImluc3RhbmNlcyIsImxlbmd0aCIsImhhbmRsZU5vZGVEaXNwb3NlZCIsImFzc2VydCIsInRyYWlsIiwiYWRkTGlzdGVuZXIiLCJib3VuZFZpc2liaWxpdHlMaXN0ZW5lciIsImxhc3ROb2RlIiwiY2hhbmdlZEluc3RhbmNlRW1pdHRlciIsImJvdW5kSW5zdGFuY2VzQ2hhbmdlZExpc3RlbmVyIiwiZGlzcG9zZUVtaXR0ZXIiLCJib3VuZE5vZGVEaXNwb3NlZExpc3RlbmVyIiwicmVtb3ZlTGlzdGVuZXIiLCJkaXNwb3NlIiwidW5saW5rIiwiYm91bmRGb2N1c0xpc3RlbmVyIiwiYmluZCIsImxpbmsiLCJyZWdpc3RlciJdLCJtYXBwaW5ncyI6IkFBQUEsc0RBQXNEO0FBRXREOzs7Ozs7OztDQVFDLEdBR0QsU0FBZ0NBLE9BQU8sRUFBRUMsc0JBQXNCLFFBQVEsZ0JBQWdCO0FBRXZGLElBQUEsQUFBTUMsMkJBQU4sTUFBTUE7SUE4Qko7OztHQUdDLEdBQ0QsQUFBUUMsa0JBQW1CQyxLQUFtQixF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