// Copyright 2016-2023, University of Colorado Boulder
/**
 * WebGL drawable for Image nodes.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */ import Vector2 from '../../../../dot/js/Vector2.js';
import Poolable from '../../../../phet-core/js/Poolable.js';
import { ImageStatefulDrawable, Renderer, scenery, WebGLSelfDrawable } from '../../imports.js';
// For alignment, we keep things to 8 components, aligned on 4-byte boundaries.
// See https://developer.apple.com/library/ios/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/TechniquesforWorkingwithVertexData/TechniquesforWorkingwithVertexData.html#//apple_ref/doc/uid/TP40008793-CH107-SW15
const WEBGL_COMPONENTS = 5; // format [X Y U V A] for 6 vertices
const VERTEX_0_OFFSET = WEBGL_COMPONENTS * 0;
const VERTEX_1_OFFSET = WEBGL_COMPONENTS * 1;
const VERTEX_2_OFFSET = WEBGL_COMPONENTS * 2;
const VERTEX_3_OFFSET = WEBGL_COMPONENTS * 3;
const VERTEX_4_OFFSET = WEBGL_COMPONENTS * 4;
const VERTEX_5_OFFSET = WEBGL_COMPONENTS * 5;
const VERTEX_X_OFFSET = 0;
const VERTEX_Y_OFFSET = 1;
const VERTEX_U_OFFSET = 2;
const VERTEX_V_OFFSET = 3;
const VERTEX_A_OFFSET = 4;
let ImageWebGLDrawable = class ImageWebGLDrawable extends ImageStatefulDrawable(WebGLSelfDrawable) {
    /**
   * @public
   * @override
   *
   * @param {number} renderer
   * @param {Instance} instance
   */ initialize(renderer, instance) {
        super.initialize(renderer, instance);
        // @public {Float32Array} - 5-length components for 6 vertices (2 tris), for 6 vertices
        this.vertexArray = this.vertexArray || new Float32Array(WEBGL_COMPONENTS * 6);
        // @private {Vector2} - corner vertices in the relative transform root coordinate space
        this.upperLeft = new Vector2(0, 0);
        this.lowerLeft = new Vector2(0, 0);
        this.upperRight = new Vector2(0, 0);
        this.lowerRight = new Vector2(0, 0);
        // @private {boolean}
        this.xyDirty = true; // is our vertex position information out of date?
        this.uvDirty = true; // is our UV information out of date?
        this.updatedOnce = false;
        // {SpriteSheet.Sprite} exported for WebGLBlock's rendering loop
        this.sprite = null;
    }
    /**
   * @public
   *
   * @param {WebGLBlock} webGLBlock
   */ onAddToBlock(webglBlock) {
        this.webglBlock = webglBlock; // TODO: do we need this reference? https://github.com/phetsims/scenery/issues/1581
        this.markDirty();
        this.reserveSprite();
    }
    /**
   * @public
   *
   * @param {WebGLBlock} webGLBlock
   */ onRemoveFromBlock(webglBlock) {
        this.unreserveSprite();
    }
    /**
   * @private
   */ reserveSprite() {
        if (this.sprite) {
            // if we already reserved a sprite for the image, bail out
            if (this.sprite.image === this.node._image) {
                return;
            } else {
                this.unreserveSprite();
            }
        }
        // if the width/height isn't loaded yet, we can still use the desired value
        const width = this.node.getImageWidth();
        const height = this.node.getImageHeight();
        // if we have a width/height, we'll load a sprite
        this.sprite = width > 0 && height > 0 ? this.webglBlock.addSpriteSheetImage(this.node._image, width, height) : null;
        // full updates on everything if our sprite changes
        this.xyDirty = true;
        this.uvDirty = true;
    }
    /**
   * @private
   */ unreserveSprite() {
        if (this.sprite) {
            this.webglBlock.removeSpriteSheetImage(this.sprite);
        }
        this.sprite = null;
    }
    /**
   * @public
   * @override
   */ markTransformDirty() {
        this.xyDirty = true;
        super.markTransformDirty();
    }
    /**
   * A "catch-all" dirty method that directly marks the paintDirty flag and triggers propagation of dirty
   * information. This can be used by other mark* methods, or directly itself if the paintDirty flag is checked.
   * @public
   *
   * It should be fired (indirectly or directly) for anything besides transforms that needs to make a drawable
   * dirty.
   */ markPaintDirty() {
        this.xyDirty = true; // vertex positions can depend on image width/height
        this.uvDirty = true;
        this.markDirty();
    }
    /**
   * Updates the DOM appearance of this drawable (whether by preparing/calling draw calls, DOM element updates, etc.)
   * @public
   * @override
   *
   * @returns {boolean} - Whether the update should continue (if false, further updates in supertype steps should not
   *                      be done).
   */ update() {
        // See if we need to actually update things (will bail out if we are not dirty, or if we've been disposed)
        if (!super.update()) {
            return false;
        }
        // ensure that we have a reserved sprite (part of the spritesheet)
        this.reserveSprite();
        if (this.dirtyImageOpacity || !this.updatedOnce) {
            this.vertexArray[VERTEX_0_OFFSET + VERTEX_A_OFFSET] = this.node._imageOpacity;
            this.vertexArray[VERTEX_1_OFFSET + VERTEX_A_OFFSET] = this.node._imageOpacity;
            this.vertexArray[VERTEX_2_OFFSET + VERTEX_A_OFFSET] = this.node._imageOpacity;
            this.vertexArray[VERTEX_3_OFFSET + VERTEX_A_OFFSET] = this.node._imageOpacity;
            this.vertexArray[VERTEX_4_OFFSET + VERTEX_A_OFFSET] = this.node._imageOpacity;
            this.vertexArray[VERTEX_5_OFFSET + VERTEX_A_OFFSET] = this.node._imageOpacity;
        }
        this.updatedOnce = true;
        // if we don't have a sprite (we don't have a loaded image yet), just bail
        if (!this.sprite) {
            return false;
        }
        if (this.uvDirty) {
            this.uvDirty = false;
            const uvBounds = this.sprite.uvBounds;
            // TODO: consider reversal of minY and maxY usage here for vertical inverse https://github.com/phetsims/scenery/issues/1581
            // first triangle UVs
            this.vertexArray[VERTEX_0_OFFSET + VERTEX_U_OFFSET] = uvBounds.minX; // upper left U
            this.vertexArray[VERTEX_0_OFFSET + VERTEX_V_OFFSET] = uvBounds.minY; // upper left V
            this.vertexArray[VERTEX_1_OFFSET + VERTEX_U_OFFSET] = uvBounds.minX; // lower left U
            this.vertexArray[VERTEX_1_OFFSET + VERTEX_V_OFFSET] = uvBounds.maxY; // lower left V
            this.vertexArray[VERTEX_2_OFFSET + VERTEX_U_OFFSET] = uvBounds.maxX; // upper right U
            this.vertexArray[VERTEX_2_OFFSET + VERTEX_V_OFFSET] = uvBounds.minY; // upper right V
            // second triangle UVs
            this.vertexArray[VERTEX_3_OFFSET + VERTEX_U_OFFSET] = uvBounds.maxX; // upper right U
            this.vertexArray[VERTEX_3_OFFSET + VERTEX_V_OFFSET] = uvBounds.minY; // upper right V
            this.vertexArray[VERTEX_4_OFFSET + VERTEX_U_OFFSET] = uvBounds.minX; // lower left U
            this.vertexArray[VERTEX_4_OFFSET + VERTEX_V_OFFSET] = uvBounds.maxY; // lower left V
            this.vertexArray[VERTEX_5_OFFSET + VERTEX_U_OFFSET] = uvBounds.maxX; // lower right U
            this.vertexArray[VERTEX_5_OFFSET + VERTEX_V_OFFSET] = uvBounds.maxY; // lower right V
        }
        if (this.xyDirty) {
            this.xyDirty = false;
            const width = this.node.getImageWidth();
            const height = this.node.getImageHeight();
            const transformMatrix = this.instance.relativeTransform.matrix; // with compute need, should always be accurate
            transformMatrix.multiplyVector2(this.upperLeft.setXY(0, 0));
            transformMatrix.multiplyVector2(this.lowerLeft.setXY(0, height));
            transformMatrix.multiplyVector2(this.upperRight.setXY(width, 0));
            transformMatrix.multiplyVector2(this.lowerRight.setXY(width, height));
            // first triangle XYs
            this.vertexArray[VERTEX_0_OFFSET + VERTEX_X_OFFSET] = this.upperLeft.x;
            this.vertexArray[VERTEX_0_OFFSET + VERTEX_Y_OFFSET] = this.upperLeft.y;
            this.vertexArray[VERTEX_1_OFFSET + VERTEX_X_OFFSET] = this.lowerLeft.x;
            this.vertexArray[VERTEX_1_OFFSET + VERTEX_Y_OFFSET] = this.lowerLeft.y;
            this.vertexArray[VERTEX_2_OFFSET + VERTEX_X_OFFSET] = this.upperRight.x;
            this.vertexArray[VERTEX_2_OFFSET + VERTEX_Y_OFFSET] = this.upperRight.y;
            // second triangle XYs
            this.vertexArray[VERTEX_3_OFFSET + VERTEX_X_OFFSET] = this.upperRight.x;
            this.vertexArray[VERTEX_3_OFFSET + VERTEX_Y_OFFSET] = this.upperRight.y;
            this.vertexArray[VERTEX_4_OFFSET + VERTEX_X_OFFSET] = this.lowerLeft.x;
            this.vertexArray[VERTEX_4_OFFSET + VERTEX_Y_OFFSET] = this.lowerLeft.y;
            this.vertexArray[VERTEX_5_OFFSET + VERTEX_X_OFFSET] = this.lowerRight.x;
            this.vertexArray[VERTEX_5_OFFSET + VERTEX_Y_OFFSET] = this.lowerRight.y;
        }
        return true;
    }
};
// TODO: doc https://github.com/phetsims/scenery/issues/1581
ImageWebGLDrawable.prototype.webglRenderer = Renderer.webglTexturedTriangles;
scenery.register('ImageWebGLDrawable', ImageWebGLDrawable);
Poolable.mixInto(ImageWebGLDrawable);
export default ImageWebGLDrawable;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NjZW5lcnkvanMvZGlzcGxheS9kcmF3YWJsZXMvSW1hZ2VXZWJHTERyYXdhYmxlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE2LTIwMjMsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxuXG4vKipcbiAqIFdlYkdMIGRyYXdhYmxlIGZvciBJbWFnZSBub2Rlcy5cbiAqXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XG4gKi9cblxuaW1wb3J0IFZlY3RvcjIgZnJvbSAnLi4vLi4vLi4vLi4vZG90L2pzL1ZlY3RvcjIuanMnO1xuaW1wb3J0IFBvb2xhYmxlIGZyb20gJy4uLy4uLy4uLy4uL3BoZXQtY29yZS9qcy9Qb29sYWJsZS5qcyc7XG5pbXBvcnQgeyBJbWFnZVN0YXRlZnVsRHJhd2FibGUsIFJlbmRlcmVyLCBzY2VuZXJ5LCBXZWJHTFNlbGZEcmF3YWJsZSB9IGZyb20gJy4uLy4uL2ltcG9ydHMuanMnO1xuXG4vLyBGb3IgYWxpZ25tZW50LCB3ZSBrZWVwIHRoaW5ncyB0byA4IGNvbXBvbmVudHMsIGFsaWduZWQgb24gNC1ieXRlIGJvdW5kYXJpZXMuXG4vLyBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2xpYnJhcnkvaW9zL2RvY3VtZW50YXRpb24vM0REcmF3aW5nL0NvbmNlcHR1YWwvT3BlbkdMRVNfUHJvZ3JhbW1pbmdHdWlkZS9UZWNobmlxdWVzZm9yV29ya2luZ3dpdGhWZXJ0ZXhEYXRhL1RlY2huaXF1ZXNmb3JXb3JraW5nd2l0aFZlcnRleERhdGEuaHRtbCMvL2FwcGxlX3JlZi9kb2MvdWlkL1RQNDAwMDg3OTMtQ0gxMDctU1cxNVxuY29uc3QgV0VCR0xfQ09NUE9ORU5UUyA9IDU7IC8vIGZvcm1hdCBbWCBZIFUgViBBXSBmb3IgNiB2ZXJ0aWNlc1xuXG5jb25zdCBWRVJURVhfMF9PRkZTRVQgPSBXRUJHTF9DT01QT05FTlRTICogMDtcbmNvbnN0IFZFUlRFWF8xX09GRlNFVCA9IFdFQkdMX0NPTVBPTkVOVFMgKiAxO1xuY29uc3QgVkVSVEVYXzJfT0ZGU0VUID0gV0VCR0xfQ09NUE9ORU5UUyAqIDI7XG5jb25zdCBWRVJURVhfM19PRkZTRVQgPSBXRUJHTF9DT01QT05FTlRTICogMztcbmNvbnN0IFZFUlRFWF80X09GRlNFVCA9IFdFQkdMX0NPTVBPTkVOVFMgKiA0O1xuY29uc3QgVkVSVEVYXzVfT0ZGU0VUID0gV0VCR0xfQ09NUE9ORU5UUyAqIDU7XG5cbmNvbnN0IFZFUlRFWF9YX09GRlNFVCA9IDA7XG5jb25zdCBWRVJURVhfWV9PRkZTRVQgPSAxO1xuY29uc3QgVkVSVEVYX1VfT0ZGU0VUID0gMjtcbmNvbnN0IFZFUlRFWF9WX09GRlNFVCA9IDM7XG5jb25zdCBWRVJURVhfQV9PRkZTRVQgPSA0O1xuXG5jbGFzcyBJbWFnZVdlYkdMRHJhd2FibGUgZXh0ZW5kcyBJbWFnZVN0YXRlZnVsRHJhd2FibGUoIFdlYkdMU2VsZkRyYXdhYmxlICkge1xuICAvKipcbiAgICogQHB1YmxpY1xuICAgKiBAb3ZlcnJpZGVcbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJlbmRlcmVyXG4gICAqIEBwYXJhbSB7SW5zdGFuY2V9IGluc3RhbmNlXG4gICAqL1xuICBpbml0aWFsaXplKCByZW5kZXJlciwgaW5zdGFuY2UgKSB7XG4gICAgc3VwZXIuaW5pdGlhbGl6ZSggcmVuZGVyZXIsIGluc3RhbmNlICk7XG5cbiAgICAvLyBAcHVibGljIHtGbG9hdDMyQXJyYXl9IC0gNS1sZW5ndGggY29tcG9uZW50cyBmb3IgNiB2ZXJ0aWNlcyAoMiB0cmlzKSwgZm9yIDYgdmVydGljZXNcbiAgICB0aGlzLnZlcnRleEFycmF5ID0gdGhpcy52ZXJ0ZXhBcnJheSB8fCBuZXcgRmxvYXQzMkFycmF5KCBXRUJHTF9DT01QT05FTlRTICogNiApO1xuXG4gICAgLy8gQHByaXZhdGUge1ZlY3RvcjJ9IC0gY29ybmVyIHZlcnRpY2VzIGluIHRoZSByZWxhdGl2ZSB0cmFuc2Zvcm0gcm9vdCBjb29yZGluYXRlIHNwYWNlXG4gICAgdGhpcy51cHBlckxlZnQgPSBuZXcgVmVjdG9yMiggMCwgMCApO1xuICAgIHRoaXMubG93ZXJMZWZ0ID0gbmV3IFZlY3RvcjIoIDAsIDAgKTtcbiAgICB0aGlzLnVwcGVyUmlnaHQgPSBuZXcgVmVjdG9yMiggMCwgMCApO1xuICAgIHRoaXMubG93ZXJSaWdodCA9IG5ldyBWZWN0b3IyKCAwLCAwICk7XG5cbiAgICAvLyBAcHJpdmF0ZSB7Ym9vbGVhbn1cbiAgICB0aGlzLnh5RGlydHkgPSB0cnVlOyAvLyBpcyBvdXIgdmVydGV4IHBvc2l0aW9uIGluZm9ybWF0aW9uIG91dCBvZiBkYXRlP1xuICAgIHRoaXMudXZEaXJ0eSA9IHRydWU7IC8vIGlzIG91ciBVViBpbmZvcm1hdGlvbiBvdXQgb2YgZGF0ZT9cbiAgICB0aGlzLnVwZGF0ZWRPbmNlID0gZmFsc2U7XG5cbiAgICAvLyB7U3ByaXRlU2hlZXQuU3ByaXRlfSBleHBvcnRlZCBmb3IgV2ViR0xCbG9jaydzIHJlbmRlcmluZyBsb29wXG4gICAgdGhpcy5zcHJpdGUgPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwdWJsaWNcbiAgICpcbiAgICogQHBhcmFtIHtXZWJHTEJsb2NrfSB3ZWJHTEJsb2NrXG4gICAqL1xuICBvbkFkZFRvQmxvY2soIHdlYmdsQmxvY2sgKSB7XG4gICAgdGhpcy53ZWJnbEJsb2NrID0gd2ViZ2xCbG9jazsgLy8gVE9ETzogZG8gd2UgbmVlZCB0aGlzIHJlZmVyZW5jZT8gaHR0cHM6Ly9naXRodWIuY29tL3BoZXRzaW1zL3NjZW5lcnkvaXNzdWVzLzE1ODFcbiAgICB0aGlzLm1hcmtEaXJ0eSgpO1xuXG4gICAgdGhpcy5yZXNlcnZlU3ByaXRlKCk7XG4gIH1cblxuICAvKipcbiAgICogQHB1YmxpY1xuICAgKlxuICAgKiBAcGFyYW0ge1dlYkdMQmxvY2t9IHdlYkdMQmxvY2tcbiAgICovXG4gIG9uUmVtb3ZlRnJvbUJsb2NrKCB3ZWJnbEJsb2NrICkge1xuICAgIHRoaXMudW5yZXNlcnZlU3ByaXRlKCk7XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHJlc2VydmVTcHJpdGUoKSB7XG4gICAgaWYgKCB0aGlzLnNwcml0ZSApIHtcbiAgICAgIC8vIGlmIHdlIGFscmVhZHkgcmVzZXJ2ZWQgYSBzcHJpdGUgZm9yIHRoZSBpbWFnZSwgYmFpbCBvdXRcbiAgICAgIGlmICggdGhpcy5zcHJpdGUuaW1hZ2UgPT09IHRoaXMubm9kZS5faW1hZ2UgKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIC8vIG90aGVyd2lzZSB3ZSBuZWVkIHRvIGRpdGNoIG91ciBsYXN0IHJlc2VydmF0aW9uIGJlZm9yZSByZXNlcnZpbmcgYSBuZXcgc3ByaXRlXG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy51bnJlc2VydmVTcHJpdGUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBpZiB0aGUgd2lkdGgvaGVpZ2h0IGlzbid0IGxvYWRlZCB5ZXQsIHdlIGNhbiBzdGlsbCB1c2UgdGhlIGRlc2lyZWQgdmFsdWVcbiAgICBjb25zdCB3aWR0aCA9IHRoaXMubm9kZS5nZXRJbWFnZVdpZHRoKCk7XG4gICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5ub2RlLmdldEltYWdlSGVpZ2h0KCk7XG5cbiAgICAvLyBpZiB3ZSBoYXZlIGEgd2lkdGgvaGVpZ2h0LCB3ZSdsbCBsb2FkIGEgc3ByaXRlXG4gICAgdGhpcy5zcHJpdGUgPSAoIHdpZHRoID4gMCAmJiBoZWlnaHQgPiAwICkgPyB0aGlzLndlYmdsQmxvY2suYWRkU3ByaXRlU2hlZXRJbWFnZSggdGhpcy5ub2RlLl9pbWFnZSwgd2lkdGgsIGhlaWdodCApIDogbnVsbDtcblxuICAgIC8vIGZ1bGwgdXBkYXRlcyBvbiBldmVyeXRoaW5nIGlmIG91ciBzcHJpdGUgY2hhbmdlc1xuICAgIHRoaXMueHlEaXJ0eSA9IHRydWU7XG4gICAgdGhpcy51dkRpcnR5ID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdW5yZXNlcnZlU3ByaXRlKCkge1xuICAgIGlmICggdGhpcy5zcHJpdGUgKSB7XG4gICAgICB0aGlzLndlYmdsQmxvY2sucmVtb3ZlU3ByaXRlU2hlZXRJbWFnZSggdGhpcy5zcHJpdGUgKTtcbiAgICB9XG4gICAgdGhpcy5zcHJpdGUgPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwdWJsaWNcbiAgICogQG92ZXJyaWRlXG4gICAqL1xuICBtYXJrVHJhbnNmb3JtRGlydHkoKSB7XG4gICAgdGhpcy54eURpcnR5ID0gdHJ1ZTtcblxuICAgIHN1cGVyLm1hcmtUcmFuc2Zvcm1EaXJ0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgXCJjYXRjaC1hbGxcIiBkaXJ0eSBtZXRob2QgdGhhdCBkaXJlY3RseSBtYXJrcyB0aGUgcGFpbnREaXJ0eSBmbGFnIGFuZCB0cmlnZ2VycyBwcm9wYWdhdGlvbiBvZiBkaXJ0eVxuICAgKiBpbmZvcm1hdGlvbi4gVGhpcyBjYW4gYmUgdXNlZCBieSBvdGhlciBtYXJrKiBtZXRob2RzLCBvciBkaXJlY3RseSBpdHNlbGYgaWYgdGhlIHBhaW50RGlydHkgZmxhZyBpcyBjaGVja2VkLlxuICAgKiBAcHVibGljXG4gICAqXG4gICAqIEl0IHNob3VsZCBiZSBmaXJlZCAoaW5kaXJlY3RseSBvciBkaXJlY3RseSkgZm9yIGFueXRoaW5nIGJlc2lkZXMgdHJhbnNmb3JtcyB0aGF0IG5lZWRzIHRvIG1ha2UgYSBkcmF3YWJsZVxuICAgKiBkaXJ0eS5cbiAgICovXG4gIG1hcmtQYWludERpcnR5KCkge1xuICAgIHRoaXMueHlEaXJ0eSA9IHRydWU7IC8vIHZlcnRleCBwb3NpdGlvbnMgY2FuIGRlcGVuZCBvbiBpbWFnZSB3aWR0aC9oZWlnaHRcbiAgICB0aGlzLnV2RGlydHkgPSB0cnVlO1xuXG4gICAgdGhpcy5tYXJrRGlydHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBET00gYXBwZWFyYW5jZSBvZiB0aGlzIGRyYXdhYmxlICh3aGV0aGVyIGJ5IHByZXBhcmluZy9jYWxsaW5nIGRyYXcgY2FsbHMsIERPTSBlbGVtZW50IHVwZGF0ZXMsIGV0Yy4pXG4gICAqIEBwdWJsaWNcbiAgICogQG92ZXJyaWRlXG4gICAqXG4gICAqIEByZXR1cm5zIHtib29sZWFufSAtIFdoZXRoZXIgdGhlIHVwZGF0ZSBzaG91bGQgY29udGludWUgKGlmIGZhbHNlLCBmdXJ0aGVyIHVwZGF0ZXMgaW4gc3VwZXJ0eXBlIHN0ZXBzIHNob3VsZCBub3RcbiAgICogICAgICAgICAgICAgICAgICAgICAgYmUgZG9uZSkuXG4gICAqL1xuICB1cGRhdGUoKSB7XG4gICAgLy8gU2VlIGlmIHdlIG5lZWQgdG8gYWN0dWFsbHkgdXBkYXRlIHRoaW5ncyAod2lsbCBiYWlsIG91dCBpZiB3ZSBhcmUgbm90IGRpcnR5LCBvciBpZiB3ZSd2ZSBiZWVuIGRpc3Bvc2VkKVxuICAgIGlmICggIXN1cGVyLnVwZGF0ZSgpICkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIGVuc3VyZSB0aGF0IHdlIGhhdmUgYSByZXNlcnZlZCBzcHJpdGUgKHBhcnQgb2YgdGhlIHNwcml0ZXNoZWV0KVxuICAgIHRoaXMucmVzZXJ2ZVNwcml0ZSgpO1xuXG4gICAgaWYgKCB0aGlzLmRpcnR5SW1hZ2VPcGFjaXR5IHx8ICF0aGlzLnVwZGF0ZWRPbmNlICkge1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzBfT0ZGU0VUICsgVkVSVEVYX0FfT0ZGU0VUIF0gPSB0aGlzLm5vZGUuX2ltYWdlT3BhY2l0eTtcbiAgICAgIHRoaXMudmVydGV4QXJyYXlbIFZFUlRFWF8xX09GRlNFVCArIFZFUlRFWF9BX09GRlNFVCBdID0gdGhpcy5ub2RlLl9pbWFnZU9wYWNpdHk7XG4gICAgICB0aGlzLnZlcnRleEFycmF5WyBWRVJURVhfMl9PRkZTRVQgKyBWRVJURVhfQV9PRkZTRVQgXSA9IHRoaXMubm9kZS5faW1hZ2VPcGFjaXR5O1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzNfT0ZGU0VUICsgVkVSVEVYX0FfT0ZGU0VUIF0gPSB0aGlzLm5vZGUuX2ltYWdlT3BhY2l0eTtcbiAgICAgIHRoaXMudmVydGV4QXJyYXlbIFZFUlRFWF80X09GRlNFVCArIFZFUlRFWF9BX09GRlNFVCBdID0gdGhpcy5ub2RlLl9pbWFnZU9wYWNpdHk7XG4gICAgICB0aGlzLnZlcnRleEFycmF5WyBWRVJURVhfNV9PRkZTRVQgKyBWRVJURVhfQV9PRkZTRVQgXSA9IHRoaXMubm9kZS5faW1hZ2VPcGFjaXR5O1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZWRPbmNlID0gdHJ1ZTtcblxuICAgIC8vIGlmIHdlIGRvbid0IGhhdmUgYSBzcHJpdGUgKHdlIGRvbid0IGhhdmUgYSBsb2FkZWQgaW1hZ2UgeWV0KSwganVzdCBiYWlsXG4gICAgaWYgKCAhdGhpcy5zcHJpdGUgKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKCB0aGlzLnV2RGlydHkgKSB7XG4gICAgICB0aGlzLnV2RGlydHkgPSBmYWxzZTtcblxuICAgICAgY29uc3QgdXZCb3VuZHMgPSB0aGlzLnNwcml0ZS51dkJvdW5kcztcblxuICAgICAgLy8gVE9ETzogY29uc2lkZXIgcmV2ZXJzYWwgb2YgbWluWSBhbmQgbWF4WSB1c2FnZSBoZXJlIGZvciB2ZXJ0aWNhbCBpbnZlcnNlIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zY2VuZXJ5L2lzc3Vlcy8xNTgxXG5cbiAgICAgIC8vIGZpcnN0IHRyaWFuZ2xlIFVWc1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzBfT0ZGU0VUICsgVkVSVEVYX1VfT0ZGU0VUIF0gPSB1dkJvdW5kcy5taW5YOyAvLyB1cHBlciBsZWZ0IFVcbiAgICAgIHRoaXMudmVydGV4QXJyYXlbIFZFUlRFWF8wX09GRlNFVCArIFZFUlRFWF9WX09GRlNFVCBdID0gdXZCb3VuZHMubWluWTsgLy8gdXBwZXIgbGVmdCBWXG4gICAgICB0aGlzLnZlcnRleEFycmF5WyBWRVJURVhfMV9PRkZTRVQgKyBWRVJURVhfVV9PRkZTRVQgXSA9IHV2Qm91bmRzLm1pblg7IC8vIGxvd2VyIGxlZnQgVVxuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzFfT0ZGU0VUICsgVkVSVEVYX1ZfT0ZGU0VUIF0gPSB1dkJvdW5kcy5tYXhZOyAvLyBsb3dlciBsZWZ0IFZcbiAgICAgIHRoaXMudmVydGV4QXJyYXlbIFZFUlRFWF8yX09GRlNFVCArIFZFUlRFWF9VX09GRlNFVCBdID0gdXZCb3VuZHMubWF4WDsgLy8gdXBwZXIgcmlnaHQgVVxuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzJfT0ZGU0VUICsgVkVSVEVYX1ZfT0ZGU0VUIF0gPSB1dkJvdW5kcy5taW5ZOyAvLyB1cHBlciByaWdodCBWXG5cbiAgICAgIC8vIHNlY29uZCB0cmlhbmdsZSBVVnNcbiAgICAgIHRoaXMudmVydGV4QXJyYXlbIFZFUlRFWF8zX09GRlNFVCArIFZFUlRFWF9VX09GRlNFVCBdID0gdXZCb3VuZHMubWF4WDsgLy8gdXBwZXIgcmlnaHQgVVxuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzNfT0ZGU0VUICsgVkVSVEVYX1ZfT0ZGU0VUIF0gPSB1dkJvdW5kcy5taW5ZOyAvLyB1cHBlciByaWdodCBWXG4gICAgICB0aGlzLnZlcnRleEFycmF5WyBWRVJURVhfNF9PRkZTRVQgKyBWRVJURVhfVV9PRkZTRVQgXSA9IHV2Qm91bmRzLm1pblg7IC8vIGxvd2VyIGxlZnQgVVxuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzRfT0ZGU0VUICsgVkVSVEVYX1ZfT0ZGU0VUIF0gPSB1dkJvdW5kcy5tYXhZOyAvLyBsb3dlciBsZWZ0IFZcbiAgICAgIHRoaXMudmVydGV4QXJyYXlbIFZFUlRFWF81X09GRlNFVCArIFZFUlRFWF9VX09GRlNFVCBdID0gdXZCb3VuZHMubWF4WDsgLy8gbG93ZXIgcmlnaHQgVVxuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzVfT0ZGU0VUICsgVkVSVEVYX1ZfT0ZGU0VUIF0gPSB1dkJvdW5kcy5tYXhZOyAvLyBsb3dlciByaWdodCBWXG4gICAgfVxuXG4gICAgaWYgKCB0aGlzLnh5RGlydHkgKSB7XG4gICAgICB0aGlzLnh5RGlydHkgPSBmYWxzZTtcblxuICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLm5vZGUuZ2V0SW1hZ2VXaWR0aCgpO1xuICAgICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5ub2RlLmdldEltYWdlSGVpZ2h0KCk7XG5cbiAgICAgIGNvbnN0IHRyYW5zZm9ybU1hdHJpeCA9IHRoaXMuaW5zdGFuY2UucmVsYXRpdmVUcmFuc2Zvcm0ubWF0cml4OyAvLyB3aXRoIGNvbXB1dGUgbmVlZCwgc2hvdWxkIGFsd2F5cyBiZSBhY2N1cmF0ZVxuICAgICAgdHJhbnNmb3JtTWF0cml4Lm11bHRpcGx5VmVjdG9yMiggdGhpcy51cHBlckxlZnQuc2V0WFkoIDAsIDAgKSApO1xuICAgICAgdHJhbnNmb3JtTWF0cml4Lm11bHRpcGx5VmVjdG9yMiggdGhpcy5sb3dlckxlZnQuc2V0WFkoIDAsIGhlaWdodCApICk7XG4gICAgICB0cmFuc2Zvcm1NYXRyaXgubXVsdGlwbHlWZWN0b3IyKCB0aGlzLnVwcGVyUmlnaHQuc2V0WFkoIHdpZHRoLCAwICkgKTtcbiAgICAgIHRyYW5zZm9ybU1hdHJpeC5tdWx0aXBseVZlY3RvcjIoIHRoaXMubG93ZXJSaWdodC5zZXRYWSggd2lkdGgsIGhlaWdodCApICk7XG5cbiAgICAgIC8vIGZpcnN0IHRyaWFuZ2xlIFhZc1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzBfT0ZGU0VUICsgVkVSVEVYX1hfT0ZGU0VUIF0gPSB0aGlzLnVwcGVyTGVmdC54O1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzBfT0ZGU0VUICsgVkVSVEVYX1lfT0ZGU0VUIF0gPSB0aGlzLnVwcGVyTGVmdC55O1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzFfT0ZGU0VUICsgVkVSVEVYX1hfT0ZGU0VUIF0gPSB0aGlzLmxvd2VyTGVmdC54O1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzFfT0ZGU0VUICsgVkVSVEVYX1lfT0ZGU0VUIF0gPSB0aGlzLmxvd2VyTGVmdC55O1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzJfT0ZGU0VUICsgVkVSVEVYX1hfT0ZGU0VUIF0gPSB0aGlzLnVwcGVyUmlnaHQueDtcbiAgICAgIHRoaXMudmVydGV4QXJyYXlbIFZFUlRFWF8yX09GRlNFVCArIFZFUlRFWF9ZX09GRlNFVCBdID0gdGhpcy51cHBlclJpZ2h0Lnk7XG5cbiAgICAgIC8vIHNlY29uZCB0cmlhbmdsZSBYWXNcbiAgICAgIHRoaXMudmVydGV4QXJyYXlbIFZFUlRFWF8zX09GRlNFVCArIFZFUlRFWF9YX09GRlNFVCBdID0gdGhpcy51cHBlclJpZ2h0Lng7XG4gICAgICB0aGlzLnZlcnRleEFycmF5WyBWRVJURVhfM19PRkZTRVQgKyBWRVJURVhfWV9PRkZTRVQgXSA9IHRoaXMudXBwZXJSaWdodC55O1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzRfT0ZGU0VUICsgVkVSVEVYX1hfT0ZGU0VUIF0gPSB0aGlzLmxvd2VyTGVmdC54O1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzRfT0ZGU0VUICsgVkVSVEVYX1lfT0ZGU0VUIF0gPSB0aGlzLmxvd2VyTGVmdC55O1xuICAgICAgdGhpcy52ZXJ0ZXhBcnJheVsgVkVSVEVYXzVfT0ZGU0VUICsgVkVSVEVYX1hfT0ZGU0VUIF0gPSB0aGlzLmxvd2VyUmlnaHQueDtcbiAgICAgIHRoaXMudmVydGV4QXJyYXlbIFZFUlRFWF81X09GRlNFVCArIFZFUlRFWF9ZX09GRlNFVCBdID0gdGhpcy5sb3dlclJpZ2h0Lnk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cblxuLy8gVE9ETzogZG9jIGh0dHBzOi8vZ2l0aHViLmNvbS9waGV0c2ltcy9zY2VuZXJ5L2lzc3Vlcy8xNTgxXG5JbWFnZVdlYkdMRHJhd2FibGUucHJvdG90eXBlLndlYmdsUmVuZGVyZXIgPSBSZW5kZXJlci53ZWJnbFRleHR1cmVkVHJpYW5nbGVzO1xuXG5zY2VuZXJ5LnJlZ2lzdGVyKCAnSW1hZ2VXZWJHTERyYXdhYmxlJywgSW1hZ2VXZWJHTERyYXdhYmxlICk7XG5cblBvb2xhYmxlLm1peEludG8oIEltYWdlV2ViR0xEcmF3YWJsZSApO1xuXG5leHBvcnQgZGVmYXVsdCBJbWFnZVdlYkdMRHJhd2FibGU7Il0sIm5hbWVzIjpbIlZlY3RvcjIiLCJQb29sYWJsZSIsIkltYWdlU3RhdGVmdWxEcmF3YWJsZSIsIlJlbmRlcmVyIiwic2NlbmVyeSIsIldlYkdMU2VsZkRyYXdhYmxlIiwiV0VCR0xfQ09NUE9ORU5UUyIsIlZFUlRFWF8wX09GRlNFVCIsIlZFUlRFWF8xX09GRlNFVCIsIlZFUlRFWF8yX09GRlNFVCIsIlZFUlRFWF8zX09GRlNFVCIsIlZFUlRFWF80X09GRlNFVCIsIlZFUlRFWF81X09GRlNFVCIsIlZFUlRFWF9YX09GRlNFVCIsIlZFUlRFWF9ZX09GRlNFVCIsIlZFUlRFWF9VX09GRlNFVCIsIlZFUlRFWF9WX09GRlNFVCIsIlZFUlRFWF9BX09GRlNFVCIsIkltYWdlV2ViR0xEcmF3YWJsZSIsImluaXRpYWxpemUiLCJyZW5kZXJlciIsImluc3RhbmNlIiwidmVydGV4QXJyYXkiLCJGbG9hdDMyQXJyYXkiLCJ1cHBlckxlZnQiLCJsb3dlckxlZnQiLCJ1cHBlclJpZ2h0IiwibG93ZXJSaWdodCIsInh5RGlydHkiLCJ1dkRpcnR5IiwidXBkYXRlZE9uY2UiLCJzcHJpdGUiLCJvbkFkZFRvQmxvY2siLCJ3ZWJnbEJsb2NrIiwibWFya0RpcnR5IiwicmVzZXJ2ZVNwcml0ZSIsIm9uUmVtb3ZlRnJvbUJsb2NrIiwidW5yZXNlcnZlU3ByaXRlIiwiaW1hZ2UiLCJub2RlIiwiX2ltYWdlIiwid2lkdGgiLCJnZXRJbWFnZVdpZHRoIiwiaGVpZ2h0IiwiZ2V0SW1hZ2VIZWlnaHQiLCJhZGRTcHJpdGVTaGVldEltYWdlIiwicmVtb3ZlU3ByaXRlU2hlZXRJbWFnZSIsIm1hcmtUcmFuc2Zvcm1EaXJ0eSIsIm1hcmtQYWludERpcnR5IiwidXBkYXRlIiwiZGlydHlJbWFnZU9wYWNpdHkiLCJfaW1hZ2VPcGFjaXR5IiwidXZCb3VuZHMiLCJtaW5YIiwibWluWSIsIm1heFkiLCJtYXhYIiwidHJhbnNmb3JtTWF0cml4IiwicmVsYXRpdmVUcmFuc2Zvcm0iLCJtYXRyaXgiLCJtdWx0aXBseVZlY3RvcjIiLCJzZXRYWSIsIngiLCJ5IiwicHJvdG90eXBlIiwid2ViZ2xSZW5kZXJlciIsIndlYmdsVGV4dHVyZWRUcmlhbmdsZXMiLCJyZWdpc3RlciIsIm1peEludG8iXSwibWFwcGluZ3MiOiJBQUFBLHNEQUFzRDtBQUV0RDs7OztDQUlDLEdBRUQsT0FBT0EsYUFBYSxnQ0FBZ0M7QUFDcEQsT0FBT0MsY0FBYyx1Q0FBdUM7QUFDNUQsU0FBU0MscUJBQXFCLEVBQUVDLFFBQVEsRUFBRUMsT0FBTyxFQUFFQyxpQkFBaUIsUUFBUSxtQkFBbUI7QUFFL0YsK0VBQStFO0FBQy9FLGdPQUFnTztBQUNoTyxNQUFNQyxtQkFBbUIsR0FBRyxvQ0FBb0M7QUFFaEUsTUFBTUMsa0JBQWtCRCxtQkFBbUI7QUFDM0MsTUFBTUUsa0JBQWtCRixtQkFBbUI7QUFDM0MsTUFBTUcsa0JBQWtCSCxtQkFBbUI7QUFDM0MsTUFBTUksa0JBQWtCSixtQkFBbUI7QUFDM0MsTUFBTUssa0JBQWtCTCxtQkFBbUI7QUFDM0MsTUFBTU0sa0JBQWtCTixtQkFBbUI7QUFFM0MsTUFBTU8sa0JBQWtCO0FBQ3hCLE1BQU1DLGtCQUFrQjtBQUN4QixNQUFNQyxrQkFBa0I7QUFDeEIsTUFBTUMsa0JBQWtCO0FBQ3hCLE1BQU1DLGtCQUFrQjtBQUV4QixJQUFBLEFBQU1DLHFCQUFOLE1BQU1BLDJCQUEyQmhCLHNCQUF1Qkc7SUFDdEQ7Ozs7OztHQU1DLEdBQ0RjLFdBQVlDLFFBQVEsRUFBRUMsUUFBUSxFQUFHO1FBQy9CLEtBQUssQ0FBQ0YsV0FB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