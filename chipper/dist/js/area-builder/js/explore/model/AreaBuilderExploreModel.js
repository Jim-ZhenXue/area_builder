// Copyright 2014-2022, University of Colorado Boulder
/**
 * Primary model class for the 'Explore' screen of the Area Builder simulation.
 *
 * @author John Blanco
 */ import createObservableArray from '../../../../axon/js/createObservableArray.js';
import Property from '../../../../axon/js/Property.js';
import StringProperty from '../../../../axon/js/StringProperty.js';
import Dimension2 from '../../../../dot/js/Dimension2.js';
import Vector2 from '../../../../dot/js/Vector2.js';
import { Shape } from '../../../../kite/js/imports.js';
import Bucket from '../../../../phetcommon/js/model/Bucket.js';
import areaBuilder from '../../areaBuilder.js';
import AreaBuilderSharedConstants from '../../common/AreaBuilderSharedConstants.js';
import MovableShape from '../../common/model/MovableShape.js';
import ShapePlacementBoard from '../../common/model/ShapePlacementBoard.js';
// constants
const UNIT_SQUARE_LENGTH = AreaBuilderSharedConstants.UNIT_SQUARE_LENGTH;
const UNIT_SQUARE_SHAPE = Shape.rect(0, 0, UNIT_SQUARE_LENGTH, UNIT_SQUARE_LENGTH);
const SMALL_BOARD_SIZE = new Dimension2(UNIT_SQUARE_LENGTH * 9, UNIT_SQUARE_LENGTH * 8);
const LARGE_BOARD_SIZE = new Dimension2(UNIT_SQUARE_LENGTH * 19, UNIT_SQUARE_LENGTH * 8);
const PLAY_AREA_WIDTH = AreaBuilderSharedConstants.LAYOUT_BOUNDS.width;
const SPACE_BETWEEN_PLACEMENT_BOARDS = UNIT_SQUARE_LENGTH;
const BOARD_Y_POS = 70; // Empirically determined from looking at the layout
const BUCKET_SIZE = new Dimension2(90, 45);
const BOARD_TO_BUCKET_Y_SPACING = 45;
let AreaBuilderExploreModel = class AreaBuilderExploreModel {
    /**
   * @param {number} dt
   * @public
   */ step(dt) {
        this.movableShapes.forEach((movableShape)=>{
            movableShape.step(dt);
        });
    }
    /**
   * @param movableShape
   * @private
   */ placeShape(movableShape) {
        let shapePlaced = false;
        for(let i = 0; i < this.shapePlacementBoards.length && !shapePlaced; i++){
            shapePlaced = this.shapePlacementBoards[i].placeShape(movableShape);
        }
        if (!shapePlaced) {
            movableShape.returnToOrigin(true);
        }
    }
    /**
   * Function for adding new movable shapes to this model when the user creates them, generally by clicking on some
   * some sort of creator node.
   * @public
   * @param movableShape
   */ addUserCreatedMovableShape(movableShape) {
        const self = this;
        this.movableShapes.push(movableShape);
        movableShape.userControlledProperty.link((userControlled)=>{
            if (!userControlled) {
                this.placeShape(movableShape);
            }
        });
        // The shape will be removed from the model if and when it returns to its origination point.  This is how a shape
        // can be 'put back' into the bucket.
        movableShape.returnedToOriginEmitter.addListener(()=>{
            if (!movableShape.userControlledProperty.get()) {
                // The shape has been returned to the bucket.
                this.movableShapes.remove(movableShape);
            }
        });
        // Another point at which the shape is removed is if it fades away.
        movableShape.fadeProportionProperty.link(function fadeHandler(fadeProportion) {
            if (fadeProportion === 1) {
                self.movableShapes.remove(movableShape);
                movableShape.fadeProportionProperty.unlink(fadeHandler);
            }
        });
    }
    /**
   * fill the boards with unit squares, useful for debugging, not used in general operation of the sim
   * @public
   */ fillBoards() {
        this.shapePlacementBoards.forEach((board)=>{
            const numRows = board.bounds.height / UNIT_SQUARE_LENGTH;
            const numColumns = board.bounds.width / UNIT_SQUARE_LENGTH;
            let movableShape;
            let shapeOrigin;
            if (board === this.leftShapePlacementBoard) {
                shapeOrigin = this.leftBucket.position;
            } else if (board === this.rightShapePlacementBoard) {
                shapeOrigin = this.rightBucket.position;
            } else {
                shapeOrigin = this.singleModeBucket.position;
            }
            _.times(numColumns, (columnIndex)=>{
                _.times(numRows, (rowIndex)=>{
                    movableShape = new MovableShape(UNIT_SQUARE_SHAPE, board.colorHandled, shapeOrigin);
                    movableShape.positionProperty.set(new Vector2(board.bounds.minX + columnIndex * UNIT_SQUARE_LENGTH, board.bounds.minY + rowIndex * UNIT_SQUARE_LENGTH));
                    this.addUserCreatedMovableShape(movableShape);
                });
            });
        });
    }
    /**
   * Resets all model elements
   * @public
   */ reset() {
        this.showShapeBoardGridsProperty.reset();
        this.showDimensionsProperty.reset();
        this.boardDisplayModeProperty.reset();
        this.shapePlacementBoards.forEach((board)=>{
            board.releaseAllShapes('jumpHome');
        });
        this.movableShapes.clear();
    }
    constructor(){
        this.showShapeBoardGridsProperty = new Property(true); // @public
        this.showDimensionsProperty = new Property(true); // @public
        this.boardDisplayModeProperty = new StringProperty('single'); // @public, value values are 'single' and 'dual'
        this.movableShapes = createObservableArray(); // @public
        this.unitSquareLength = UNIT_SQUARE_LENGTH; // @public, @final
        // Create the shape placement boards. Each boardDisplayMode has its own set of boards and buckets so that state can
        // be preserved when switching modes.
        this.leftShapePlacementBoard = new ShapePlacementBoard(SMALL_BOARD_SIZE, UNIT_SQUARE_LENGTH, new Vector2(PLAY_AREA_WIDTH / 2 - SPACE_BETWEEN_PLACEMENT_BOARDS / 2 - SMALL_BOARD_SIZE.width, BOARD_Y_POS), AreaBuilderSharedConstants.GREENISH_COLOR, this.showShapeBoardGridsProperty, this.showDimensionsProperty); // @public
        this.rightShapePlacementBoard = new ShapePlacementBoard(SMALL_BOARD_SIZE, UNIT_SQUARE_LENGTH, new Vector2(PLAY_AREA_WIDTH / 2 + SPACE_BETWEEN_PLACEMENT_BOARDS / 2, BOARD_Y_POS), AreaBuilderSharedConstants.PURPLISH_COLOR, this.showShapeBoardGridsProperty, this.showDimensionsProperty); // @public
        this.singleShapePlacementBoard = new ShapePlacementBoard(LARGE_BOARD_SIZE, UNIT_SQUARE_LENGTH, new Vector2(PLAY_AREA_WIDTH / 2 - LARGE_BOARD_SIZE.width / 2, BOARD_Y_POS), AreaBuilderSharedConstants.ORANGISH_COLOR, this.showShapeBoardGridsProperty, this.showDimensionsProperty); // @public
        // @private, for convenience.
        this.shapePlacementBoards = [
            this.leftShapePlacementBoard,
            this.rightShapePlacementBoard,
            this.singleShapePlacementBoard
        ];
        // Create the buckets that will hold the shapes.
        const bucketYPos = this.leftShapePlacementBoard.bounds.minY + SMALL_BOARD_SIZE.height + BOARD_TO_BUCKET_Y_SPACING;
        this.leftBucket = new Bucket({
            position: new Vector2(this.leftShapePlacementBoard.bounds.minX + SMALL_BOARD_SIZE.width * 0.7, bucketYPos),
            baseColor: '#000080',
            size: BUCKET_SIZE,
            invertY: true
        });
        this.rightBucket = new Bucket({
            position: new Vector2(this.rightShapePlacementBoard.bounds.minX + SMALL_BOARD_SIZE.width * 0.3, bucketYPos),
            baseColor: '#000080',
            size: BUCKET_SIZE,
            invertY: true
        });
        this.singleModeBucket = new Bucket({
            position: new Vector2(this.singleShapePlacementBoard.bounds.minX + LARGE_BOARD_SIZE.width / 2, bucketYPos),
            baseColor: '#000080',
            size: BUCKET_SIZE,
            invertY: true
        });
    }
};
areaBuilder.register('AreaBuilderExploreModel', AreaBuilderExploreModel);
export default AreaBuilderExploreModel;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2FyZWEtYnVpbGRlci9qcy9leHBsb3JlL21vZGVsL0FyZWFCdWlsZGVyRXhwbG9yZU1vZGVsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE0LTIwMjIsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxuXG4vKipcbiAqIFByaW1hcnkgbW9kZWwgY2xhc3MgZm9yIHRoZSAnRXhwbG9yZScgc2NyZWVuIG9mIHRoZSBBcmVhIEJ1aWxkZXIgc2ltdWxhdGlvbi5cbiAqXG4gKiBAYXV0aG9yIEpvaG4gQmxhbmNvXG4gKi9cblxuaW1wb3J0IGNyZWF0ZU9ic2VydmFibGVBcnJheSBmcm9tICcuLi8uLi8uLi8uLi9heG9uL2pzL2NyZWF0ZU9ic2VydmFibGVBcnJheS5qcyc7XG5pbXBvcnQgUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9Qcm9wZXJ0eS5qcyc7XG5pbXBvcnQgU3RyaW5nUHJvcGVydHkgZnJvbSAnLi4vLi4vLi4vLi4vYXhvbi9qcy9TdHJpbmdQcm9wZXJ0eS5qcyc7XG5pbXBvcnQgRGltZW5zaW9uMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvRGltZW5zaW9uMi5qcyc7XG5pbXBvcnQgVmVjdG9yMiBmcm9tICcuLi8uLi8uLi8uLi9kb3QvanMvVmVjdG9yMi5qcyc7XG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uLy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XG5pbXBvcnQgQnVja2V0IGZyb20gJy4uLy4uLy4uLy4uL3BoZXRjb21tb24vanMvbW9kZWwvQnVja2V0LmpzJztcbmltcG9ydCBhcmVhQnVpbGRlciBmcm9tICcuLi8uLi9hcmVhQnVpbGRlci5qcyc7XG5pbXBvcnQgQXJlYUJ1aWxkZXJTaGFyZWRDb25zdGFudHMgZnJvbSAnLi4vLi4vY29tbW9uL0FyZWFCdWlsZGVyU2hhcmVkQ29uc3RhbnRzLmpzJztcbmltcG9ydCBNb3ZhYmxlU2hhcGUgZnJvbSAnLi4vLi4vY29tbW9uL21vZGVsL01vdmFibGVTaGFwZS5qcyc7XG5pbXBvcnQgU2hhcGVQbGFjZW1lbnRCb2FyZCBmcm9tICcuLi8uLi9jb21tb24vbW9kZWwvU2hhcGVQbGFjZW1lbnRCb2FyZC5qcyc7XG5cbi8vIGNvbnN0YW50c1xuY29uc3QgVU5JVF9TUVVBUkVfTEVOR1RIID0gQXJlYUJ1aWxkZXJTaGFyZWRDb25zdGFudHMuVU5JVF9TUVVBUkVfTEVOR1RIO1xuY29uc3QgVU5JVF9TUVVBUkVfU0hBUEUgPSBTaGFwZS5yZWN0KCAwLCAwLCBVTklUX1NRVUFSRV9MRU5HVEgsIFVOSVRfU1FVQVJFX0xFTkdUSCApO1xuY29uc3QgU01BTExfQk9BUkRfU0laRSA9IG5ldyBEaW1lbnNpb24yKCBVTklUX1NRVUFSRV9MRU5HVEggKiA5LCBVTklUX1NRVUFSRV9MRU5HVEggKiA4ICk7XG5jb25zdCBMQVJHRV9CT0FSRF9TSVpFID0gbmV3IERpbWVuc2lvbjIoIFVOSVRfU1FVQVJFX0xFTkdUSCAqIDE5LCBVTklUX1NRVUFSRV9MRU5HVEggKiA4ICk7XG5jb25zdCBQTEFZX0FSRUFfV0lEVEggPSBBcmVhQnVpbGRlclNoYXJlZENvbnN0YW50cy5MQVlPVVRfQk9VTkRTLndpZHRoO1xuY29uc3QgU1BBQ0VfQkVUV0VFTl9QTEFDRU1FTlRfQk9BUkRTID0gVU5JVF9TUVVBUkVfTEVOR1RIO1xuY29uc3QgQk9BUkRfWV9QT1MgPSA3MDsgLy8gRW1waXJpY2FsbHkgZGV0ZXJtaW5lZCBmcm9tIGxvb2tpbmcgYXQgdGhlIGxheW91dFxuY29uc3QgQlVDS0VUX1NJWkUgPSBuZXcgRGltZW5zaW9uMiggOTAsIDQ1ICk7XG5jb25zdCBCT0FSRF9UT19CVUNLRVRfWV9TUEFDSU5HID0gNDU7XG5cbmNsYXNzIEFyZWFCdWlsZGVyRXhwbG9yZU1vZGVsIHtcblxuICBjb25zdHJ1Y3RvcigpIHtcblxuICAgIHRoaXMuc2hvd1NoYXBlQm9hcmRHcmlkc1Byb3BlcnR5ID0gbmV3IFByb3BlcnR5KCB0cnVlICk7IC8vIEBwdWJsaWNcbiAgICB0aGlzLnNob3dEaW1lbnNpb25zUHJvcGVydHkgPSBuZXcgUHJvcGVydHkoIHRydWUgKTsgLy8gQHB1YmxpY1xuICAgIHRoaXMuYm9hcmREaXNwbGF5TW9kZVByb3BlcnR5ID0gbmV3IFN0cmluZ1Byb3BlcnR5KCAnc2luZ2xlJyApOyAvLyBAcHVibGljLCB2YWx1ZSB2YWx1ZXMgYXJlICdzaW5nbGUnIGFuZCAnZHVhbCdcblxuICAgIHRoaXMubW92YWJsZVNoYXBlcyA9IGNyZWF0ZU9ic2VydmFibGVBcnJheSgpOyAvLyBAcHVibGljXG4gICAgdGhpcy51bml0U3F1YXJlTGVuZ3RoID0gVU5JVF9TUVVBUkVfTEVOR1RIOyAvLyBAcHVibGljLCBAZmluYWxcblxuICAgIC8vIENyZWF0ZSB0aGUgc2hhcGUgcGxhY2VtZW50IGJvYXJkcy4gRWFjaCBib2FyZERpc3BsYXlNb2RlIGhhcyBpdHMgb3duIHNldCBvZiBib2FyZHMgYW5kIGJ1Y2tldHMgc28gdGhhdCBzdGF0ZSBjYW5cbiAgICAvLyBiZSBwcmVzZXJ2ZWQgd2hlbiBzd2l0Y2hpbmcgbW9kZXMuXG4gICAgdGhpcy5sZWZ0U2hhcGVQbGFjZW1lbnRCb2FyZCA9IG5ldyBTaGFwZVBsYWNlbWVudEJvYXJkKFxuICAgICAgU01BTExfQk9BUkRfU0laRSxcbiAgICAgIFVOSVRfU1FVQVJFX0xFTkdUSCxcbiAgICAgIG5ldyBWZWN0b3IyKCBQTEFZX0FSRUFfV0lEVEggLyAyIC0gU1BBQ0VfQkVUV0VFTl9QTEFDRU1FTlRfQk9BUkRTIC8gMiAtIFNNQUxMX0JPQVJEX1NJWkUud2lkdGgsIEJPQVJEX1lfUE9TICksXG4gICAgICBBcmVhQnVpbGRlclNoYXJlZENvbnN0YW50cy5HUkVFTklTSF9DT0xPUixcbiAgICAgIHRoaXMuc2hvd1NoYXBlQm9hcmRHcmlkc1Byb3BlcnR5LFxuICAgICAgdGhpcy5zaG93RGltZW5zaW9uc1Byb3BlcnR5XG4gICAgKTsgLy8gQHB1YmxpY1xuICAgIHRoaXMucmlnaHRTaGFwZVBsYWNlbWVudEJvYXJkID0gbmV3IFNoYXBlUGxhY2VtZW50Qm9hcmQoXG4gICAgICBTTUFMTF9CT0FSRF9TSVpFLFxuICAgICAgVU5JVF9TUVVBUkVfTEVOR1RILFxuICAgICAgbmV3IFZlY3RvcjIoIFBMQVlfQVJFQV9XSURUSCAvIDIgKyBTUEFDRV9CRVRXRUVOX1BMQUNFTUVOVF9CT0FSRFMgLyAyLCBCT0FSRF9ZX1BPUyApLFxuICAgICAgQXJlYUJ1aWxkZXJTaGFyZWRDb25zdGFudHMuUFVSUExJU0hfQ09MT1IsXG4gICAgICB0aGlzLnNob3dTaGFwZUJvYXJkR3JpZHNQcm9wZXJ0eSxcbiAgICAgIHRoaXMuc2hvd0RpbWVuc2lvbnNQcm9wZXJ0eVxuICAgICk7IC8vIEBwdWJsaWNcbiAgICB0aGlzLnNpbmdsZVNoYXBlUGxhY2VtZW50Qm9hcmQgPSBuZXcgU2hhcGVQbGFjZW1lbnRCb2FyZChcbiAgICAgIExBUkdFX0JPQVJEX1NJWkUsXG4gICAgICBVTklUX1NRVUFSRV9MRU5HVEgsXG4gICAgICBuZXcgVmVjdG9yMiggUExBWV9BUkVBX1dJRFRIIC8gMiAtIExBUkdFX0JPQVJEX1NJWkUud2lkdGggLyAyLCBCT0FSRF9ZX1BPUyApLFxuICAgICAgQXJlYUJ1aWxkZXJTaGFyZWRDb25zdGFudHMuT1JBTkdJU0hfQ09MT1IsXG4gICAgICB0aGlzLnNob3dTaGFwZUJvYXJkR3JpZHNQcm9wZXJ0eSxcbiAgICAgIHRoaXMuc2hvd0RpbWVuc2lvbnNQcm9wZXJ0eVxuICAgICk7IC8vIEBwdWJsaWNcblxuICAgIC8vIEBwcml2YXRlLCBmb3IgY29udmVuaWVuY2UuXG4gICAgdGhpcy5zaGFwZVBsYWNlbWVudEJvYXJkcyA9IFsgdGhpcy5sZWZ0U2hhcGVQbGFjZW1lbnRCb2FyZCwgdGhpcy5yaWdodFNoYXBlUGxhY2VtZW50Qm9hcmQsIHRoaXMuc2luZ2xlU2hhcGVQbGFjZW1lbnRCb2FyZCBdO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBidWNrZXRzIHRoYXQgd2lsbCBob2xkIHRoZSBzaGFwZXMuXG4gICAgY29uc3QgYnVja2V0WVBvcyA9IHRoaXMubGVmdFNoYXBlUGxhY2VtZW50Qm9hcmQuYm91bmRzLm1pblkgKyBTTUFMTF9CT0FSRF9TSVpFLmhlaWdodCArIEJPQVJEX1RPX0JVQ0tFVF9ZX1NQQUNJTkc7XG4gICAgdGhpcy5sZWZ0QnVja2V0ID0gbmV3IEJ1Y2tldCgge1xuICAgICAgcG9zaXRpb246IG5ldyBWZWN0b3IyKCB0aGlzLmxlZnRTaGFwZVBsYWNlbWVudEJvYXJkLmJvdW5kcy5taW5YICsgU01BTExfQk9BUkRfU0laRS53aWR0aCAqIDAuNywgYnVja2V0WVBvcyApLFxuICAgICAgYmFzZUNvbG9yOiAnIzAwMDA4MCcsXG4gICAgICBzaXplOiBCVUNLRVRfU0laRSxcbiAgICAgIGludmVydFk6IHRydWVcbiAgICB9ICk7XG4gICAgdGhpcy5yaWdodEJ1Y2tldCA9IG5ldyBCdWNrZXQoIHtcbiAgICAgIHBvc2l0aW9uOiBuZXcgVmVjdG9yMiggdGhpcy5yaWdodFNoYXBlUGxhY2VtZW50Qm9hcmQuYm91bmRzLm1pblggKyBTTUFMTF9CT0FSRF9TSVpFLndpZHRoICogMC4zLCBidWNrZXRZUG9zICksXG4gICAgICBiYXNlQ29sb3I6ICcjMDAwMDgwJyxcbiAgICAgIHNpemU6IEJVQ0tFVF9TSVpFLFxuICAgICAgaW52ZXJ0WTogdHJ1ZVxuICAgIH0gKTtcbiAgICB0aGlzLnNpbmdsZU1vZGVCdWNrZXQgPSBuZXcgQnVja2V0KCB7XG4gICAgICBwb3NpdGlvbjogbmV3IFZlY3RvcjIoIHRoaXMuc2luZ2xlU2hhcGVQbGFjZW1lbnRCb2FyZC5ib3VuZHMubWluWCArIExBUkdFX0JPQVJEX1NJWkUud2lkdGggLyAyLCBidWNrZXRZUG9zICksXG4gICAgICBiYXNlQ29sb3I6ICcjMDAwMDgwJyxcbiAgICAgIHNpemU6IEJVQ0tFVF9TSVpFLFxuICAgICAgaW52ZXJ0WTogdHJ1ZVxuICAgIH0gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gZHRcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgc3RlcCggZHQgKSB7XG4gICAgdGhpcy5tb3ZhYmxlU2hhcGVzLmZvckVhY2goIG1vdmFibGVTaGFwZSA9PiB7IG1vdmFibGVTaGFwZS5zdGVwKCBkdCApOyB9ICk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIG1vdmFibGVTaGFwZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcGxhY2VTaGFwZSggbW92YWJsZVNoYXBlICkge1xuICAgIGxldCBzaGFwZVBsYWNlZCA9IGZhbHNlO1xuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHRoaXMuc2hhcGVQbGFjZW1lbnRCb2FyZHMubGVuZ3RoICYmICFzaGFwZVBsYWNlZDsgaSsrICkge1xuICAgICAgc2hhcGVQbGFjZWQgPSB0aGlzLnNoYXBlUGxhY2VtZW50Qm9hcmRzWyBpIF0ucGxhY2VTaGFwZSggbW92YWJsZVNoYXBlICk7XG4gICAgfVxuICAgIGlmICggIXNoYXBlUGxhY2VkICkge1xuICAgICAgbW92YWJsZVNoYXBlLnJldHVyblRvT3JpZ2luKCB0cnVlICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZ1bmN0aW9uIGZvciBhZGRpbmcgbmV3IG1vdmFibGUgc2hhcGVzIHRvIHRoaXMgbW9kZWwgd2hlbiB0aGUgdXNlciBjcmVhdGVzIHRoZW0sIGdlbmVyYWxseSBieSBjbGlja2luZyBvbiBzb21lXG4gICAqIHNvbWUgc29ydCBvZiBjcmVhdG9yIG5vZGUuXG4gICAqIEBwdWJsaWNcbiAgICogQHBhcmFtIG1vdmFibGVTaGFwZVxuICAgKi9cbiAgYWRkVXNlckNyZWF0ZWRNb3ZhYmxlU2hhcGUoIG1vdmFibGVTaGFwZSApIHtcbiAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICB0aGlzLm1vdmFibGVTaGFwZXMucHVzaCggbW92YWJsZVNoYXBlICk7XG4gICAgbW92YWJsZVNoYXBlLnVzZXJDb250cm9sbGVkUHJvcGVydHkubGluayggdXNlckNvbnRyb2xsZWQgPT4ge1xuICAgICAgaWYgKCAhdXNlckNvbnRyb2xsZWQgKSB7XG4gICAgICAgIHRoaXMucGxhY2VTaGFwZSggbW92YWJsZVNoYXBlICk7XG4gICAgICB9XG4gICAgfSApO1xuXG4gICAgLy8gVGhlIHNoYXBlIHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBtb2RlbCBpZiBhbmQgd2hlbiBpdCByZXR1cm5zIHRvIGl0cyBvcmlnaW5hdGlvbiBwb2ludC4gIFRoaXMgaXMgaG93IGEgc2hhcGVcbiAgICAvLyBjYW4gYmUgJ3B1dCBiYWNrJyBpbnRvIHRoZSBidWNrZXQuXG4gICAgbW92YWJsZVNoYXBlLnJldHVybmVkVG9PcmlnaW5FbWl0dGVyLmFkZExpc3RlbmVyKCAoKSA9PiB7XG4gICAgICBpZiAoICFtb3ZhYmxlU2hhcGUudXNlckNvbnRyb2xsZWRQcm9wZXJ0eS5nZXQoKSApIHtcblxuICAgICAgICAvLyBUaGUgc2hhcGUgaGFzIGJlZW4gcmV0dXJuZWQgdG8gdGhlIGJ1Y2tldC5cbiAgICAgICAgdGhpcy5tb3ZhYmxlU2hhcGVzLnJlbW92ZSggbW92YWJsZVNoYXBlICk7XG4gICAgICB9XG4gICAgfSApO1xuXG4gICAgLy8gQW5vdGhlciBwb2ludCBhdCB3aGljaCB0aGUgc2hhcGUgaXMgcmVtb3ZlZCBpcyBpZiBpdCBmYWRlcyBhd2F5LlxuICAgIG1vdmFibGVTaGFwZS5mYWRlUHJvcG9ydGlvblByb3BlcnR5LmxpbmsoIGZ1bmN0aW9uIGZhZGVIYW5kbGVyKCBmYWRlUHJvcG9ydGlvbiApIHtcbiAgICAgIGlmICggZmFkZVByb3BvcnRpb24gPT09IDEgKSB7XG4gICAgICAgIHNlbGYubW92YWJsZVNoYXBlcy5yZW1vdmUoIG1vdmFibGVTaGFwZSApO1xuICAgICAgICBtb3ZhYmxlU2hhcGUuZmFkZVByb3BvcnRpb25Qcm9wZXJ0eS51bmxpbmsoIGZhZGVIYW5kbGVyICk7XG4gICAgICB9XG4gICAgfSApO1xuICB9XG5cbiAgLyoqXG4gICAqIGZpbGwgdGhlIGJvYXJkcyB3aXRoIHVuaXQgc3F1YXJlcywgdXNlZnVsIGZvciBkZWJ1Z2dpbmcsIG5vdCB1c2VkIGluIGdlbmVyYWwgb3BlcmF0aW9uIG9mIHRoZSBzaW1cbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZmlsbEJvYXJkcygpIHtcbiAgICB0aGlzLnNoYXBlUGxhY2VtZW50Qm9hcmRzLmZvckVhY2goIGJvYXJkID0+IHtcbiAgICAgIGNvbnN0IG51bVJvd3MgPSBib2FyZC5ib3VuZHMuaGVpZ2h0IC8gVU5JVF9TUVVBUkVfTEVOR1RIO1xuICAgICAgY29uc3QgbnVtQ29sdW1ucyA9IGJvYXJkLmJvdW5kcy53aWR0aCAvIFVOSVRfU1FVQVJFX0xFTkdUSDtcbiAgICAgIGxldCBtb3ZhYmxlU2hhcGU7XG4gICAgICBsZXQgc2hhcGVPcmlnaW47XG4gICAgICBpZiAoIGJvYXJkID09PSB0aGlzLmxlZnRTaGFwZVBsYWNlbWVudEJvYXJkICkge1xuICAgICAgICBzaGFwZU9yaWdpbiA9IHRoaXMubGVmdEJ1Y2tldC5wb3NpdGlvbjtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKCBib2FyZCA9PT0gdGhpcy5yaWdodFNoYXBlUGxhY2VtZW50Qm9hcmQgKSB7XG4gICAgICAgIHNoYXBlT3JpZ2luID0gdGhpcy5yaWdodEJ1Y2tldC5wb3NpdGlvbjtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBzaGFwZU9yaWdpbiA9IHRoaXMuc2luZ2xlTW9kZUJ1Y2tldC5wb3NpdGlvbjtcbiAgICAgIH1cbiAgICAgIF8udGltZXMoIG51bUNvbHVtbnMsIGNvbHVtbkluZGV4ID0+IHtcbiAgICAgICAgXy50aW1lcyggbnVtUm93cywgcm93SW5kZXggPT4ge1xuICAgICAgICAgIG1vdmFibGVTaGFwZSA9IG5ldyBNb3ZhYmxlU2hhcGUoIFVOSVRfU1FVQVJFX1NIQVBFLCBib2FyZC5jb2xvckhhbmRsZWQsIHNoYXBlT3JpZ2luICk7XG4gICAgICAgICAgbW92YWJsZVNoYXBlLnBvc2l0aW9uUHJvcGVydHkuc2V0KCBuZXcgVmVjdG9yMihcbiAgICAgICAgICAgIGJvYXJkLmJvdW5kcy5taW5YICsgY29sdW1uSW5kZXggKiBVTklUX1NRVUFSRV9MRU5HVEgsXG4gICAgICAgICAgICBib2FyZC5ib3VuZHMubWluWSArIHJvd0luZGV4ICogVU5JVF9TUVVBUkVfTEVOR1RIXG4gICAgICAgICAgKSApO1xuICAgICAgICAgIHRoaXMuYWRkVXNlckNyZWF0ZWRNb3ZhYmxlU2hhcGUoIG1vdmFibGVTaGFwZSApO1xuICAgICAgICB9ICk7XG4gICAgICB9ICk7XG4gICAgfSApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc2V0cyBhbGwgbW9kZWwgZWxlbWVudHNcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgcmVzZXQoKSB7XG4gICAgdGhpcy5zaG93U2hhcGVCb2FyZEdyaWRzUHJvcGVydHkucmVzZXQoKTtcbiAgICB0aGlzLnNob3dEaW1lbnNpb25zUHJvcGVydHkucmVzZXQoKTtcbiAgICB0aGlzLmJvYXJkRGlzcGxheU1vZGVQcm9wZXJ0eS5yZXNldCgpO1xuICAgIHRoaXMuc2hhcGVQbGFjZW1lbnRCb2FyZHMuZm9yRWFjaCggYm9hcmQgPT4geyBib2FyZC5yZWxlYXNlQWxsU2hhcGVzKCAnanVtcEhvbWUnICk7IH0gKTtcbiAgICB0aGlzLm1vdmFibGVTaGFwZXMuY2xlYXIoKTtcbiAgfVxufVxuXG5hcmVhQnVpbGRlci5yZWdpc3RlciggJ0FyZWFCdWlsZGVyRXhwbG9yZU1vZGVsJywgQXJlYUJ1aWxkZXJFeHBsb3JlTW9kZWwgKTtcbmV4cG9ydCBkZWZhdWx0IEFyZWFCdWlsZGVyRXhwbG9yZU1vZGVsOyJdLCJuYW1lcyI6WyJjcmVhdGVPYnNlcnZhYmxlQXJyYXkiLCJQcm9wZXJ0eSIsIlN0cmluZ1Byb3BlcnR5IiwiRGltZW5zaW9uMiIsIlZlY3RvcjIiLCJTaGFwZSIsIkJ1Y2tldCIsImFyZWFCdWlsZGVyIiwiQXJlYUJ1aWxkZXJTaGFyZWRDb25zdGFudHMiLCJNb3ZhYmxlU2hhcGUiLCJTaGFwZVBsYWNlbWVudEJvYXJkIiwiVU5JVF9TUVVBUkVfTEVOR1RIIiwiVU5JVF9TUVVBUkVfU0hBUEUiLCJyZWN0IiwiU01BTExfQk9BUkRfU0laRSIsIkxBUkdFX0JPQVJEX1NJWkUiLCJQTEFZX0FSRUFfV0lEVEgiLCJMQVlPVVRfQk9VTkRTIiwid2lkdGgiLCJTUEFDRV9CRVRXRUVOX1BMQUNFTUVOVF9CT0FSRFMiLCJCT0FSRF9ZX1BPUyIsIkJVQ0tFVF9TSVpFIiwiQk9BUkRfVE9fQlVDS0VUX1lfU1BBQ0lORyIsIkFyZWFCdWlsZGVyRXhwbG9yZU1vZGVsIiwic3RlcCIsImR0IiwibW92YWJsZVNoYXBlcyIsImZvckVhY2giLCJtb3ZhYmxlU2hhcGUiLCJwbGFjZVNoYXBlIiwic2hhcGVQbGFjZWQiLCJpIiwic2hhcGVQbGFjZW1lbnRCb2FyZHMiLCJsZW5ndGgiLCJyZXR1cm5Ub09yaWdpbiIsImFkZFVzZXJDcmVhdGVkTW92YWJsZVNoYXBlIiwic2VsZiIsInB1c2giLCJ1c2VyQ29udHJvbGxlZFByb3BlcnR5IiwibGluayIsInVzZXJDb250cm9sbGVkIiwicmV0dXJuZWRUb09yaWdpbkVtaXR0ZXIiLCJhZGRMaXN0ZW5lciIsImdldCIsInJlbW92ZSIsImZhZGVQcm9wb3J0aW9uUHJvcGVydHkiLCJmYWRlSGFuZGxlciIsImZhZGVQcm9wb3J0aW9uIiwidW5saW5rIiwiZmlsbEJvYXJkcyIsImJvYXJkIiwibnVtUm93cyIsImJvdW5kcyIsImhlaWdodCIsIm51bUNvbHVtbnMiLCJzaGFwZU9yaWdpbiIsImxlZnRTaGFwZVBsYWNlbWVudEJvYXJkIiwibGVmdEJ1Y2tldCIsInBvc2l0aW9uIiwicmlnaHRTaGFwZVBsYWNlbWVudEJvYXJkIiwicmlnaHRCdWNrZXQiLCJzaW5nbGVNb2RlQnVja2V0IiwiXyIsInRpbWVzIiwiY29sdW1uSW5kZXgiLCJyb3dJbmRleCIsImNvbG9ySGFuZGxlZCIsInBvc2l0aW9uUHJvcGVydHkiLCJzZXQiLCJtaW5YIiwibWluWSIsInJlc2V0Iiwic2hvd1NoYXBlQm9hcmRHcmlkc1Byb3BlcnR5Iiwic2hvd0RpbWVuc2lvbnNQcm9wZXJ0eSIsImJvYXJkRGlzcGxheU1vZGVQcm9wZXJ0eSIsInJlbGVhc2VBbGxTaGFwZXMiLCJjbGVhciIsImNvbnN0cnVjdG9yIiwidW5pdFNxdWFyZUxlbmd0aCIsIkdSRUVOSVNIX0NPTE9SIiwiUFVSUExJU0hfQ09MT1IiLCJzaW5nbGVTaGFwZVBsYWNlbWVudEJvYXJkIiwiT1JBTkdJU0hfQ09MT1IiLCJidWNrZXRZUG9zIiwiYmFzZUNvbG9yIiwic2l6ZSIsImludmVydFkiLCJyZWdpc3RlciJdLCJtYXBwaW5ncyI6IkFBQUEsc0RBQXNEO0FBRXREOzs7O0NBSUMsR0FFRCxPQUFPQSwyQkFBMkIsK0NBQStDO0FBQ2pGLE9BQU9DLGNBQWMsa0NBQWtDO0FBQ3ZELE9BQU9DLG9CQUFvQix3Q0FBd0M7QUFDbkUsT0FBT0MsZ0JBQWdCLG1DQUFtQztBQUMxRCxPQUFPQyxhQUFhLGdDQUFnQztBQUNwRCxTQUFTQyxLQUFLLFFBQVEsaUNBQWlDO0FBQ3ZELE9BQU9DLFlBQVksNENBQTRDO0FBQy9ELE9BQU9DLGlCQUFpQix1QkFBdUI7QUFDL0MsT0FBT0MsZ0NBQWdDLDZDQUE2QztBQUNwRixPQUFPQyxrQkFBa0IscUNBQXFDO0FBQzlELE9BQU9DLHlCQUF5Qiw0Q0FBNEM7QUFFNUUsWUFBWTtBQUNaLE1BQU1DLHFCQUFxQkgsMkJBQTJCRyxrQkFBa0I7QUFDeEUsTUFBTUMsb0JBQW9CUCxNQUFNUSxJQUFJLENBQUUsR0FBRyxHQUFHRixvQkFBb0JBO0FBQ2hFLE1BQU1HLG1CQUFtQixJQUFJWCxXQUFZUSxxQkFBcUIsR0FBR0EscUJBQXFCO0FBQ3RGLE1BQU1JLG1CQUFtQixJQUFJWixXQUFZUSxxQkFBcUIsSUFBSUEscUJBQXFCO0FBQ3ZGLE1BQU1LLGtCQUFrQlIsMkJBQTJCUyxhQUFhLENBQUNDLEtBQUs7QUFDdEUsTUFBTUMsaUNBQWlDUjtBQUN2QyxNQUFNUyxjQUFjLElBQUksb0RBQW9EO0FBQzVFLE1BQU1DLGNBQWMsSUFBSWxCLFdBQVksSUFBSTtBQUN4QyxNQUFNbUIsNEJBQTRCO0FBRWxDLElBQUEsQUFBTUMsMEJBQU4sTUFBTUE7SUEr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