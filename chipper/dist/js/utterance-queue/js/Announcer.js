// Copyright 2021-2023, University of Colorado Boulder
/**
 * Abstract base class for the type that wires into an UtteranceQueue to announce Utterances.
 *
 * @author Michael Kauzmann (PhET Interactive Simulations)
 */ import Emitter from '../../axon/js/Emitter.js';
import optionize from '../../phet-core/js/optionize.js';
import PhetioObject from '../../tandem/js/PhetioObject.js';
import IOType from '../../tandem/js/types/IOType.js';
import NullableIO from '../../tandem/js/types/NullableIO.js';
import NumberIO from '../../tandem/js/types/NumberIO.js';
import OrIO from '../../tandem/js/types/OrIO.js';
import StringIO from '../../tandem/js/types/StringIO.js';
import Utterance from './Utterance.js';
import utteranceQueueNamespace from './utteranceQueueNamespace.js';
let Announcer = class Announcer extends PhetioObject {
    /**
   * Determine if one utterance should cancel another. Default behavior for this superclass is to cancel when
   * the new Utterance is of higher priority. But subclasses may re-implement this function if it has special logic
   * or announcerOptions that override this behavior.
   */ shouldUtteranceCancelOther(utterance, utteranceToCancel) {
        return utteranceToCancel.priorityProperty.value < utterance.priorityProperty.value;
    }
    /**
   * Intended to be overridden by subtypes if necessary as a way to order the queue if there is announcer
   * specific logic.
   */ onUtterancePriorityChange(utterance) {
    // See subclass for implementation
    }
    constructor(providedOptions){
        var _options_tandem;
        const options = optionize()({
            respectResponseCollectorProperties: true,
            phetioType: Announcer.AnnouncerIO,
            phetioState: false
        }, providedOptions);
        super(options), // A flag that indicates to an UtteranceQueue that this Announcer is ready to speak the next Utterance.
        this.readyToAnnounce = true, // A flag that indicates whether this announcer has successfully spoken at least once.
        this.hasSpoken = false;
        this.respectResponseCollectorProperties = options.respectResponseCollectorProperties;
        this.announcementCompleteEmitter = new Emitter({
            parameters: [
                {
                    name: 'utterance',
                    phetioType: Utterance.UtteranceIO
                },
                {
                    name: 'text',
                    phetioType: NullableIO(OrIO([
                        StringIO,
                        NumberIO
                    ]))
                }
            ],
            tandem: (_options_tandem = options.tandem) == null ? void 0 : _options_tandem.createTandem('announcementCompleteEmitter'),
            phetioReadOnly: true,
            phetioDocumentation: 'The announcement that has just completed. The Utterance text could potentially differ from ' + 'the exact text that was announced, so both are emitted. Use `text` for an exact match of what was announced.'
        });
    }
};
Announcer.AnnouncerIO = new IOType('AnnouncerIO', {
    valueType: Announcer,
    documentation: 'Announces text to a specific browser technology (like aria-live or web speech)'
});
utteranceQueueNamespace.register('Announcer', Announcer);
export default Announcer;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3V0dGVyYW5jZS1xdWV1ZS9qcy9Bbm5vdW5jZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjEtMjAyMywgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXG5cbi8qKlxuICogQWJzdHJhY3QgYmFzZSBjbGFzcyBmb3IgdGhlIHR5cGUgdGhhdCB3aXJlcyBpbnRvIGFuIFV0dGVyYW5jZVF1ZXVlIHRvIGFubm91bmNlIFV0dGVyYW5jZXMuXG4gKlxuICogQGF1dGhvciBNaWNoYWVsIEthdXptYW5uIChQaEVUIEludGVyYWN0aXZlIFNpbXVsYXRpb25zKVxuICovXG5cbmltcG9ydCBFbWl0dGVyIGZyb20gJy4uLy4uL2F4b24vanMvRW1pdHRlci5qcyc7XG5pbXBvcnQgVEVtaXR0ZXIgZnJvbSAnLi4vLi4vYXhvbi9qcy9URW1pdHRlci5qcyc7XG5pbXBvcnQgb3B0aW9uaXplLCB7IEVtcHR5U2VsZk9wdGlvbnMgfSBmcm9tICcuLi8uLi9waGV0LWNvcmUvanMvb3B0aW9uaXplLmpzJztcbmltcG9ydCBQaGV0aW9PYmplY3QsIHsgUGhldGlvT2JqZWN0T3B0aW9ucyB9IGZyb20gJy4uLy4uL3RhbmRlbS9qcy9QaGV0aW9PYmplY3QuanMnO1xuaW1wb3J0IElPVHlwZSBmcm9tICcuLi8uLi90YW5kZW0vanMvdHlwZXMvSU9UeXBlLmpzJztcbmltcG9ydCBOdWxsYWJsZUlPIGZyb20gJy4uLy4uL3RhbmRlbS9qcy90eXBlcy9OdWxsYWJsZUlPLmpzJztcbmltcG9ydCBOdW1iZXJJTyBmcm9tICcuLi8uLi90YW5kZW0vanMvdHlwZXMvTnVtYmVySU8uanMnO1xuaW1wb3J0IE9ySU8gZnJvbSAnLi4vLi4vdGFuZGVtL2pzL3R5cGVzL09ySU8uanMnO1xuaW1wb3J0IFN0cmluZ0lPIGZyb20gJy4uLy4uL3RhbmRlbS9qcy90eXBlcy9TdHJpbmdJTy5qcyc7XG5pbXBvcnQgeyBSZXNvbHZlZFJlc3BvbnNlIH0gZnJvbSAnLi9SZXNwb25zZVBhY2tldC5qcyc7XG5pbXBvcnQgVXR0ZXJhbmNlIGZyb20gJy4vVXR0ZXJhbmNlLmpzJztcbmltcG9ydCB1dHRlcmFuY2VRdWV1ZU5hbWVzcGFjZSBmcm9tICcuL3V0dGVyYW5jZVF1ZXVlTmFtZXNwYWNlLmpzJztcblxudHlwZSBTZWxmT3B0aW9ucyA9IHtcbiAgcmVzcGVjdFJlc3BvbnNlQ29sbGVjdG9yUHJvcGVydGllcz86IGJvb2xlYW47XG59O1xuXG4vLyBPcHRpb25zIGZvciB0aGUgYW5ub3VuY2UgbWV0aG9kXG5leHBvcnQgdHlwZSBBbm5vdW5jZXJBbm5vdW5jZU9wdGlvbnMgPSBFbXB0eVNlbGZPcHRpb25zO1xuXG5leHBvcnQgdHlwZSBBbm5vdW5jZXJPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBQaGV0aW9PYmplY3RPcHRpb25zO1xuXG5hYnN0cmFjdCBjbGFzcyBBbm5vdW5jZXIgZXh0ZW5kcyBQaGV0aW9PYmplY3Qge1xuXG4gIC8vIFdoZW4gYW4gVXR0ZXJhbmNlIHRvIGJlIGFubm91bmNlZCBwcm92aWRlZCBhbiBhbGVydCBpbiBgUmVzcG9uc2VQYWNrZXRgLWZvcm0sIHdoZXRoZXIgb3JcbiAgLy8gbm90IHRvIGxpc3RlbiB0byB0aGUgY3VycmVudCB2YWx1ZXMgb2YgcmVzcG9uc2VDb2xsZWN0b3IgUHJvcGVydGllcywgb3IgdG8ganVzdCBjb21iaW5lIGFsbCBwaWVjZXMgb2YgaXQgbm8gbWF0dGVyLlxuICBwdWJsaWMgcmVhZG9ubHkgcmVzcGVjdFJlc3BvbnNlQ29sbGVjdG9yUHJvcGVydGllczogYm9vbGVhbjtcblxuICAvLyBBIGZsYWcgdGhhdCBpbmRpY2F0ZXMgdG8gYW4gVXR0ZXJhbmNlUXVldWUgdGhhdCB0aGlzIEFubm91bmNlciBpcyByZWFkeSB0byBzcGVhayB0aGUgbmV4dCBVdHRlcmFuY2UuXG4gIHB1YmxpYyByZWFkeVRvQW5ub3VuY2UgPSB0cnVlO1xuXG4gIC8vIEEgZmxhZyB0aGF0IGluZGljYXRlcyB3aGV0aGVyIHRoaXMgYW5ub3VuY2VyIGhhcyBzdWNjZXNzZnVsbHkgc3Bva2VuIGF0IGxlYXN0IG9uY2UuXG4gIHB1YmxpYyBoYXNTcG9rZW4gPSBmYWxzZTtcblxuICAvLyBFbWl0cyBhbiBldmVudCB3aGVuIHRoaXMgQW5ub3VuY2VyIGlzIGZpbmlzaGVkIHdpdGggYW4gVXR0ZXJhbmNlLiBJdCBpcyB1cFxuICAvLyB0byB0aGUgQW5ub3VuY2VyIHN1YmNsYXNzIHRvIGVtaXQgdGhpcyBiZWNhdXNlIGRpZmZlcmVudCBzcGVlY2ggdGVjaG5vbG9naWVzIG1heSBoYXZlIGRpZmZlcmVudCBBUElzXG4gIC8vIHRvIGRldGVybWluZSB3aGVuIHNwZWFraW5nIGlzIGZpbmlzaGVkLlxuICBwdWJsaWMgcmVhZG9ubHkgYW5ub3VuY2VtZW50Q29tcGxldGVFbWl0dGVyOiBURW1pdHRlcjxbIFV0dGVyYW5jZSwgUmVzb2x2ZWRSZXNwb25zZSBdPjtcblxuICBwdWJsaWMgY29uc3RydWN0b3IoIHByb3ZpZGVkT3B0aW9ucz86IEFubm91bmNlck9wdGlvbnMgKSB7XG4gICAgY29uc3Qgb3B0aW9ucyA9IG9wdGlvbml6ZTxBbm5vdW5jZXJPcHRpb25zLCBTZWxmT3B0aW9ucywgUGhldGlvT2JqZWN0T3B0aW9ucz4oKSgge1xuICAgICAgcmVzcGVjdFJlc3BvbnNlQ29sbGVjdG9yUHJvcGVydGllczogdHJ1ZSxcbiAgICAgIHBoZXRpb1R5cGU6IEFubm91bmNlci5Bbm5vdW5jZXJJTyxcbiAgICAgIHBoZXRpb1N0YXRlOiBmYWxzZVxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xuXG4gICAgc3VwZXIoIG9wdGlvbnMgKTtcblxuICAgIHRoaXMucmVzcGVjdFJlc3BvbnNlQ29sbGVjdG9yUHJvcGVydGllcyA9IG9wdGlvbnMucmVzcGVjdFJlc3BvbnNlQ29sbGVjdG9yUHJvcGVydGllcztcblxuICAgIHRoaXMuYW5ub3VuY2VtZW50Q29tcGxldGVFbWl0dGVyID0gbmV3IEVtaXR0ZXIoIHtcbiAgICAgIHBhcmFtZXRlcnM6IFsge1xuICAgICAgICBuYW1lOiAndXR0ZXJhbmNlJywgcGhldGlvVHlwZTogVXR0ZXJhbmNlLlV0dGVyYW5jZUlPXG4gICAgICB9LCB7XG4gICAgICAgIG5hbWU6ICd0ZXh0JyxcbiAgICAgICAgcGhldGlvVHlwZTogTnVsbGFibGVJTyggT3JJTyggWyBTdHJpbmdJTywgTnVtYmVySU8gXSApIClcbiAgICAgIH0gXSxcbiAgICAgIHRhbmRlbTogb3B0aW9ucy50YW5kZW0/LmNyZWF0ZVRhbmRlbSggJ2Fubm91bmNlbWVudENvbXBsZXRlRW1pdHRlcicgKSxcbiAgICAgIHBoZXRpb1JlYWRPbmx5OiB0cnVlLFxuICAgICAgcGhldGlvRG9jdW1lbnRhdGlvbjogJ1RoZSBhbm5vdW5jZW1lbnQgdGhhdCBoYXMganVzdCBjb21wbGV0ZWQuIFRoZSBVdHRlcmFuY2UgdGV4dCBjb3VsZCBwb3RlbnRpYWxseSBkaWZmZXIgZnJvbSAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICd0aGUgZXhhY3QgdGV4dCB0aGF0IHdhcyBhbm5vdW5jZWQsIHNvIGJvdGggYXJlIGVtaXR0ZWQuIFVzZSBgdGV4dGAgZm9yIGFuIGV4YWN0IG1hdGNoIG9mIHdoYXQgd2FzIGFubm91bmNlZC4nXG4gICAgfSApO1xuICB9XG5cbiAgLyoqXG4gICAqIEFubm91bmNlIGFuIGFsZXJ0LCBzZXR0aW5nIHRleHRDb250ZW50IHRvIGFuIGFyaWEtbGl2ZSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0gYW5ub3VuY2VUZXh0IC0gVGhlIHN0cmluZyB0aGF0IHdhcyBmb3JtdWxhdGVkIGZyb20gdGhlIHV0dGVyYW5jZVxuICAgKiBAcGFyYW0gdXR0ZXJhbmNlIC0gVXR0ZXJhbmNlIHdpdGggY29udGVudCB0byBhbm5vdW5jZVxuICAgKiBAcGFyYW0gW3Byb3ZpZGVkT3B0aW9uc10gLSBzcGVjaWZ5IHN1cHBvcnQgZm9yIG9wdGlvbnMgcGFydGljdWxhciB0byB0aGlzIGFubm91bmNlcidzIGZlYXR1cmVzLlxuICAgKi9cbiAgcHVibGljIGFic3RyYWN0IGFubm91bmNlKCBhbm5vdW5jZVRleHQ6IFJlc29sdmVkUmVzcG9uc2UsIHV0dGVyYW5jZTogVXR0ZXJhbmNlLCBwcm92aWRlZE9wdGlvbnM/OiBBbm5vdW5jZXJBbm5vdW5jZU9wdGlvbnMgKTogdm9pZDtcblxuICAvKipcbiAgICogQ2FuY2VsIGFubm91bmNlbWVudCBpZiB0aGlzIEFubm91bmNlciBpcyBjdXJyZW50bHkgYW5ub3VuY2luZyB0aGUgVXR0ZXJhbmNlLiBEb2VzIG5vdGhpbmdcbiAgICogdG8gcXVldWVkIFV0dGVyYW5jZXMuIFRoZSBhbm5vdW5jZXIgbmVlZHMgdG8gaW1wbGVtZW50IGNhbmNlbGxhdGlvbiBvZiBzcGVlY2guXG4gICAqL1xuICBwdWJsaWMgYWJzdHJhY3QgY2FuY2VsVXR0ZXJhbmNlKCB1dHRlcmFuY2U6IFV0dGVyYW5jZSApOiB2b2lkO1xuXG4gIC8qKlxuICAg4oCZICAgKiBDYW5jZWwgYW5ub3VuY2VtZW50IG9mIGFueSBVdHRlcmFuY2UgdGhhdCBpcyBiZWluZyBzcG9rZW4uIFRoZSBhbm5vdW5jZXIgbmVlZHMgdG8gaW1wbGVtZW50IGNhbmNlbGxhdGlvbiBvZiBzcGVlY2guXG4gICAqL1xuICBwdWJsaWMgYWJzdHJhY3QgY2FuY2VsKCk6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBpZiBvbmUgdXR0ZXJhbmNlIHNob3VsZCBjYW5jZWwgYW5vdGhlci4gRGVmYXVsdCBiZWhhdmlvciBmb3IgdGhpcyBzdXBlcmNsYXNzIGlzIHRvIGNhbmNlbCB3aGVuXG4gICAqIHRoZSBuZXcgVXR0ZXJhbmNlIGlzIG9mIGhpZ2hlciBwcmlvcml0eS4gQnV0IHN1YmNsYXNzZXMgbWF5IHJlLWltcGxlbWVudCB0aGlzIGZ1bmN0aW9uIGlmIGl0IGhhcyBzcGVjaWFsIGxvZ2ljXG4gICAqIG9yIGFubm91bmNlck9wdGlvbnMgdGhhdCBvdmVycmlkZSB0aGlzIGJlaGF2aW9yLlxuICAgKi9cbiAgcHVibGljIHNob3VsZFV0dGVyYW5jZUNhbmNlbE90aGVyKCB1dHRlcmFuY2U6IFV0dGVyYW5jZSwgdXR0ZXJhbmNlVG9DYW5jZWw6IFV0dGVyYW5jZSApOiBib29sZWFuIHtcbiAgICByZXR1cm4gdXR0ZXJhbmNlVG9DYW5jZWwucHJpb3JpdHlQcm9wZXJ0eS52YWx1ZSA8IHV0dGVyYW5jZS5wcmlvcml0eVByb3BlcnR5LnZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEludGVuZGVkIHRvIGJlIG92ZXJyaWRkZW4gYnkgc3VidHlwZXMgaWYgbmVjZXNzYXJ5IGFzIGEgd2F5IHRvIG9yZGVyIHRoZSBxdWV1ZSBpZiB0aGVyZSBpcyBhbm5vdW5jZXJcbiAgICogc3BlY2lmaWMgbG9naWMuXG4gICAqL1xuICBwdWJsaWMgb25VdHRlcmFuY2VQcmlvcml0eUNoYW5nZSggdXR0ZXJhbmNlOiBVdHRlcmFuY2UgKTogdm9pZCB7XG4gICAgLy8gU2VlIHN1YmNsYXNzIGZvciBpbXBsZW1lbnRhdGlvblxuICB9XG5cbiAgcHVibGljIHN0YXRpYyBBbm5vdW5jZXJJTyA9IG5ldyBJT1R5cGUoICdBbm5vdW5jZXJJTycsIHtcbiAgICB2YWx1ZVR5cGU6IEFubm91bmNlcixcbiAgICBkb2N1bWVudGF0aW9uOiAnQW5ub3VuY2VzIHRleHQgdG8gYSBzcGVjaWZpYyBicm93c2VyIHRlY2hub2xvZ3kgKGxpa2UgYXJpYS1saXZlIG9yIHdlYiBzcGVlY2gpJ1xuICB9ICk7XG59XG5cbnV0dGVyYW5jZVF1ZXVlTmFtZXNwYWNlLnJlZ2lzdGVyKCAnQW5ub3VuY2VyJywgQW5ub3VuY2VyICk7XG5leHBvcnQgZGVmYXVsdCBBbm5vdW5jZXI7Il0sIm5hbWVzIjpbIkVtaXR0ZXIiLCJvcHRpb25pemUiLCJQaGV0aW9PYmplY3QiLCJJT1R5cGUiLCJOdWxsYWJsZUlPIiwiTnVtYmVySU8iLCJPcklPIiwiU3RyaW5nSU8iLCJVdHRlcmFuY2UiLCJ1dHRlcmFuY2VRdWV1ZU5hbWVzcGFjZSIsIkFubm91bmNlciIsInNob3VsZFV0dGVyYW5jZUNhbmNlbE90aGVyIiwidXR0ZXJhbmNlIiwidXR0ZXJhbmNlVG9DYW5jZWwiLCJwcmlvcml0eVByb3BlcnR5IiwidmFsdWUiLCJvblV0dGVyYW5jZVByaW9yaXR5Q2hhbmdlIiwicHJvdmlkZWRPcHRpb25zIiwib3B0aW9ucyIsInJlc3BlY3RSZXNwb25zZUNvbGxlY3RvclByb3BlcnRpZXMiLCJwaGV0aW9UeXBlIiwiQW5ub3VuY2VySU8iLCJwaGV0aW9TdGF0ZSIsInJlYWR5VG9Bbm5vdW5jZSIsImhhc1Nwb2tlbiIsImFubm91bmNlbWVudENvbXBsZXRlRW1pdHRlciIsInBhcmFtZXRlcnMiLCJuYW1lIiwiVXR0ZXJhbmNlSU8iLCJ0YW5kZW0iLCJjcmVhdGVUYW5kZW0iLCJwaGV0aW9SZWFkT25seSIsInBoZXRpb0RvY3VtZW50YXRpb24iLCJ2YWx1ZVR5cGUiLCJkb2N1bWVudGF0aW9uIiwicmVnaXN0ZXIiXSwibWFwcGluZ3MiOiJBQUFBLHNEQUFzRDtBQUV0RDs7OztDQUlDLEdBRUQsT0FBT0EsYUFBYSwyQkFBMkI7QUFFL0MsT0FBT0MsZUFBcUMsa0NBQWtDO0FBQzlFLE9BQU9DLGtCQUEyQyxrQ0FBa0M7QUFDcEYsT0FBT0MsWUFBWSxrQ0FBa0M7QUFDckQsT0FBT0MsZ0JBQWdCLHNDQUFzQztBQUM3RCxPQUFPQyxjQUFjLG9DQUFvQztBQUN6RCxPQUFPQyxVQUFVLGdDQUFnQztBQUNqRCxPQUFPQyxjQUFjLG9DQUFvQztBQUV6RCxPQUFPQyxlQUFlLGlCQUFpQjtBQUN2QyxPQUFPQyw2QkFBNkIsK0JBQStCO0FBV25FLElBQUEsQUFBZUMsWUFBZixNQUFlQSxrQkFBa0JSO0lBOEQvQjs7OztHQUlDLEdBQ0QsQUFBT1MsMkJBQTRCQyxTQUFvQixFQUFFQyxpQkFBNEIsRUFBWTtRQUMvRixPQUFPQSxrQkFBa0JDLGdCQUFnQixDQUFDQyxLQUFLLEdBQUdILFVBQVVFLGdCQUFnQixDQUFDQyxLQUFLO0lBQ3BGO0lBRUE7OztHQUdDLEdBQ0QsQUFBT0MsMEJBQTJCSixTQUFvQixFQUFTO0lBQzdELGtDQUFrQztJQUNwQztJQTVEQSxZQUFvQkssZUFBa0MsQ0FBRztZQWtCN0NDO1FBakJWLE1BQU1BLFVBQVVqQixZQUFpRTtZQUMvRWtCLG9DQUFvQztZQUNwQ0MsWUFBWVYsVUFBVVcsV0FBVztZQUNqQ0MsYUFBYTtRQUNmLEdBQUdMO1FBRUgsS0FBSyxDQUFFQyxVQWxCVCx1R0FBdUc7YUFDaEdLLGtCQUFrQixNQUV6QixzRkFBc0Y7YUFDL0VDLFlBQVk7UUFnQmpCLElBQUksQ0FBQ0wsa0NBQWtDLEdBQUdELFFBQVFDLGtDQUFrQztRQUVwRixJQUFJLENBQUNNLDJCQUEyQixHQUFHLElBQUl6QixRQUFTO1lBQzlDMEIsWUFBWTtnQkFBRTtvQkFDWkMsTUFBTTtvQkFBYVAsWUFBWVosVUFBVW9CLFdBQVc7Z0JBQ3REO2dCQUFHO29CQUNERCxNQUFNO29CQUNOUCxZQUFZaEIsV0FBWUUsS0FBTTt3QkFBRUM7d0JBQVVGO3FCQUFVO2dCQUN0RDthQUFHO1lBQ0h3QixNQUFNLEdBQUVYLGtCQUFBQSxRQUFRVyxNQUFNLHFCQUFkWCxnQkFBZ0JZLFlBQVksQ0FBRTtZQUN0Q0MsZ0JBQWdCO1lBQ2hCQyxxQkFBcUIsZ0dBQ0E7UUFDdkI7SUFDRjtBQTJDRjtBQW5GZXRCLFVBK0VDVyxjQUFjLElBQUlsQixPQUFRLGVBQWU7SUFDckQ4QixXQUFXdkI7SUFDWHdCLGVBQWU7QUFDakI7QUFHRnpCLHdCQUF3QjBCLFFBQVEsQ0FBRSxhQUFhekI7QUFDL0MsZUFBZUEsVUFBVSJ9