// Copyright 2014-2024, University of Colorado Boulder
/**
 * A rectangle with pseudo-3D shading.
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */ import DerivedProperty from '../../axon/js/DerivedProperty.js';
import { Shape } from '../../kite/js/imports.js';
import optionize from '../../phet-core/js/optionize.js';
import { Color, LinearGradient, Node, PaintColorProperty, Path, RadialGradient, Rectangle } from '../../scenery/js/imports.js';
import sceneryPhet from './sceneryPhet.js';
let ShadedRectangle = class ShadedRectangle extends Node {
    dispose() {
        this.lighterPaintProperty.dispose();
        this.lightPaintProperty.dispose();
        this.darkPaintProperty.dispose();
        this.darkerPaintProperty.dispose();
        super.dispose();
    }
    /**
   * @param rectBounds - takes up rectBounds in size
   * @param [providedOptions]
   */ constructor(rectBounds, providedOptions){
        super();
        const options = optionize()({
            baseColor: new Color(80, 130, 230),
            lightFactor: 0.5,
            lighterFactor: 0.1,
            darkFactor: 0.5,
            darkerFactor: 0.1,
            cornerRadius: 10,
            lightSource: 'leftTop',
            lightOffset: 0.525,
            darkOffset: 0.375
        }, providedOptions);
        assert && assert(options.lightOffset < 1, 'options.lightOffset needs to be less than 1');
        assert && assert(options.darkOffset < 1, 'options.darkOffset needs to be less than 1');
        const lightFromLeft = options.lightSource.includes('left');
        const lightFromTop = options.lightSource.includes('Top');
        const cornerRadius = options.cornerRadius;
        // compute our colors (properly handle color-Property cases for baseColor)
        this.lighterPaintProperty = new PaintColorProperty(options.baseColor, {
            luminanceFactor: options.lightFactor + options.lighterFactor
        });
        this.lightPaintProperty = new PaintColorProperty(options.baseColor, {
            luminanceFactor: options.lightFactor
        });
        this.darkPaintProperty = new PaintColorProperty(options.baseColor, {
            luminanceFactor: -options.darkFactor
        });
        this.darkerPaintProperty = new PaintColorProperty(options.baseColor, {
            luminanceFactor: -options.darkFactor - options.darkerFactor
        });
        // change colors based on orientation
        const topColorProperty = lightFromTop ? this.lighterPaintProperty : this.darkerPaintProperty;
        const leftColorProperty = lightFromLeft ? this.lightPaintProperty : this.darkPaintProperty;
        const rightColorProperty = lightFromLeft ? this.darkPaintProperty : this.lightPaintProperty;
        const bottomColorProperty = lightFromTop ? this.darkerPaintProperty : this.lighterPaintProperty;
        // how far our light and dark gradients will extend into the rectangle
        const lightOffset = options.lightOffset * cornerRadius;
        const darkOffset = options.darkOffset * cornerRadius;
        // change offsets based on orientation
        const topOffset = lightFromTop ? lightOffset : darkOffset;
        const leftOffset = lightFromLeft ? lightOffset : darkOffset;
        const rightOffset = lightFromLeft ? darkOffset : lightOffset;
        const bottomOffset = lightFromTop ? darkOffset : lightOffset;
        // we layer two gradients on top of each other as the base (using the same rounded rectangle shape)
        const horizontalNode = Rectangle.roundedBounds(rectBounds, cornerRadius, cornerRadius, {
            pickable: false
        });
        const verticalNode = Rectangle.roundedBounds(rectBounds, cornerRadius, cornerRadius, {
            pickable: false
        });
        horizontalNode.fill = new LinearGradient(horizontalNode.left, 0, horizontalNode.right, 0).addColorStop(0, leftColorProperty).addColorStop(leftOffset / verticalNode.width, options.baseColor).addColorStop(1 - rightOffset / verticalNode.width, options.baseColor).addColorStop(1, rightColorProperty);
        verticalNode.fill = new LinearGradient(0, verticalNode.top, 0, verticalNode.bottom).addColorStop(0, topColorProperty).addColorStop(topOffset / verticalNode.height, new DerivedProperty([
            topColorProperty
        ], (color)=>{
            return color.withAlpha(0);
        })).addColorStop(1 - bottomOffset / verticalNode.height, new DerivedProperty([
            bottomColorProperty
        ], (color)=>{
            return color.withAlpha(0);
        })).addColorStop(1, bottomColorProperty);
        // shape of our corner (in this case, top-right)
        const cornerShape = new Shape().moveTo(0, 0).arc(0, 0, cornerRadius, -Math.PI / 2, 0, false).close();
        // rotation needed to move the cornerShape into the proper orientation as the light corner (Math.PI more for dark corner)
        const lightCornerRotation = {
            leftTop: -Math.PI / 2,
            rightTop: 0,
            rightBottom: Math.PI / 2,
            leftBottom: Math.PI
        }[options.lightSource];
        const innerBounds = rectBounds.eroded(cornerRadius);
        // since both the top and left are "lighter", we have a rounded gradient along that corner
        const lightCorner = new Path(cornerShape, {
            x: lightFromLeft ? innerBounds.minX : innerBounds.maxX,
            y: lightFromTop ? innerBounds.minY : innerBounds.maxY,
            rotation: lightCornerRotation,
            fill: new RadialGradient(0, 0, 0, 0, 0, cornerRadius).addColorStop(0, options.baseColor).addColorStop(1 - lightOffset / cornerRadius, options.baseColor).addColorStop(1, this.lighterPaintProperty),
            pickable: false
        });
        // since both the bottom and right are "darker", we have a rounded gradient along that corner
        const darkCorner = new Path(cornerShape, {
            x: lightFromLeft ? innerBounds.maxX : innerBounds.minX,
            y: lightFromTop ? innerBounds.maxY : innerBounds.minY,
            rotation: lightCornerRotation + Math.PI,
            fill: new RadialGradient(0, 0, 0, 0, 0, cornerRadius).addColorStop(0, options.baseColor).addColorStop(1 - darkOffset / cornerRadius, options.baseColor).addColorStop(1, this.darkerPaintProperty),
            pickable: false
        });
        // the stroke around the outside
        const panelStroke = Rectangle.roundedBounds(rectBounds, cornerRadius, cornerRadius, {
            stroke: new DerivedProperty([
                rightColorProperty
            ], (color)=>{
                return color.withAlpha(0.4);
            })
        });
        // layout
        this.addChild(horizontalNode);
        this.addChild(verticalNode);
        this.addChild(lightCorner);
        this.addChild(darkCorner);
        this.addChild(panelStroke); // NOTE: this is the pickable child used for hit testing. Ensure something is pickable.
        this.mutate(options);
    }
};
export { ShadedRectangle as default };
sceneryPhet.register('ShadedRectangle', ShadedRectangle);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NjZW5lcnktcGhldC9qcy9TaGFkZWRSZWN0YW5nbGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTQtMjAyNCwgVW5pdmVyc2l0eSBvZiBDb2xvcmFkbyBCb3VsZGVyXG5cbi8qKlxuICogQSByZWN0YW5nbGUgd2l0aCBwc2V1ZG8tM0Qgc2hhZGluZy5cbiAqXG4gKiBAYXV0aG9yIEpvbmF0aGFuIE9sc29uIDxqb25hdGhhbi5vbHNvbkBjb2xvcmFkby5lZHU+XG4gKi9cblxuaW1wb3J0IERlcml2ZWRQcm9wZXJ0eSBmcm9tICcuLi8uLi9heG9uL2pzL0Rlcml2ZWRQcm9wZXJ0eS5qcyc7XG5pbXBvcnQgQm91bmRzMiBmcm9tICcuLi8uLi9kb3QvanMvQm91bmRzMi5qcyc7XG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gJy4uLy4uL2tpdGUvanMvaW1wb3J0cy5qcyc7XG5pbXBvcnQgb3B0aW9uaXplIGZyb20gJy4uLy4uL3BoZXQtY29yZS9qcy9vcHRpb25pemUuanMnO1xuaW1wb3J0IHsgQ29sb3IsIExpbmVhckdyYWRpZW50LCBOb2RlLCBOb2RlT3B0aW9ucywgUGFpbnRDb2xvclByb3BlcnR5LCBQYXRoLCBSYWRpYWxHcmFkaWVudCwgUmVjdGFuZ2xlLCBUQ29sb3IgfSBmcm9tICcuLi8uLi9zY2VuZXJ5L2pzL2ltcG9ydHMuanMnO1xuaW1wb3J0IHNjZW5lcnlQaGV0IGZyb20gJy4vc2NlbmVyeVBoZXQuanMnO1xuXG50eXBlIExpZ2h0U291cmNlID0gJ2xlZnRUb3AnIHwgJ3JpZ2h0VG9wJyB8ICdsZWZ0Qm90dG9tJyB8ICdyaWdodEJvdHRvbSc7XG5cbnR5cGUgU2VsZk9wdGlvbnMgPSB7XG4gIGJhc2VDb2xvcj86IFRDb2xvcjtcbiAgbGlnaHRGYWN0b3I/OiBudW1iZXI7IC8vIGhvdyBtdWNoIGxpZ2h0ZXIgdGhlIFwibGlnaHRcIiBwYXJ0cyAodG9wIGFuZCBsZWZ0KSBhcmVcbiAgbGlnaHRlckZhY3Rvcj86IG51bWJlcjsgLy8gaG93IG11Y2ggbGlnaHRlciBpcyB0aGUgdG9wIHRoYW4gdGhlIGxlZnRcbiAgZGFya0ZhY3Rvcj86IG51bWJlcjsgLy8gaG93IG11Y2ggZGFya2VyIHRoZSBcImRhcmtcIiBwYXJ0cyAoYm90dG9tIGFuZCByaWdodCkgYXJlXG4gIGRhcmtlckZhY3Rvcj86IG51bWJlcjsgLy8gaG93IG11Y2ggZGFya2VyIHRoZSBib3R0b20gaXMgdGhhbiB0aGUgcmlnaHRcbiAgY29ybmVyUmFkaXVzPzogbnVtYmVyOyAvLyB0aGUgcmFkaXVzIG9mIGN1cnZhdHVyZSBhdCB0aGUgY29ybmVycyAoYWxzbyBkZXRlcm1pbmVzIHRoZSBzaXplIG9mIHRoZSBmYXV4LTNEIHNoYWRpbmcpXG4gIGxpZ2h0U291cmNlPzogTGlnaHRTb3VyY2U7IC8vIHJlbGF0aXZlIHBvc2l0aW9uIG9mIHRoZSBsaWdodCBzb3VyY2VcblxuICAvLyBXaGF0IGZyYWN0aW9uIG9mIHRoZSBjb3JuZXJSYWRpdXMgc2hvdWxkIHRoZSBsaWdodCBhbmQgZGFyayBncmFkaWVudHMgZXh0ZW5kIGludG8gdGhlIHJlY3RhbmdsZT9cbiAgLy8gU2hvdWxkIGFsd2F5cyBiZSBsZXNzIHRoYW4gMS5cbiAgbGlnaHRPZmZzZXQ/OiBudW1iZXI7XG4gIGRhcmtPZmZzZXQ/OiBudW1iZXI7XG59O1xuXG5leHBvcnQgdHlwZSBTaGFkZWRSZWN0YW5nbGVPcHRpb25zID0gU2VsZk9wdGlvbnMgJiBOb2RlT3B0aW9ucztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2hhZGVkUmVjdGFuZ2xlIGV4dGVuZHMgTm9kZSB7XG5cbiAgcHJpdmF0ZSByZWFkb25seSBsaWdodGVyUGFpbnRQcm9wZXJ0eTogUGFpbnRDb2xvclByb3BlcnR5O1xuICBwcml2YXRlIHJlYWRvbmx5IGxpZ2h0UGFpbnRQcm9wZXJ0eTogUGFpbnRDb2xvclByb3BlcnR5O1xuICBwcml2YXRlIHJlYWRvbmx5IGRhcmtQYWludFByb3BlcnR5OiBQYWludENvbG9yUHJvcGVydHk7XG4gIHByaXZhdGUgcmVhZG9ubHkgZGFya2VyUGFpbnRQcm9wZXJ0eTogUGFpbnRDb2xvclByb3BlcnR5O1xuXG4gIC8qKlxuICAgKiBAcGFyYW0gcmVjdEJvdW5kcyAtIHRha2VzIHVwIHJlY3RCb3VuZHMgaW4gc2l6ZVxuICAgKiBAcGFyYW0gW3Byb3ZpZGVkT3B0aW9uc11cbiAgICovXG4gIHB1YmxpYyBjb25zdHJ1Y3RvciggcmVjdEJvdW5kczogQm91bmRzMiwgcHJvdmlkZWRPcHRpb25zPzogU2hhZGVkUmVjdGFuZ2xlT3B0aW9ucyApIHtcblxuICAgIHN1cGVyKCk7XG5cbiAgICBjb25zdCBvcHRpb25zID0gb3B0aW9uaXplPFNoYWRlZFJlY3RhbmdsZU9wdGlvbnMsIFNlbGZPcHRpb25zLCBOb2RlT3B0aW9ucz4oKSgge1xuICAgICAgYmFzZUNvbG9yOiBuZXcgQ29sb3IoIDgwLCAxMzAsIDIzMCApLFxuICAgICAgbGlnaHRGYWN0b3I6IDAuNSxcbiAgICAgIGxpZ2h0ZXJGYWN0b3I6IDAuMSxcbiAgICAgIGRhcmtGYWN0b3I6IDAuNSxcbiAgICAgIGRhcmtlckZhY3RvcjogMC4xLFxuICAgICAgY29ybmVyUmFkaXVzOiAxMCxcbiAgICAgIGxpZ2h0U291cmNlOiAnbGVmdFRvcCcsXG4gICAgICBsaWdodE9mZnNldDogMC41MjUsXG4gICAgICBkYXJrT2Zmc2V0OiAwLjM3NVxuICAgIH0sIHByb3ZpZGVkT3B0aW9ucyApO1xuXG4gICAgYXNzZXJ0ICYmIGFzc2VydCggb3B0aW9ucy5saWdodE9mZnNldCA8IDEsICdvcHRpb25zLmxpZ2h0T2Zmc2V0IG5lZWRzIHRvIGJlIGxlc3MgdGhhbiAxJyApO1xuICAgIGFzc2VydCAmJiBhc3NlcnQoIG9wdGlvbnMuZGFya09mZnNldCA8IDEsICdvcHRpb25zLmRhcmtPZmZzZXQgbmVlZHMgdG8gYmUgbGVzcyB0aGFuIDEnICk7XG5cbiAgICBjb25zdCBsaWdodEZyb21MZWZ0ID0gb3B0aW9ucy5saWdodFNvdXJjZS5pbmNsdWRlcyggJ2xlZnQnICk7XG4gICAgY29uc3QgbGlnaHRGcm9tVG9wID0gb3B0aW9ucy5saWdodFNvdXJjZS5pbmNsdWRlcyggJ1RvcCcgKTtcblxuICAgIGNvbnN0IGNvcm5lclJhZGl1cyA9IG9wdGlvbnMuY29ybmVyUmFkaXVzO1xuXG4gICAgLy8gY29tcHV0ZSBvdXIgY29sb3JzIChwcm9wZXJseSBoYW5kbGUgY29sb3ItUHJvcGVydHkgY2FzZXMgZm9yIGJhc2VDb2xvcilcbiAgICB0aGlzLmxpZ2h0ZXJQYWludFByb3BlcnR5ID0gbmV3IFBhaW50Q29sb3JQcm9wZXJ0eSggb3B0aW9ucy5iYXNlQ29sb3IsIHsgbHVtaW5hbmNlRmFjdG9yOiBvcHRpb25zLmxpZ2h0RmFjdG9yICsgb3B0aW9ucy5saWdodGVyRmFjdG9yIH0gKTtcbiAgICB0aGlzLmxpZ2h0UGFpbnRQcm9wZXJ0eSA9IG5ldyBQYWludENvbG9yUHJvcGVydHkoIG9wdGlvbnMuYmFzZUNvbG9yLCB7IGx1bWluYW5jZUZhY3Rvcjogb3B0aW9ucy5saWdodEZhY3RvciB9ICk7XG4gICAgdGhpcy5kYXJrUGFpbnRQcm9wZXJ0eSA9IG5ldyBQYWludENvbG9yUHJvcGVydHkoIG9wdGlvbnMuYmFzZUNvbG9yLCB7IGx1bWluYW5jZUZhY3RvcjogLW9wdGlvbnMuZGFya0ZhY3RvciB9ICk7XG4gICAgdGhpcy5kYXJrZXJQYWludFByb3BlcnR5ID0gbmV3IFBhaW50Q29sb3JQcm9wZXJ0eSggb3B0aW9ucy5iYXNlQ29sb3IsIHsgbHVtaW5hbmNlRmFjdG9yOiAtb3B0aW9ucy5kYXJrRmFjdG9yIC0gb3B0aW9ucy5kYXJrZXJGYWN0b3IgfSApO1xuXG4gICAgLy8gY2hhbmdlIGNvbG9ycyBiYXNlZCBvbiBvcmllbnRhdGlvblxuICAgIGNvbnN0IHRvcENvbG9yUHJvcGVydHkgPSBsaWdodEZyb21Ub3AgPyB0aGlzLmxpZ2h0ZXJQYWludFByb3BlcnR5IDogdGhpcy5kYXJrZXJQYWludFByb3BlcnR5O1xuICAgIGNvbnN0IGxlZnRDb2xvclByb3BlcnR5ID0gbGlnaHRGcm9tTGVmdCA/IHRoaXMubGlnaHRQYWludFByb3BlcnR5IDogdGhpcy5kYXJrUGFpbnRQcm9wZXJ0eTtcbiAgICBjb25zdCByaWdodENvbG9yUHJvcGVydHkgPSBsaWdodEZyb21MZWZ0ID8gdGhpcy5kYXJrUGFpbnRQcm9wZXJ0eSA6IHRoaXMubGlnaHRQYWludFByb3BlcnR5O1xuICAgIGNvbnN0IGJvdHRvbUNvbG9yUHJvcGVydHkgPSBsaWdodEZyb21Ub3AgPyB0aGlzLmRhcmtlclBhaW50UHJvcGVydHkgOiB0aGlzLmxpZ2h0ZXJQYWludFByb3BlcnR5O1xuXG4gICAgLy8gaG93IGZhciBvdXIgbGlnaHQgYW5kIGRhcmsgZ3JhZGllbnRzIHdpbGwgZXh0ZW5kIGludG8gdGhlIHJlY3RhbmdsZVxuICAgIGNvbnN0IGxpZ2h0T2Zmc2V0ID0gb3B0aW9ucy5saWdodE9mZnNldCAqIGNvcm5lclJhZGl1cztcbiAgICBjb25zdCBkYXJrT2Zmc2V0ID0gb3B0aW9ucy5kYXJrT2Zmc2V0ICogY29ybmVyUmFkaXVzO1xuXG4gICAgLy8gY2hhbmdlIG9mZnNldHMgYmFzZWQgb24gb3JpZW50YXRpb25cbiAgICBjb25zdCB0b3BPZmZzZXQgPSBsaWdodEZyb21Ub3AgPyBsaWdodE9mZnNldCA6IGRhcmtPZmZzZXQ7XG4gICAgY29uc3QgbGVmdE9mZnNldCA9IGxpZ2h0RnJvbUxlZnQgPyBsaWdodE9mZnNldCA6IGRhcmtPZmZzZXQ7XG4gICAgY29uc3QgcmlnaHRPZmZzZXQgPSBsaWdodEZyb21MZWZ0ID8gZGFya09mZnNldCA6IGxpZ2h0T2Zmc2V0O1xuICAgIGNvbnN0IGJvdHRvbU9mZnNldCA9IGxpZ2h0RnJvbVRvcCA/IGRhcmtPZmZzZXQgOiBsaWdodE9mZnNldDtcblxuICAgIC8vIHdlIGxheWVyIHR3byBncmFkaWVudHMgb24gdG9wIG9mIGVhY2ggb3RoZXIgYXMgdGhlIGJhc2UgKHVzaW5nIHRoZSBzYW1lIHJvdW5kZWQgcmVjdGFuZ2xlIHNoYXBlKVxuICAgIGNvbnN0IGhvcml6b250YWxOb2RlID0gUmVjdGFuZ2xlLnJvdW5kZWRCb3VuZHMoIHJlY3RCb3VuZHMsIGNvcm5lclJhZGl1cywgY29ybmVyUmFkaXVzLCB7IHBpY2thYmxlOiBmYWxzZSB9ICk7XG4gICAgY29uc3QgdmVydGljYWxOb2RlID0gUmVjdGFuZ2xlLnJvdW5kZWRCb3VuZHMoIHJlY3RCb3VuZHMsIGNvcm5lclJhZGl1cywgY29ybmVyUmFkaXVzLCB7IHBpY2thYmxlOiBmYWxzZSB9ICk7XG5cbiAgICBob3Jpem9udGFsTm9kZS5maWxsID0gbmV3IExpbmVhckdyYWRpZW50KCBob3Jpem9udGFsTm9kZS5sZWZ0LCAwLCBob3Jpem9udGFsTm9kZS5yaWdodCwgMCApXG4gICAgICAuYWRkQ29sb3JTdG9wKCAwLCBsZWZ0Q29sb3JQcm9wZXJ0eSApXG4gICAgICAuYWRkQ29sb3JTdG9wKCBsZWZ0T2Zmc2V0IC8gdmVydGljYWxOb2RlLndpZHRoLCBvcHRpb25zLmJhc2VDb2xvciApXG4gICAgICAuYWRkQ29sb3JTdG9wKCAxIC0gcmlnaHRPZmZzZXQgLyB2ZXJ0aWNhbE5vZGUud2lkdGgsIG9wdGlvbnMuYmFzZUNvbG9yIClcbiAgICAgIC5hZGRDb2xvclN0b3AoIDEsIHJpZ2h0Q29sb3JQcm9wZXJ0eSApO1xuXG4gICAgdmVydGljYWxOb2RlLmZpbGwgPSBuZXcgTGluZWFyR3JhZGllbnQoIDAsIHZlcnRpY2FsTm9kZS50b3AsIDAsIHZlcnRpY2FsTm9kZS5ib3R0b20gKVxuICAgICAgLmFkZENvbG9yU3RvcCggMCwgdG9wQ29sb3JQcm9wZXJ0eSApXG4gICAgICAuYWRkQ29sb3JTdG9wKCB0b3BPZmZzZXQgLyB2ZXJ0aWNhbE5vZGUuaGVpZ2h0LCBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHRvcENvbG9yUHJvcGVydHkgXSwgKCBjb2xvciA9PiB7XG4gICAgICAgIHJldHVybiBjb2xvci53aXRoQWxwaGEoIDAgKTtcbiAgICAgIH0gKSApIClcbiAgICAgIC5hZGRDb2xvclN0b3AoIDEgLSBib3R0b21PZmZzZXQgLyB2ZXJ0aWNhbE5vZGUuaGVpZ2h0LCBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIGJvdHRvbUNvbG9yUHJvcGVydHkgXSwgKCBjb2xvciA9PiB7XG4gICAgICAgIHJldHVybiBjb2xvci53aXRoQWxwaGEoIDAgKTtcbiAgICAgIH0gKSApIClcbiAgICAgIC5hZGRDb2xvclN0b3AoIDEsIGJvdHRvbUNvbG9yUHJvcGVydHkgKTtcblxuICAgIC8vIHNoYXBlIG9mIG91ciBjb3JuZXIgKGluIHRoaXMgY2FzZSwgdG9wLXJpZ2h0KVxuICAgIGNvbnN0IGNvcm5lclNoYXBlID0gbmV3IFNoYXBlKCkubW92ZVRvKCAwLCAwIClcbiAgICAgIC5hcmMoIDAsIDAsIGNvcm5lclJhZGl1cywgLU1hdGguUEkgLyAyLCAwLCBmYWxzZSApXG4gICAgICAuY2xvc2UoKTtcbiAgICAvLyByb3RhdGlvbiBuZWVkZWQgdG8gbW92ZSB0aGUgY29ybmVyU2hhcGUgaW50byB0aGUgcHJvcGVyIG9yaWVudGF0aW9uIGFzIHRoZSBsaWdodCBjb3JuZXIgKE1hdGguUEkgbW9yZSBmb3IgZGFyayBjb3JuZXIpXG4gICAgY29uc3QgbGlnaHRDb3JuZXJSb3RhdGlvbiA9IHtcbiAgICAgIGxlZnRUb3A6IC1NYXRoLlBJIC8gMixcbiAgICAgIHJpZ2h0VG9wOiAwLFxuICAgICAgcmlnaHRCb3R0b206IE1hdGguUEkgLyAyLFxuICAgICAgbGVmdEJvdHRvbTogTWF0aC5QSVxuICAgIH1bIG9wdGlvbnMubGlnaHRTb3VyY2UgXTtcblxuICAgIGNvbnN0IGlubmVyQm91bmRzID0gcmVjdEJvdW5kcy5lcm9kZWQoIGNvcm5lclJhZGl1cyApO1xuXG4gICAgLy8gc2luY2UgYm90aCB0aGUgdG9wIGFuZCBsZWZ0IGFyZSBcImxpZ2h0ZXJcIiwgd2UgaGF2ZSBhIHJvdW5kZWQgZ3JhZGllbnQgYWxvbmcgdGhhdCBjb3JuZXJcbiAgICBjb25zdCBsaWdodENvcm5lciA9IG5ldyBQYXRoKCBjb3JuZXJTaGFwZSwge1xuICAgICAgeDogbGlnaHRGcm9tTGVmdCA/IGlubmVyQm91bmRzLm1pblggOiBpbm5lckJvdW5kcy5tYXhYLFxuICAgICAgeTogbGlnaHRGcm9tVG9wID8gaW5uZXJCb3VuZHMubWluWSA6IGlubmVyQm91bmRzLm1heFksXG4gICAgICByb3RhdGlvbjogbGlnaHRDb3JuZXJSb3RhdGlvbixcbiAgICAgIGZpbGw6IG5ldyBSYWRpYWxHcmFkaWVudCggMCwgMCwgMCwgMCwgMCwgY29ybmVyUmFkaXVzIClcbiAgICAgICAgLmFkZENvbG9yU3RvcCggMCwgb3B0aW9ucy5iYXNlQ29sb3IgKVxuICAgICAgICAuYWRkQ29sb3JTdG9wKCAxIC0gbGlnaHRPZmZzZXQgLyBjb3JuZXJSYWRpdXMsIG9wdGlvbnMuYmFzZUNvbG9yIClcbiAgICAgICAgLmFkZENvbG9yU3RvcCggMSwgdGhpcy5saWdodGVyUGFpbnRQcm9wZXJ0eSApLFxuICAgICAgcGlja2FibGU6IGZhbHNlXG4gICAgfSApO1xuXG4gICAgLy8gc2luY2UgYm90aCB0aGUgYm90dG9tIGFuZCByaWdodCBhcmUgXCJkYXJrZXJcIiwgd2UgaGF2ZSBhIHJvdW5kZWQgZ3JhZGllbnQgYWxvbmcgdGhhdCBjb3JuZXJcbiAgICBjb25zdCBkYXJrQ29ybmVyID0gbmV3IFBhdGgoIGNvcm5lclNoYXBlLCB7XG4gICAgICB4OiBsaWdodEZyb21MZWZ0ID8gaW5uZXJCb3VuZHMubWF4WCA6IGlubmVyQm91bmRzLm1pblgsXG4gICAgICB5OiBsaWdodEZyb21Ub3AgPyBpbm5lckJvdW5kcy5tYXhZIDogaW5uZXJCb3VuZHMubWluWSxcbiAgICAgIHJvdGF0aW9uOiBsaWdodENvcm5lclJvdGF0aW9uICsgTWF0aC5QSSwgLy8gb3Bwb3NpdGUgZGlyZWN0aW9uIGZyb20gb3VyIGxpZ2h0IGNvcm5lclxuICAgICAgZmlsbDogbmV3IFJhZGlhbEdyYWRpZW50KCAwLCAwLCAwLCAwLCAwLCBjb3JuZXJSYWRpdXMgKVxuICAgICAgICAuYWRkQ29sb3JTdG9wKCAwLCBvcHRpb25zLmJhc2VDb2xvciApXG4gICAgICAgIC5hZGRDb2xvclN0b3AoIDEgLSBkYXJrT2Zmc2V0IC8gY29ybmVyUmFkaXVzLCBvcHRpb25zLmJhc2VDb2xvciApXG4gICAgICAgIC5hZGRDb2xvclN0b3AoIDEsIHRoaXMuZGFya2VyUGFpbnRQcm9wZXJ0eSApLFxuICAgICAgcGlja2FibGU6IGZhbHNlXG4gICAgfSApO1xuXG4gICAgLy8gdGhlIHN0cm9rZSBhcm91bmQgdGhlIG91dHNpZGVcbiAgICBjb25zdCBwYW5lbFN0cm9rZSA9IFJlY3RhbmdsZS5yb3VuZGVkQm91bmRzKCByZWN0Qm91bmRzLCBjb3JuZXJSYWRpdXMsIGNvcm5lclJhZGl1cywge1xuICAgICAgc3Ryb2tlOiBuZXcgRGVyaXZlZFByb3BlcnR5KCBbIHJpZ2h0Q29sb3JQcm9wZXJ0eSBdLCAoIGNvbG9yID0+IHtcbiAgICAgICAgcmV0dXJuIGNvbG9yLndpdGhBbHBoYSggMC40ICk7XG4gICAgICB9ICkgKVxuICAgIH0gKTtcblxuICAgIC8vIGxheW91dFxuICAgIHRoaXMuYWRkQ2hpbGQoIGhvcml6b250YWxOb2RlICk7XG4gICAgdGhpcy5hZGRDaGlsZCggdmVydGljYWxOb2RlICk7XG4gICAgdGhpcy5hZGRDaGlsZCggbGlnaHRDb3JuZXIgKTtcbiAgICB0aGlzLmFkZENoaWxkKCBkYXJrQ29ybmVyICk7XG4gICAgdGhpcy5hZGRDaGlsZCggcGFuZWxTdHJva2UgKTsgLy8gTk9URTogdGhpcyBpcyB0aGUgcGlja2FibGUgY2hpbGQgdXNlZCBmb3IgaGl0IHRlc3RpbmcuIEVuc3VyZSBzb21ldGhpbmcgaXMgcGlja2FibGUuXG5cbiAgICB0aGlzLm11dGF0ZSggb3B0aW9ucyApO1xuICB9XG5cbiAgcHVibGljIG92ZXJyaWRlIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5saWdodGVyUGFpbnRQcm9wZXJ0eS5kaXNwb3NlKCk7XG4gICAgdGhpcy5saWdodFBhaW50UHJvcGVydHkuZGlzcG9zZSgpO1xuICAgIHRoaXMuZGFya1BhaW50UHJvcGVydHkuZGlzcG9zZSgpO1xuICAgIHRoaXMuZGFya2VyUGFpbnRQcm9wZXJ0eS5kaXNwb3NlKCk7XG5cbiAgICBzdXBlci5kaXNwb3NlKCk7XG4gIH1cbn1cblxuc2NlbmVyeVBoZXQucmVnaXN0ZXIoICdTaGFkZWRSZWN0YW5nbGUnLCBTaGFkZWRSZWN0YW5nbGUgKTsiXSwibmFtZXMiOlsiRGVyaXZlZFByb3BlcnR5IiwiU2hhcGUiLCJvcHRpb25pemUiLCJDb2xvciIsIkxpbmVhckdyYWRpZW50IiwiTm9kZSIsIlBhaW50Q29sb3JQcm9wZXJ0eSIsIlBhdGgiLCJSYWRpYWxHcmFkaWVudCIsIlJlY3RhbmdsZSIsInNjZW5lcnlQaGV0IiwiU2hhZGVkUmVjdGFuZ2xlIiwiZGlzcG9zZSIsImxpZ2h0ZXJQYWludFByb3BlcnR5IiwibGlnaHRQYWludFByb3BlcnR5IiwiZGFya1BhaW50UHJvcGVydHkiLCJkYXJrZXJQYWludFByb3BlcnR5IiwicmVjdEJvdW5kcyIsInByb3ZpZGVkT3B0aW9ucyIsIm9wdGlvbnMiLCJiYXNlQ29sb3IiLCJsaWdodEZhY3RvciIsImxpZ2h0ZXJGYWN0b3IiLCJkYXJrRmFjdG9yIiwiZGFya2VyRmFjdG9yIiwiY29ybmVyUmFkaXVzIiwibGlnaHRTb3VyY2UiLCJsaWdodE9mZnNldCIsImRhcmtPZmZzZXQiLCJhc3NlcnQiLCJsaWdodEZyb21MZWZ0IiwiaW5jbHVkZXMiLCJsaWdodEZyb21Ub3AiLCJsdW1pbmFuY2VGYWN0b3IiLCJ0b3BDb2xvclByb3BlcnR5IiwibGVmdENvbG9yUHJvcGVydHkiLCJyaWdodENvbG9yUHJvcGVydHkiLCJib3R0b21Db2xvclByb3BlcnR5IiwidG9wT2Zmc2V0IiwibGVmdE9mZnNldCIsInJpZ2h0T2Zmc2V0IiwiYm90dG9tT2Zmc2V0IiwiaG9yaXpvbnRhbE5vZGUiLCJyb3VuZGVkQm91bmRzIiwicGlja2FibGUiLCJ2ZXJ0aWNhbE5vZGUiLCJmaWxsIiwibGVmdCIsInJpZ2h0IiwiYWRkQ29sb3JTdG9wIiwid2lkdGgiLCJ0b3AiLCJib3R0b20iLCJoZWlnaHQiLCJjb2xvciIsIndpdGhBbHBoYSIsImNvcm5lclNoYXBlIiwibW92ZVRvIiwiYXJjIiwiTWF0aCIsIlBJIiwiY2xvc2UiLCJsaWdodENvcm5lclJvdGF0aW9uIiwibGVmdFRvcCIsInJpZ2h0VG9wIiwicmlnaHRCb3R0b20iLCJsZWZ0Qm90dG9tIiwiaW5uZXJCb3VuZHMiLCJlcm9kZWQiLCJsaWdodENvcm5lciIsIngiLCJtaW5YIiwibWF4WCIsInkiLCJtaW5ZIiwibWF4WSIsInJvdGF0aW9uIiwiZGFya0Nvcm5lciIsInBhbmVsU3Ryb2tlIiwic3Ryb2tlIiwiYWRkQ2hpbGQiLCJtdXRhdGUiLCJyZWdpc3RlciJdLCJtYXBwaW5ncyI6IkFBQUEsc0RBQXNEO0FBRXREOzs7O0NBSUMsR0FFRCxPQUFPQSxxQkFBcUIsbUNBQW1DO0FBRS9ELFNBQVNDLEtBQUssUUFBUSwyQkFBMkI7QUFDakQsT0FBT0MsZUFBZSxrQ0FBa0M7QUFDeEQsU0FBU0MsS0FBSyxFQUFFQyxjQUFjLEVBQUVDLElBQUksRUFBZUMsa0JBQWtCLEVBQUVDLElBQUksRUFBRUMsY0FBYyxFQUFFQyxTQUFTLFFBQWdCLDhCQUE4QjtBQUNwSixPQUFPQyxpQkFBaUIsbUJBQW1CO0FBcUI1QixJQUFBLEFBQU1DLGtCQUFOLE1BQU1BLHdCQUF3Qk47SUFvSTNCTyxVQUFnQjtRQUM5QixJQUFJLENBQUNDLG9CQUFvQixDQUFDRCxPQUFPO1FBQ2pDLElBQUksQ0FBQ0Usa0JBQWtCLENBQUNGLE9BQU87UUFDL0IsSUFBSSxDQUFDRyxpQkFBaUIsQ0FBQ0gsT0FBTztRQUM5QixJQUFJLENBQUNJLG1CQUFtQixDQUFDSixPQUFPO1FBRWhDLEtBQUssQ0FBQ0E7SUFDUjtJQXBJQTs7O0dBR0MsR0FDRCxZQUFvQkssVUFBbUIsRUFBRUMsZUFBd0MsQ0FBRztRQUVsRixLQUFLO1FBRUwsTUFBTUMsVUFBVWpCLFlBQStEO1lBQzdFa0IsV0FBVyxJQUFJakIsTUFBTyxJQUFJLEtBQUs7WUFDL0JrQixhQUFhO1lBQ2JDLGVBQWU7WUFD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